


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.9">
    
    
      
        <title>SAP HANA, Call Database Procedure - ABAP docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.36ee6aaa.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.83bccb1f.min.css">
      
      
        
        
        <meta name="theme-color" content="#4051b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://raw.githubusercontent.com/highlightjs/highlight.js/master/src/styles/github.css">
    
      <link rel="stylesheet" href="../../css/abap-docs.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sap-hana-call-database-procedure" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="ABAP docs" class="md-header-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            ABAP docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              SAP HANA, Call Database Procedure
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ABAP docs" class="md-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ABAP docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="ABAP docs" class="md-nav__link">
      ABAP docs
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#source-code" class="md-nav__link">
    Source Code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    Description
  </a>
  
    <nav class="md-nav" aria-label="Description">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comparison-implementation-using-open-sql" class="md-nav__link">
    Comparison Implementation Using Open SQL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-with-native-sql-using-adbc" class="md-nav__link">
    Call with Native SQL Using ADBC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-using-database-procedure-proxy" class="md-nav__link">
    Call Using Database Procedure Proxy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-using-amdp" class="md-nav__link">
    Call Using AMDP
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/eduardocopat/abap-docs/edit/master/docs/7.40/abencall_hana_db_proc_abexa.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="sap-hana-call-database-procedure">SAP HANA, Call Database Procedure</h1>
<p>This example demonstrates how a database procedure in the SAP HANA database can be called.</p>
<p><a name="@@ITOC@@SOURCECODE_1"></a>
<s><i>7.31</i></s> <b>7.40</b> <a href="../abencall_hana_db_proc_abexa">7.54</a></p>
<p><small>
<a href="../abenabap" class="blue">ABAP Keyword Documentation</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_reference" class="blue">ABAP - Reference</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_language_external_data" class="blue">Processing External Data</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_sql" class="blue">ABAP Database Accesses</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_hana" class="blue">ABAP and SAP HANA</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_and_hana_abexas" class="blue">ABAP and SAP HANA, Examples</a>&#xA0;</small></p>
<h2 id="source-code">Source Code</h2>
<p><div class="highlight"><pre><span></span><code>    <span class="k">DATA</span><span class="p">(</span><span class="nv">out</span><span class="p">)</span> <span class="o">=</span> <span class="nv">cl_demo_output</span><span class="o">=&gt;</span><span class="nf">new</span><span class="p">(</span> <span class="p">).</span>

    <span class="k">IF</span> <span class="nv">cl_db_sys</span><span class="o">=&gt;</span><span class="nv">is_in_memory_db</span> <span class="o">=</span> <span class="nv">abap_false</span><span class="p">.</span>
      <span class="nv">out</span><span class="o">-&gt;</span><span class="nf">display</span><span class="p">(</span>
        <span class="s1">`Example can be executed on SAP HANA Database only`</span> <span class="p">).</span>
      <span class="k">LEAVE</span> <span class="k">PROGRAM</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>

    <span class="k">DATA</span> <span class="nv">carrier</span> <span class="k">TYPE </span><span class="nv">spfli</span><span class="o">-</span><span class="nv">carrid</span> <span class="k">VALUE</span> <span class="s1">&#39;LH&#39;</span><span class="p">.</span>
    <span class="nv">cl_demo_input</span><span class="o">=&gt;</span><span class="nf">request</span><span class="p">(</span> <span class="k">CHANGING</span> <span class="k">field</span> <span class="o">=</span> <span class="nv">carrier</span> <span class="p">).</span>
    <span class="k">DATA</span><span class="p">(</span><span class="nv">oref</span><span class="p">)</span> <span class="o">=</span>
      <span class="nv">NEW</span> <span class="nv">cl_demo_call_hana_db_procedure</span><span class="p">(</span> <span class="nv">to_upper</span><span class="p">(</span> <span class="nv">carrier</span> <span class="p">)</span> <span class="p">).</span>

    <span class="k">DATA</span><span class="p">(</span><span class="nv">osql_result</span><span class="p">)</span> <span class="o">=</span> <span class="nv">oref</span><span class="o">-&gt;</span><span class="nf">osql</span><span class="p">(</span> <span class="p">).</span>
    <span class="k">DATA</span><span class="p">(</span><span class="nv">adbc_result</span><span class="p">)</span> <span class="o">=</span> <span class="nv">oref</span><span class="o">-&gt;</span><span class="nf">adbc</span><span class="p">(</span> <span class="p">).</span>
    <span class="k">DATA</span><span class="p">(</span><span class="nv">cdbp_result</span><span class="p">)</span> <span class="o">=</span> <span class="nv">oref</span><span class="o">-&gt;</span><span class="nf">cdbp</span><span class="p">(</span> <span class="p">).</span>
    <span class="k">DATA</span><span class="p">(</span><span class="nv">amdp_result</span><span class="p">)</span> <span class="o">=</span> <span class="nv">oref</span><span class="o">-&gt;</span><span class="nf">amdp</span><span class="p">(</span> <span class="p">).</span>

    <span class="k">IF</span> <span class="nv">osql_result</span> <span class="o">=</span> <span class="nv">adbc_result</span> <span class="ow">AND</span>
       <span class="nv">osql_result</span> <span class="o">=</span> <span class="nv">cdbp_result</span> <span class="ow">AND</span>
       <span class="nv">osql_result</span> <span class="o">=</span> <span class="nv">amdp_result</span><span class="p">.</span>
      <span class="nv">out</span><span class="o">-&gt;</span><span class="nf">begin_section</span><span class="p">(</span>
        <span class="s1">`Result of Open SQL, ADBC, CALL DATABASE PROCEDURE, and AMDP`</span>
        <span class="p">)</span><span class="o">-&gt;</span><span class="nf">write</span><span class="p">(</span> <span class="nv">amdp_result</span> <span class="p">).</span>
    <span class="k">ELSE</span><span class="p">.</span>
      <span class="nv">out</span><span class="o">-&gt;</span><span class="nf">write</span><span class="p">(</span> <span class="s1">&#39;Error&#39;</span> <span class="p">).</span>
    <span class="k">ENDIF</span><span class="p">.</span>
    <span class="nv">out</span><span class="o">-&gt;</span><span class="nf">display</span><span class="p">(</span> <span class="p">).</span>
</code></pre></div>
<a name="@@ITOC@@DESCRIPTION_2"></a></p>
<h2 id="description">Description</h2>
<p>Take a database procedure called <span class="qtext400">/1BCAMDP/DEMO_ADBC_GET_FLIGHTS</span> in the database schema <span class="qtext400">SAPsid</span>:</p>
<dd>
<span class="qtext400">begin <br>&#xA0;&#xA0;FLIGHTS = <br>&#xA0;&#xA0;&#xA0;&#xA0;select * <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; from SFLIGHT as S <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; where exists ( <br>&#xA0;&#xA0;&#xA0;&#xA0;
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;select MANDT, CARRID, CONNID <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;from :CONNECTIONS as C <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;where C.MANDT&#xA0;&#xA0;= S.MANDT and <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;C.CARRID = S.CARRID and <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;C.CONNID = S.CONNID ); <br>end</span>
</dd>

<p>The procedure has a tabular input parameter <span class="qtext400">CONNECTIONS</span> with the three-column
HANA table type <span class="qtext400">DEMO_ADBC_CONNECTIONS_TYPE</span> and an output parameter <span class="qtext400">
FLIGHTS</span> with the type SFLIGHT defined in ABAP Dictionary. The HANA table type has three character-like
columns, <span class="qtext400">MANDT</span> with length 3, <span class="qtext400">CARRID</span> with
length 3, and <span class="qtext400">CONNID</span> with length 4. The task is to call this procedure
from ABAP while passing an internal table to the input parameter and applying the output parameter to an internal table.</p>
<p>To do this, the example program calls various methods of the class <span class="lnkgrey">CL_DEMO_CALL_HANA_DB_PROCEDURE</span>.
The passed table <code style="display: inline;"><span class="qtext">connection_tab</span></code> is filled in the instance constructor of
the class in accordance with user input. Furthermore, the database procedure, the HANA table type, and a database procedure proxy (usually static) are created here temporarily.</p>
<p><a name="@@ITOC@@COMPARISONIMPLEMENTATIONUSINGOPENSQL_3"></a></p>
<h3 id="comparison-implementation-using-open-sql">Comparison Implementation Using Open SQL</h3>
<p>The method OSQL shows how the implementation of the database procedure can be expressed in Open SQL
too. If the function is required only in ABAP, an implementation in SQLScript is unnecessary in this case and should be avoided in fact (as specified in the relevant
<a href="../abendatabase_access_guidl" class="lnkpurple" title="Guideline">programming guideline</a>.
In our example, the database procedure is a replacement for a globally available procedure also to be
called in ABAP. The result of the method OSQL is compared with the results of the various procedure calls to check their correctness.</p>
<dd>
<span class="qtext">METHOD osql. <br>&#xA0;&#xA0;IF connection_tab IS NOT INITIAL. <br>&#xA0;&#xA0;&#xA0;&#xA0;SELECT * <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;FROM sflight <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;INTO TABLE @flights <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;FOR ALL ENTRIES IN @connection_tab <br>&#xA0;
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;WHERE carrid = @connection_tab-carrid AND <br>&#xA0;
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;connid = @connection_tab-connid. <br>&#xA0;&#xA0;ENDIF. <br>ENDMETHOD.</span>
</dd>

<p><a name="@@ITOC@@CALLWITHNATIVESQLUSINGADBC_4"></a></p>
<h3 id="call-with-native-sql-using-adbc">Call with Native SQL Using ADBC</h3>
<p>The method ADBC uses <a href="../abennative_sql_glosry" class="grey" title="Glossary Entry">Native SQL</a> and
<a href="../abenadbc_glosry" class="grey" title="Glossary Entry">ADBC</a> to call the database procedure.
To pass the internal table <code style="display: inline;"><span class="qtext">connection_tab</span></code> to the database procedure, a temporary
table <span class="qtext400">DEMO_ADBC_CONNECTIONS</span> with the required type <span class="qtext400">DEMO_ADBC_CONNECTIONS_TYPE</span>
is created on the database and provided with the values of the internal table using <span class="qtext400">insert</span>.
The database procedure is then called with the temporary table as an input parameter and the result
is assigned to an ADBC results set. To read from the results set, a standard table <code style="display: inline;"><span class="qtext">flights_std</span></code>
is required as an auxiliary table, since the return value <code style="display: inline;"><span class="qtext">flights</span></code> is a sorted
table that cannot be used for ADBC. The temporary table <span class="qtext400">DEMO_ADBC_CONNECTIONS</span> is removed again after the database procedure is called.</p>
<dd>
<span class="qtext">METHOD adbc. <br>&#xA0;&#xA0;DATA(sql) = NEW cl_sql_statement( ). <br> <br>&#xA0;&#xA0;TRY. <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sql-&gt;execute_update( &apos;truncate table DEMO_ADBC_CONNECTIONS&apos; ). <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sql-&gt;execute_ddl(&#xA0;&#xA0;&#xA0;&#xA0;&apos;drop table DEMO_ADBC_CONNECTIONS&apos; ). <br>
&#xA0;&#xA0;&#xA0;&#xA0;CATCH cx_sql_exception ##no_handler. <br>&#xA0;&#xA0;ENDTRY. <br> <br>&#xA0;&#xA0;TRY. <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sql-&gt;execute_ddl( <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;`create global temporary row table DEMO_ADBC_CONNECTIONS ` &amp;&amp; <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; `like DEMO_ADBC_CONNECTIONS_TYPE` ). <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sql-&gt;set_param_table( REF #( connection_tab ) ). <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sql-&gt;execute_update( <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;|insert into DEMO_ADBC_CONNECTIONS values ( ?, ?, ? )| ). <br>
 <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;DATA(result) = <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sql-&gt;execute_query( <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;`call &quot;/1BCAMDP/DEMO_ADBC_GET_FLIGHTS&quot;( ` &amp;&amp; <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;`&#xA0;&#xA0;CONNECTIONS =&gt;DEMO_ADBC_CONNECTIONS, ` &amp;&amp; <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;`&#xA0;&#xA0;FLIGHTS =&gt; NULL )` ). <br>
 <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;DATA flights_std TYPE STANDARD TABLE OF sflight WITH EMPTY KEY. <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;result-&gt;set_param_table( REF #( flights_std ) ). <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;result-&gt;next_package( ). <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;result-&gt;close( ). <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;flights = flights_std. <br>
 <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sql-&gt;execute_update( &apos;truncate table DEMO_ADBC_CONNECTIONS&apos; ). <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sql-&gt;execute_ddl(&#xA0;&#xA0;&#xA0;&#xA0;&apos;drop table DEMO_ADBC_CONNECTIONS&apos; ). <br>
&#xA0;&#xA0;&#xA0;&#xA0;CATCH cx_sql_exception. <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;CLEAR flights. <br>&#xA0;&#xA0;ENDTRY. <br>ENDMETHOD.</span>
</dd>

<p><a name="@@ITOC@@CALLUSINGDATABASEPROCEDUREPROXY_5"></a></p>
<h3 id="call-using-database-procedure-proxy">Call Using Database Procedure Proxy</h3>
<p>The method CDBP calls the database procedure with the statement <a href="../abapcall_database_procedure" class="blue"><code style="display: inline;"><span class="qtext">CALL DATABASE PROCEDURE</span></code></a> using the assigned
<a href="../abendatabase_proc_proxy_glosry" class="grey" title="Glossary Entry">database procedure
proxy</a> DEMO_ADBC_GET_FLIGHTS_PROXY. The only thing to note here is that input parameters and output
parameters of the database procedure have different row types than the internal tables assigned to them.
In both cases, the column <span class="qtext400">CONNID</span> has the type <span class="qtext400">NVARCHAR(4)</span>
on the database, but the type <code style="display: inline;"><span class="qtext">n</span></code> with length 4 in ABAP. For this reason, the
internal table <code style="display: inline;"><span class="qtext">connection_tab</span></code> is first assigned to a temporary table <span class="qtext">
connections</span> with the correct row type before the procedure is called. No auxiliary table is required
for the result <code style="display: inline;"><span class="qtext">flights</span></code>, since the row type is described using an ABAP Dictionary
type. An appropriate mapping can be performed for this type using the mapping table <code style="display: inline;"><span class="qtext">params</span></code>.
As an alternative to an auxiliary table for <code style="display: inline;"><span class="qtext">connection_tab</span></code>, its data type could be declared in ABAP Dictionary too and an appropriate mapping performed.</p>
<dd>
<span class="qtext">METHOD cdbp. <br>&#xA0;&#xA0;TYPES: <br>&#xA0;&#xA0;&#xA0;&#xA0;BEGIN OF connection, <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;mandt&#xA0;&#xA0;TYPE c LENGTH 3, <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;carrid TYPE c LENGTH 3, <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;connid TYPE c LENGTH 4, <br>&#xA0;&#xA0;&#xA0;&#xA0;END OF connection. <br>
&#xA0;&#xA0;DATA connections TYPE STANDARD TABLE OF connection <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; WITH EMPTY KEY. <br>
&#xA0;&#xA0;connections = connection_tab. <br> <br>&#xA0;&#xA0;CALL DATABASE PROCEDURE (&apos;DEMO_ADBC_GET_FLIGHTS_PROXY&apos;) <br>
&#xA0;&#xA0;&#xA0;&#xA0;EXPORTING connections = connections <br>&#xA0;&#xA0;&#xA0;&#xA0;IMPORTING flights&#xA0;&#xA0;&#xA0;&#xA0; = flights. <br> <br>ENDMETHOD.</span>
</dd>

<p><a name="@@ITOC@@CALLUSINGAMDP_6"></a></p>
<h3 id="call-using-amdp">Call Using AMDP</h3>
<p>The method AMDP calls the <a href="../abenamdp_method_glosry" class="grey" title="Glossary Entry">AMDP
method</a> AMDP_METH, in which a call of the database procedure is implemented in SQLScript. In this case, all type-dependent actions required are performed by the AMDP framework.</p>
<dd>
<span class="qtext">METHOD amdp. <br>&#xA0;&#xA0;amdp_meth( EXPORTING connections = connection_tab <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; IMPORTING flights&#xA0;&#xA0;&#xA0;&#xA0; = flights ). <br>ENDMETHOD.</span>
</dd>

<dd>
<span class="qtext">METHOD amdp_meth BY DATABASE PROCEDURE FOR HDB LANGUAGE SQLSCRIPT. <br>&#xA0;&#xA0;call &quot;/1BCAMDP/DEMO_ADBC_GET_FLIGHTS&quot;( <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; CONNECTIONS =&gt; :CONNECTIONS, <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FLIGHTS =&gt; :FLIGHTS ); <br>ENDMETHOD.</span>
</dd>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../abencall_function_abexa/" title="Calling Function Modules" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Calling Function Modules
              </div>
            </div>
          </a>
        
        
          <a href="../abencall_procedures/" title="Calling Procedures" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Calling Procedures
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.df0def68.min.js"></script>
      <script src="../../assets/javascripts/bundle.ba57d267.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js"></script>
      
        <script src="../../javascript/hljs.js"></script>
      
    
  </body>
</html>