


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.9">
    
    
      
        <title>Transaction Mode - ABAP docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.36ee6aaa.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.83bccb1f.min.css">
      
      
        
        
        <meta name="theme-color" content="#4051b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://raw.githubusercontent.com/highlightjs/highlight.js/master/src/styles/github.css">
    
      <link rel="stylesheet" href="../../css/abap-docs.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#transaction-mode" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="ABAP docs" class="md-header-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            ABAP docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Transaction Mode
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ABAP docs" class="md-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ABAP docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="ABAP docs" class="md-nav__link">
      ABAP docs
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#update-modes" class="md-nav__link">
    Update Modes
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/eduardocopat/abap-docs/edit/master/docs/7.54/abenos_transaction_mode.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="transaction-mode">Transaction Mode</h1>
<p>The transaction service in Object Services is connected to classic transaction processing or is itself
part of the SAP LUWs, which means a program must be able to determine whether it is working with classic
or object-oriented transactions. This requires the term &quot;transaction mode&quot; to be introduced, which can be specified once for each program.</p>
<p>Each program working with persistent objects has a transaction mode that is defined either explicitly
or implicitly when the Object Services are initialized. Each program also has a &quot;top level transaction&quot;
(a transaction object whose reference can be obtained using the method IF_OS_TRANSACTION_MANAGER~GET_TOP_TRANSACTION)
while it is working with persistent objects. The top level transaction is responsible for updating the
persistent objects. The transaction mode of the program is also the transaction mode of the top level transaction and can be queried using the method IF_OS_TRANSACTION~GET_MODES in the parameter E_EXTERNAL_COMMIT.</p>
<p>There are two transaction modes:</p>
<ul>

<li>Compatibility mode</li>

</ul>

<dd>
Compatibility mode (E_EXTERNAL_COMMIT is OSCON_TRUE) makes it possible to use persistent objects within
classic SAP LUWs. The statement <code style="display: inline;"><span class="qtext">COMMIT WORK</span></code> must be defined explicitly in
the program to commit changes. Implicit methods of the persistence service are called when a program is executed to commit the changes made to persistent objects.
</dd>

<dd>
When using the persistence service in compatibility mode, the system always implicitly starts one update process, which also deletes any locks in the update task.
</dd>

<ul>

<li>Object-oriented transaction mode</li>

</ul>

<dd>
The object-oriented transaction mode (E_EXTERNAL_COMMIT is OSCON_FALSE) is used to write new fully object-oriented
applications without having to worry about the statement <code style="display: inline;"><span class="qtext">COMMIT WORK</span></code>. In
object-oriented transaction mode, <code style="display: inline;"><span class="qtext">COMMIT WORK</span></code> is triggered when the method
END is called for a top level transaction. The statement <code style="display: inline;"><span class="qtext">COMMIT WORK</span></code> is not allowed within object-oriented transactions.
</dd>

<p>The transaction mode can be defined and the top level transaction created as follows:</p>
<ul>

<li>If the method CL_OS_SYSTEM=&gt;INIT_AND_SET_MODE was not executed in a program before the first access
to the persistence service, the service starts it with the default values that set the transaction mode
to compatibility mode and the update mode to asynchronous. A top level transaction is implicitly created
and started at this time to handle the persistent objects of the program. All other transactions that
are started in the program with IF_OS_TRANSACTION~START are subtransactions of the top level transaction
that is running in compatibility mode. This makes it possible to work in classic ABAP programs with
persistent objects without having to explicitly worry about the transaction mode. An example can be found under Creating a Persistent Object.</li>

</ul>

<ul>

<li>If the method CL_OS_SYSTEM=&gt;INIT_AND_SET_MODE is executed before the persistence service is accessed
in a program for the first time, the transaction mode can be set explicitly to compatibility mode or
object-oriented mode by passing the values OSCON_TRUE or OSCON_FALSE to the parameter I_EXTERNAL_COMMIT.
Since the static constructors of the persistence service are usually executed at the beginning of a
processing block, the event <code style="display: inline;"><span class="qtext">LOAD-OF-PROGRAM</span></code> or the constructor of an application
class can be used, for example, to call CL_OS_SYSTEM=&gt;INIT_AND_SET_MODE. A program that was not started
as OO transaction can thus be executed as an object-oriented transaction. In object-oriented transaction
mode, the first transaction that is started in the program with IF_OS_TRANSACTION~START is a top level transaction, whereas in compatibility mode, the top level transaction is always created implicitly.</li>

</ul>

<ul>

<li>If the OO transaction model field is selected when an <span class="italic">object-oriented transaction</span>
is created in ABAP Workbench, the transaction mode of the corresponding program is automatically set
to object-oriented (CL_OS_SYSTEM=&gt;INIT_AND_SET_MODE is executed implicitly with the relevant parameters)
when the transaction is called. The first transaction that is started in the program with IF_OS_TRANSACTION~START is a top level transaction.</li>

</ul>

<p><a name="@@ITOC@@ABENOS_TRANSACTION_MODE_1"></a>
<s><i>7.31</i></s> <a href="../abenos_transaction_mode">7.40</a> <b>7.54</b></p>
<p><small>
<a href="../abenabap" class="blue">ABAP Keyword Documentation</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_reference" class="blue">ABAP &#x2212; Reference</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_language_external_data" class="blue">Processing External Data</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_sql" class="blue">ABAP Database Access</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_object_services" class="blue">Object Services</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_object_services_transact" class="blue">transaction service</a>&#xA0;</small></p>
<h2 id="update-modes">Update Modes</h2>
<p>At the end of a top level transaction (using <code style="display: inline;"><span class="qtext">COMMIT WORK</span></code> in compatibility
mode or the method IF_OS_TRANSACTION~END in object-oriented mode), the transaction service updates the changes to persistent objects in the database. Internal update function modules are started implicitly at this time.</p>
<p>The way that the update function modules are executed is specified by the initialization of the Object
Services using the method CL_OS_SYSTEM=&gt;INIT_AND_SET_MODE or after starting the top level transaction
(one-off specification) using the method IF_OS_TRANSACTION~SET_MODE_UPDATE. Since CL_OS_SYSTEM=&gt;INIT_AND_SET_MODE
can only be called once for each program, IF_OS_TRANSACTION~SET_MODE_UPDATE makes it possible to change an update mode that was set implicitly.</p>
<p>The input parameter I_UPDATE_MODE with the type OS_DMODE can be used for both methods to set the update mode. Possible values are:</p>
<ul>

<li>OSCON_DMODE_DEFAULT, OSCON_DMODE_UPDATE_TASK for asynchronous updates</li>

</ul>

<ul>

<li>0OSCON_DMODE_UPDATE_TASK_SYNC for synchronous updates</li>

</ul>

<ul>

<li> OSCON_DMODE_LOCAL for local updates</li>

</ul>

<ul>

<li>OSCON_DMODE_DIRECT for saving directly</li>

</ul>

<p>OSCON_DMODE_LOCAL and OSCON_DMODE_UPDATE_TASK_SYNC cannot be specified in compatibility mode, since
there they can be set by the ABAP statements <code style="display: inline;"><span class="qtext">COMMIT WORK AND WAIT</span></code> and <code style="display: inline;"><span class="qtext">SET UPDATE TASK LOCAL</span></code>.</p>
<p>When an object-oriented transaction is created in ABAP Workbench, the initial update mode of the top level transaction is defined through selection of the relevant radio button.</p>
<p><br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>The following example assumes that the program is running in object-oriented transaction mode. This
requires either the transaction to be flagged as an OO transaction in <span class="lnkgrey">transaction
maintenance</span> (the <span class="italic">OO transaction model</span> must be marked) or the method
INIT_AND_SET_MODES to be called before a persistent object is accessed (the parameter I_EXTERNAL_COMMIT
must be set to OSCON_FALSE). Only then does the method END trigger an update. If the above does not
apply, the program is in compatibility mode, where the statement <code style="display: inline;"><span class="qtext">COMMIT WORK</span></code> must be specified explicitly after a transaction ends.</p>
<dd>
<code style="display: inline;"><span class="qtext">data TM type ref to IF_OS_TRANSACTION_MANAGER.</span></code> <br><code style="display: inline;"><span class="qtext">data T&#xA0;&#xA0;type ref to IF_OS_TRANSACTION.</span></code> <br>
<code style="display: inline;"><span class="qtext">...</span></code> <br><code style="display: inline;"><span class="qtext">TM = CL_OS_SYSTEM=&gt;GET_TRANSACTION_MANAGER( ).</span></code> <br>
<code style="display: inline;"><span class="qtext">T&#xA0;&#xA0;= TM-&gt;CREATE_TRANSACTION( ).</span></code> <br><code style="display: inline;"><span class="qtext">...</span></code> <br>
<code style="display: inline;"><span class="qtext">TRY.</span></code> <br><code style="display: inline;"><span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;T-&gt;START( ).</span></code> <br>
<code style="display: inline;"><span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;... &quot;Change persistent Objects</span></code> <br><code style="display: inline;"><span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;T-&gt;END( ).</span></code> <br>
<code style="display: inline;"><span class="qtext">&#xA0;&#xA0;CATCH CX_OS_ERROR.</span></code> <br><code style="display: inline;"><span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;...</span></code> <br><code style="display: inline;"><span class="qtext">ENDTRY.</span></code>
</dd>

</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../abenos_transaction_luw/" title="Transaction Service and Updates" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Transaction Service and Updates
              </div>
            </div>
          </a>
        
        
          <a href="../abenos_transaction_nesting/" title="Nesting and Chaining Transactions" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Nesting and Chaining Transactions
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.df0def68.min.js"></script>
      <script src="../../assets/javascripts/bundle.ba57d267.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js"></script>
      
        <script src="../../javascript/hljs.js"></script>
      
    
  </body>
</html>