


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.9">
    
    
      
        <title>Abenescape functions - ABAP docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.36ee6aaa.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.83bccb1f.min.css">
      
      
        
        
        <meta name="theme-color" content="#4051b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://raw.githubusercontent.com/highlightjs/highlight.js/master/src/styles/github.css">
    
      <link rel="stylesheet" href="../../css/abap-docs.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#escape-escape-function" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="ABAP docs" class="md-header-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            ABAP docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Abenescape functions
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ABAP docs" class="md-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ABAP docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../7.31/abapdata_options/" title="7.31" class="md-nav__link">
      7.31
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#syntax" class="md-nav__link">
    Syntax
  </a>
  
    <nav class="md-nav" aria-label="Syntax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#effect" class="md-nav__link">
    Effect
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules-for-markup-languages-including-javascript" class="md-nav__link">
    Rules for Markup Languages (Including JavaScript)
  </a>
  
    <nav class="md-nav" aria-label="Rules for Markup Languages (Including JavaScript)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executable-example" class="md-nav__link">
    Executable Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules-for-urluris" class="md-nav__link">
    Rules for URL/URIs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules-for-json" class="md-nav__link">
    Rules for JSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules-for-regular-expressions" class="md-nav__link">
    Rules for Regular Expressions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules-for-string-templates" class="md-nav__link">
    Rules for String Templates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules-for-cross-site-scripting" class="md-nav__link">
    Rules for Cross Site Scripting
  </a>
  
    <nav class="md-nav" aria-label="Rules for Cross Site Scripting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executable-example_1" class="md-nav__link">
    Executable Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exceptions" class="md-nav__link">
    Exceptions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handleable-exceptions" class="md-nav__link">
    Handleable Exceptions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/eduardocopat/abap-docs/edit/master/docs/7.54/abenescape_functions.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <p><small>
<a href="../abenabap" class="blue">ABAP Keyword Documentation</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_reference" class="blue">ABAP &#x2212; Reference</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_data_working" class="blue">Processing Internal Data</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_data_string" class="blue">Character String and Byte String Processing</a>&#xA0;&#x2192;&#xA0;
<a href="../abenstring_processing_expr_func" class="blue">Expressions and Functions for String Processing</a>&#xA0;&#x2192;&#xA0;
<a href="../abenstring_functions" class="blue">String Functions</a>&#xA0;&#x2192;&#xA0;
<a href="../abenprocess_functions" class="blue">Processing Functions for Character-Like Arguments</a>&#xA0;</small></p>
<h1 id="escape-escape-function">escape - Escape Function</h1>
<p>Other versions: 
 <a href="../../7.31/abenescape_functions">7.31</a> | <a href="../../7.40/abenescape_functions">7.40</a> | <b>7.54</b></p>
<h2 id="syntax">Syntax</h2>
<p><pre><code class="hljs abap abap-docs-syntax-block">
 <br><span class="qtext">... escape( <a href="../abenstring_functions_val" class="blue">val = text</a> format = format ) ...</span>
</code></pre></p>
<h3 id="effect">Effect</h3>
<p>This function gets the content of the character string in <a href="../abenstring_functions_val" class="blue"><span class="qtext">
text</span></a>, and hides certain special characters with escape characters according to a rule specified in <code style="display: inline;"><span class="qtext">format</span></code>.</p>
<p>The possible values of <code style="display: inline;"><span class="qtext">format</span></code> are defined as constants with the prefix <span class="qtext400">
&quot;E_&quot;</span> in the class <span class="lnkgrey">CL_ABAP_FORMAT</span>. Each value defines which special
characters are replaced, and how. There are rules for special characters in markup languages (XML and
HTML), in URIs and URLs, in JSON, as well as in regular expressions and character string templates. An important part is also played by attack protection using Cross Site Scripting (XSS) on Web applications.</p>
<p><code style="display: inline;"><span class="qtext">format</span></code> expects data objects of the type <code style="display: inline;"><span class="qtext">i</span></code>. An
invalid value for <code style="display: inline;"><span class="qtext">format</span></code> raises an exception of the class CX_SY_STRG_PAR_VAL.
For all characters whose codes are between x00 and xFF, the program <span class="lnkgrey">DEMO_ESCAPE</span>
demonstrates the effect of all associated formats from the class CL_ABAP_FORMAT. The top row contains
the names of the constants from the class CL_ABAP_FORMAT without the prefix <span class="qtext400">&quot;E_&quot;</span>. The other rows show the effect on the characters specified in the first two columns.</p>
<p>This function can be specified in <a href="../abengeneral_expr_position_glosry" class="grey" title="Glossary Entry">general</a> and
<a href="../abencharlike_expr_position_glosry" class="grey" title="Glossary Entry">character-like expression positions</a>. The return code has the type <code style="display: inline;"><span class="qtext">string</span></code>.</p>
<ul>

<li><a href="#@@ITOC@@ABENESCAPE_FUNCTIONS_1" class="blue">Rules for Markup Languages (Including JavaScript)</a></li>

</ul>

<ul>

<li><a href="#@@ITOC@@ABENESCAPE_FUNCTIONS_2" class="blue">Rules for URL/URIs</a></li>

</ul>

<ul>

<li><a href="#@@ITOC@@ABENESCAPE_FUNCTIONS_3" class="blue">Rules for JSON</a></li>

</ul>

<ul>

<li><a href="#@@ITOC@@ABENESCAPE_FUNCTIONS_4" class="blue">Rules for Regular Expressions</a></li>

</ul>

<ul>

<li><a href="#@@ITOC@@ABENESCAPE_FUNCTIONS_5" class="blue">Rules for String Templates</a></li>

</ul>

<ul>

<li><a href="#@@ITOC@@ABENESCAPE_FUNCTIONS_6" class="blue">Rules for Cross Site Scripting</a></li>

</ul>

<p><a name="@@ITOC@@ABENESCAPE_FUNCTIONS_1"></a></p>
<h2 id="rules-for-markup-languages-including-javascript">Rules for Markup Languages (Including JavaScript)</h2>
<p>The program <span class="lnkgrey">DEMO_ESCAPE_MARKUP</span> demonstrates the escape rules for markup
languages. Formats with <span class="qtext400">&quot;_JS&quot;</span> in their name are intended for content with JavaScript components. The following table summarizes the escape rules:</p>
<p>|Format|&amp;|&lt;|&gt;|"|'|TAB|LF|CR|BS|FF||ctrl-char|
|----|----|----|----|----|----|----|----|----|----|----|----|----|
|E_XML_TEXT|<span class="qtext400">&amp;amp;</span>|<span class="qtext400">&amp;lt;</span>|-|-|-|-|-|-|-|-|-|-|
|E_XML_ATTR|<span class="qtext400">&amp;amp;</span>|<span class="qtext400">&amp;lt;</span>|-|<span class="qtext400">&amp;quot;</span>|<span class="qtext400">&amp;apos;</span>|<span class="qtext400">&amp;#9;</span>|<span class="qtext400">&amp;#xA;</span>|<span class="qtext400">&amp;#xD;</span>|-|-|-|-|
|E_XML_ATTR_DQ|<span class="qtext400">&amp;amp;</span>|<span class="qtext400">&amp;lt;</span>|-|<span class="qtext400">&amp;quot;</span>|-|<span class="qtext400">&amp;#9;</span>|<span class="qtext400">&amp;#xA;</span>|<span class="qtext400">&amp;#xD;</span>|-|-|-|-|
|E_XML_ATTR_SQ|<span class="qtext400">&amp;amp;</span>|<span class="qtext400">&amp;lt;</span>|-|-|<span class="qtext400">&amp;apos;</span>|<span class="qtext400">&amp;#9;</span>|<span class="qtext400">&amp;#xA;</span>|<span class="qtext400">&amp;#xD;</span>|-|-|-|-|
|E_HTML_TEXT|<span class="qtext400">&amp;amp;</span>|<span class="qtext400">&amp;lt;</span>|<span class="qtext400">&amp;gt;</span>|-|-|-|-|-|-|-|-|-|
|E_HTML_ATTR|<span class="qtext400">&amp;amp;</span>|<span class="qtext400">&amp;lt;</span>|<span class="qtext400">&amp;gt;</span>|<span class="qtext400">&amp;quot;</span>|<span class="qtext400">&amp;#39;</span>|-|-|-|-|-|-|-|
|E_HTML_ATTR_DQ|<span class="qtext400">&amp;amp;</span>|<span class="qtext400">&amp;lt;</span>|<span class="qtext400">&amp;gt;</span>|<span class="qtext400">&amp;quot;</span>|-|-|-|-|-|-|-|-|
|E_HTML_ATTR_SQ|<span class="qtext400">&amp;amp;</span>|<span class="qtext400">&amp;lt;</span>|<span class="qtext400">&amp;gt;</span>|-|<span class="qtext400">&amp;#39;</span>|-|-|-|-|-|-|-|
|E_HTML_JS|-|-|-|<span class="qtext400">\&quot;</span>|<span class="qtext400">\&apos;</span>|<span class="qtext400">\t</span>|<span class="qtext400">\n</span>|<span class="qtext400">\r</span>|<span class="qtext400">\b</span>|<span class="qtext400">\f</span>|<span class="qtext400">\</span>|<span class="qtext400">\xhh</span>|
|E_HTML_JS_HTML|<span class="qtext400">&amp;amp;</span>|<span class="qtext400">&amp;lt;</span>|<span class="qtext400">&amp;gt;</span>|<span class="qtext400">&amp;quot;</span>|<span class="qtext400">&amp;#39;</span>|<span class="qtext400">\t</span>|<span class="qtext400">\n</span>|<span class="qtext400">\r</span>|<span class="qtext400">\b</span>|<span class="qtext400">\f</span>|<span class="qtext400">\</span>|<span class="qtext400">\xhh</span>|</p>
<p>The first column contains the names of the formats from the class CL_ABAP_FORMAT. The other columns
show the escape characters that replace the special characters in the first row. None of the other characters
are affected. <span class="qtext400">TAB</span>, <span class="qtext400">LF</span>, <span class="qtext400">CR</span>,
<span class="qtext400">BS</span>, and <span class="qtext400">FF</span> are the control characters for
tabulator, Line Feed, Carriage Return, Backspace, and Form Feed, to which the codes <span class="qtext400">x09</span>,
<span class="qtext400">x0A</span>, <span class="qtext400">x0D</span>, <span class="qtext400">x08</span>, and <span class="qtext400">x0C</span> are assigned in 7-Bit ASCII.
 <span class="qtext400">ctrl-char</span> stands for all control characters with codes less than <span class="qtext400">
x20</span> that are not covered by those characters listed explicitly. Some of these can be converted
to <span class="qtext400">\xhh</span>, where <span class="qtext400">&quot;hh&quot;</span> is the hexadecimal value of the code. If there is no value in a field (-), the special character is not affected.</p>
<p><br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>The result of the following masking is <span class="qtext400">IF a &amp;lt; b</span>.</p>
<p><div class="highlight"><pre><span></span><code><span class="nv">cl_demo_output</span><span class="o">=&gt;</span><span class="nf">display</span><span class="p">(</span> 
  <span class="nv">escape</span><span class="p">(</span> <span class="nv">val</span>    <span class="o">=</span> <span class="s1">&#39;IF a &lt; b.&#39;</span> 
          <span class="k">format</span> <span class="o">=</span> <span class="nv">cl_abap_format</span><span class="o">=&gt;</span><span class="nv">e_xml_text</span> <span class="p">)</span> <span class="p">).</span>
</code></pre></div>
</div></p>
<h3 id="executable-example">Executable Example</h3>
<p><a href="../abenstring_function_escape_abexa" class="blue">String Functions, <code style="display: inline;"><span class="qtext">escape</span></code> for HTML</a></p>
<p><a name="@@ITOC@@ABENESCAPE_FUNCTIONS_2"></a></p>
<h2 id="rules-for-urluris">Rules for URL/URIs</h2>
<p>The program <span class="lnkgrey">DEMO_ESCAPE_URL_URI</span> demonstrates the escape rules for URLs
and URIs. All characters with codes between x00 and 7F are converted to <span class="qtext400">%hh</span>
(except for the characters listed in the following table), where <span class="qtext400">hh</span> is
the hexadecimal value of the code. In URI_1 format, quotation marks are not converted to <span class="qtext400">%hh</span>, but are doubled.</p>
<table>
<thead>
<tr>
<th>Format</th>
<th>Unconverted Characters</th>
</tr>
</thead>
<tbody>
<tr>
<td>E_URL</td>
<td><span class="qtext400">[0-9]</span>, <span class="qtext400">[a-z]</span>, <span class="qtext400">[A-Z]</span>,<span class="qtext400">!</span>, <span class="qtext400">$</span>, <span class="qtext400">&apos;</span>, <span class="qtext400">(</span>, <span class="qtext400">)</span>, <span class="qtext400">*</span>, <span class="qtext400">+</span>,<span class="qtext400">,</span>, <span class="qtext400">-</span>, <span class="qtext400">.</span>, <span class="qtext400">_</span>, <span class="qtext400">&amp;</span>, <span class="qtext400">/</span>, <span class="qtext400">:</span>,<span class="qtext400">;</span>, <span class="qtext400">=</span>, <span class="qtext400">?</span>, <span class="qtext400">@</span></td>
</tr>
<tr>
<td>E_URL_FULL</td>
<td><span class="qtext400">[0-9]</span>, <span class="qtext400">[a-z]</span>, <span class="qtext400">[A-Z]</span>,<span class="qtext400">!</span>, <span class="qtext400">$</span>, <span class="qtext400">&apos;</span>, <span class="qtext400">(</span>, <span class="qtext400">)</span>, <span class="qtext400">*</span>, <span class="qtext400">+</span>,<span class="qtext400">,</span>, <span class="qtext400">-</span>, <span class="qtext400">.</span>, <span class="qtext400">_</span></td>
</tr>
<tr>
<td>E_URI</td>
<td><span class="qtext400">[0-9]</span>, <span class="qtext400">[a-z]</span>, <span class="qtext400">[A-Z]</span>,<span class="qtext400">!</span>, <span class="qtext400">$</span>, <span class="qtext400">&apos;</span>, <span class="qtext400">(</span>, <span class="qtext400">)</span>, <span class="qtext400">*</span>, <span class="qtext400">+</span>,<span class="qtext400">,</span>, <span class="qtext400">-</span>, <span class="qtext400">.</span>, <span class="qtext400">_</span>, <span class="qtext400">&amp;</span>, <span class="qtext400">/</span>, <span class="qtext400">:</span>,<span class="qtext400">;</span>, <span class="qtext400">=</span>, <span class="qtext400">?</span>, <span class="qtext400">@</span>, <span class="qtext400">~</span>, <span class="qtext400">#</span>, <span class="qtext400">[</span>, <span class="qtext400">]</span></td>
</tr>
<tr>
<td>E_URI_FULL</td>
<td><span class="qtext400">[0-9]</span>, <span class="qtext400">[a-z]</span>, <span class="qtext400">[A-Z]</span>,<span class="qtext400">-</span>, <span class="qtext400">.</span>, <span class="qtext400">_</span>, <span class="qtext400">~</span></td>
</tr>
<tr>
<td>E_URI_1</td>
<td><span class="qtext400">[0-9]</span>, <span class="qtext400">[a-z]</span>, <span class="qtext400">[A-Z]</span>,<span class="qtext400">!</span>, <span class="qtext400">$</span>, <span class="qtext400">(</span>, <span class="qtext400">)</span>, <span class="qtext400">*</span>, <span class="qtext400">+</span>, <span class="qtext400">,</span>,<span class="qtext400">-</span>, <span class="qtext400">.</span>, <span class="qtext400">_</span>, <span class="qtext400">;</span>, <span class="qtext400">=</span>, <span class="qtext400">@</span>, <span class="qtext400">~</span>, <span class="qtext400">[</span>, <span class="qtext400">]</span></td>
</tr>
</tbody>
</table>
<p>All characters with codes from <span class="qtext400">x80</span> are converted to their
<a href="../abenutf8_glosry" class="grey" title="Glossary Entry">UTF-8</a> representation. Depending
on the character, one to four bytes are represented in the form <span class="qtext400">%hh</span>, where <span class="qtext400">hh</span> is the hexadecimal value of a byte.</p>
<p><br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>The result of the following masking is <span class="qtext400">Numbers%3A%201,%202</span>.</p>
<p><div class="highlight"><pre><span></span><code><span class="nv">cl_demo_output</span><span class="o">=&gt;</span><span class="nf">display</span><span class="p">(</span> 
  <span class="nv">escape</span><span class="p">(</span> <span class="nv">val</span>    <span class="o">=</span> <span class="s1">&#39;Numbers: 1, 2&#39;</span> 
          <span class="k">format</span> <span class="o">=</span> <span class="nv">cl_abap_format</span><span class="o">=&gt;</span><span class="nv">e_url_full</span> <span class="p">)</span> <span class="p">).</span>
</code></pre></div>
<a name="@@ITOC@@ABENESCAPE_FUNCTIONS_3"></a>
</div></p>
<h2 id="rules-for-json">Rules for JSON</h2>
<p>The program <span class="lnkgrey">DEMO_ESCAPE_JSON</span> demonstrates the escape rules of the format E_JSON_STRING for
<a href="../abenjson_glosry" class="grey" title="Glossary Entry">JSON</a>. The special characters <span class="qtext400">
&quot;</span> and <span class="qtext400">\</span> are prefixed with the escape character <span class="qtext400">\</span>.
Control characters with the codes <span class="qtext400">x08</span>, <span class="qtext400">x09</span>,
<span class="qtext400">x0A</span>, <span class="qtext400">x0C</span>, and <span class="qtext400">x0D</span>
are escaped using <span class="qtext400">\b</span>, <span class="qtext400">\t</span>, <span class="qtext400">\n</span>,
<span class="qtext400">\f</span>, and <span class="qtext400">\r</span> respectively. All other codes
less than <span class="qtext400">x20</span> are converted to a four-character hexadecimal representation and prefixed by <span class="qtext400">\u</span>. None of the other characters are affected.</p>
<p><br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>The result of the following masking is <span class="qtext400">This is a backslash:</span>.<span class="qtext400"> \&quot;\\&quot;</span>.</p>
<p><div class="highlight"><pre><span></span><code><span class="nv">cl_demo_output</span><span class="o">=&gt;</span><span class="nf">display</span><span class="p">(</span> 
  <span class="nv">escape</span><span class="p">(</span> <span class="nv">val</span>    <span class="o">=</span> <span class="s1">&#39;This is a backslash: &quot;\&quot;&#39;</span> 
          <span class="k">format</span> <span class="o">=</span> <span class="nv">cl_abap_format</span><span class="o">=&gt;</span><span class="nv">e_json_string</span> <span class="p">)</span> <span class="p">).</span>
</code></pre></div>
<a name="@@ITOC@@ABENESCAPE_FUNCTIONS_4"></a>
</div></p>
<h2 id="rules-for-regular-expressions">Rules for Regular Expressions</h2>
<p>The program <span class="lnkgrey">DEMO_ESCAPE_REGEX</span> demonstrates the escape rules of the format E_REGEX for regular expressions. The
<a href="../abenregex_syntax_specials" class="blue">special characters of regular expressions</a> are
prefixed by the associated escape character <span class="qtext400">\</span>. Control characters with
the codes <span class="qtext400">x08</span>, <span class="qtext400">x09</span>, <span class="qtext400">x0A</span>,
<span class="qtext400">x0B</span>, <span class="qtext400">x0C</span>, and <span class="qtext400">x0D</span>
are escaped using <span class="qtext400">\b</span>, <span class="qtext400">\t</span>, <span class="qtext400">\n</span>,
<span class="qtext400">\v</span>, <span class="qtext400">\f</span>, and <span class="qtext400">\r</span> respectively.</p>
<p><br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>The result of the following masking is <span class="qtext400">&quot;.&quot; matches one, &quot;*&quot; matches many&quot;</span>.</p>
<p><div class="highlight"><pre><span></span><code><span class="nv">cl_demo_output</span><span class="o">=&gt;</span><span class="nf">display</span><span class="p">(</span> 
  <span class="nv">escape</span><span class="p">(</span> <span class="nv">val</span>    <span class="o">=</span> <span class="s1">&#39;&quot;.&quot; matches one, &quot;*&quot; matches many&quot;&#39;</span> 
          <span class="k">format</span> <span class="o">=</span> <span class="nv">cl_abap_format</span><span class="o">=&gt;</span><span class="nv">e_regex</span> <span class="p">)</span> <span class="p">).</span>
</code></pre></div>
<a name="@@ITOC@@ABENESCAPE_FUNCTIONS_5"></a>
</div></p>
<h2 id="rules-for-string-templates">Rules for String Templates</h2>
<p>The program <span class="lnkgrey">DEMO_ESCAPE_STRING_TEMPLATE</span> demonstrates the escape rules of the format E_STRING_TPL for string templates. The special characters of
<a href="../abenstring_templates" class="blue">string templates</a>
(<span class="qtext400">|</span>, <span class="qtext400">\</span>, <span class="qtext400">{</span>,
<span class="qtext400">}</span>) are prefixed by the associated escape character <span class="qtext400">\</span>.
Control characters with the codes <span class="qtext400">x09</span>, <span class="qtext400">x0A</span>,
and <span class="qtext400">x0D</span> are replaced by <span class="qtext400">\t</span>, <span class="qtext400">\n</span>, and <span class="qtext400">\r</span> respectively.</p>
<p><br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>The result of the following masking is <span class="qtext400">Special characters: |, \, {, }</span>.</p>
<p><div class="highlight"><pre><span></span><code><span class="nv">cl_demo_output</span><span class="o">=&gt;</span><span class="nf">display</span><span class="p">(</span> 
  <span class="nv">escape</span><span class="p">(</span> <span class="nv">val</span>    <span class="o">=</span> <span class="s1">&#39;Special characters: |, \, {, }&#39;</span> 
          <span class="k">format</span> <span class="o">=</span> <span class="nv">cl_abap_format</span><span class="o">=&gt;</span><span class="nv">e_string_tpl</span> <span class="p">)</span> <span class="p">).</span>
</code></pre></div>
<a name="@@ITOC@@ABENESCAPE_FUNCTIONS_6"></a>
</div></p>
<h2 id="rules-for-cross-site-scripting">Rules for Cross Site Scripting</h2>
<p>The program <span class="lnkgrey">DEMO_ESCAPE_XSS</span> demonstrates the escape rules of the formats E_XSS_... that enable attacks using Cross Site Scripting
(<a href="../abenxss_glosry" class="grey" title="Glossary Entry">XSS</a>) on Web applications to be prevented. Rules exist for XML/HTML content, JavaScript content, Cascading Style Sheets (CSS), and URL content.</p>
<p>The rules for XSS include all the rules for individual formats, plus some extra rules. They are particularly
distinct from the rules for markup languages, including JavaScript (see above). These extended rules
are designed to be used to protect ABAP programs from Cross Site Scripting, when content can be constructed from non-secure sources. The transformations listed above are replaced or modified as follows:</p>
<ul>

<li><span class="bold">Markup languages</span>: Format E_XSS_ML. All characters (except <span class="qtext400">[0-9]</span>,
<span class="qtext400">[a-z]</span>, <span class="qtext400">[A-Z]</span>, <span class="qtext400">,</span>,
<span class="qtext400">-</span>, <span class="qtext400">.</span>, <span class="qtext400">_</span>, and control characters) are transformed to
 <span class="qtext400">&amp;#xhh;</span> or <span class="qtext400">&amp;#xhhhh;</span>, where <span class="qtext400">
hh</span> or <span class="qtext400">hhhh</span> is the hexadecimal value of the code. All control characters are transformed to <span class="qtext400">&amp;#xfffd;</span>.</li>

</ul>

<ul>

<li><span class="bold">JavaScript</span>:  Format E_XSS_JS. All characters (except <span class="qtext400">[0-9]</span>,
<span class="qtext400">[a-z]</span>, <span class="qtext400">[A-Z]</span>, <span class="qtext400">,</span>,
<span class="qtext400">.</span>, and <span class="qtext400">_</span>) are transformed to <span class="qtext400">\xhh</span>
or <span class="qtext400">\uhhhh</span>, where <span class="qtext400">hh</span> or <span class="qtext400">hhhh</span> is the hexadecimal value of the code.</li>

</ul>

<ul>

<li><span class="bold">URL/URIs</span>:  Format E_XSS_URL. All characters (except <span class="qtext400">[0-9]</span>,
<span class="qtext400">[a-z]</span>, <span class="qtext400">[A-Z]</span>, <span class="qtext400">*</span>,
<span class="qtext400">-</span>, <span class="qtext400">.</span>, and <span class="qtext400">_</span>)
are transformed to <span class="qtext400">%hh</span>, where <span class="qtext400">hh</span> is the hexadecimal value of the code. All characters with codes from x80 are converted to their
<a href="../abenutf8_glosry" class="grey" title="Glossary Entry">UTF-8</a> representation. Depending
on the character, one to four bytes are represented in the form <span class="qtext400">%hh</span>, where <span class="qtext400">hh</span> is the hexadecimal value of a byte.</li>

</ul>

<ul>

<li><span class="bold">CSS</span>: Format E_XSS_CSS. All characters (except <span class="qtext400">[0-9]</span>,
<span class="qtext400">[a-z]</span>, and <span class="qtext400">[A-Z]</span>) are transformed to <span class="qtext400">
\hh</span> or <span class="qtext400">\hhhh</span>, where <span class="qtext400">hh</span> or <span class="qtext400">hhhh</span>
is the hexadecimal value of the code. A blank is inserted after <span class="qtext400">hh</span> or <span class="qtext400">hhhh</span> if the following character is a valid hexadecimal digit.</li>

</ul>

<p>If the format from the class CL_ABAP_FORMAT has the additional ending <span class="qtext400">&quot;_NU&quot;</span>,
all characters with codes greater than <span class="qtext400">xFF</span> are converted to a four-character
hexadecimal representation, with varying marking depending on the type of the content. The additional
ending <span class="qtext400">&quot;_7B&quot;</span> means 7 bit and also affects characters with codes greater than <span class="qtext400">xFF</span>.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>The class <span class="lnkgrey">CL_ABAP_DYN_PRG</span> contains methods ESCAPE_XSS_... that wrap
calls of the predefined function <code style="display: inline;"><span class="qtext">escape</span></code> with the formats E_XSS_.... It is generally advisable to use the predefined function directly.</li>

<p></ul>
<ul></p>
<li><code style="display: inline;"><span class="qtext">escape</span></code> used with rules for XSS is recommended as protection against cross
site scripting, but might not be secure enough in all cases. For example, it may be best to use a whitelist
to check an unsafe URL, so that phishing attacks can be detected as well as XSS. To guarantee that no code injections are used, JavaScript should never be created dynamically from unsafe sources.</li>

<p></ul>
</div>
<br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>The result of the following masking is <span class="qtext400">German&amp;#x20;umlauts&amp;#x3a;&amp;#x20;&amp;#x22;&amp;#xe4;&amp;#xf6;&amp;#xfc;&amp;#x22;</span>.</p>
<p><div class="highlight"><pre><span></span><code><span class="nv">cl_demo_output</span><span class="o">=&gt;</span><span class="nf">display</span><span class="p">(</span> 
  <span class="nv">escape</span><span class="p">(</span> <span class="nv">val</span>    <span class="o">=</span> <span class="s1">&#39;German umlauts: &quot;äöü&quot;&#39;</span> 
          <span class="k">format</span> <span class="o">=</span> <span class="nv">cl_abap_format</span><span class="o">=&gt;</span><span class="nv">e_xss_ml</span> <span class="p">)</span> <span class="p">).</span>
</code></pre></div>
</div></p>
<h3 id="executable-example_1">Executable Example</h3>
<p><a href="../abenstring_function_esc_xss_abexa" class="blue">String Functions, <code style="display: inline;"><span class="qtext">escape</span></code> for XSS</a>  </p>
<h3 id="exceptions">Exceptions</h3>
<h3 id="handleable-exceptions">Handleable Exceptions</h3>
<p><span class="lnkgrey">CX_SY_CONVERSION_CODEPAGE_EX</span></p>
<ul>

<li>
<span class="italic">Cause:</span> A character cannot be converted in a conversion to UTF-8. This can only occur with characters from the
<a href="../abensurrogate_area_glosry" class="grey" title="Glossary Entry">surrogate area</a>. The position and code of the character is specified in the exception object. <br>
<span class="italic">Runtime error:</span> <code style="display: inline;"><span class="qtext">CONVT_CHARACTER</span></code>
<br></li>

</ul>

<p><span class="lnkgrey">CX_SY_STRG_PAR_VAL</span></p>
<ul>

<li>
<span class="italic">Cause:</span> Invalid value in <code style="display: inline;"><span class="qtext">format</span></code>. <br><span class="italic">Runtime error:</span> <code style="display: inline;"><span class="qtext">STRG_ILLEGAL_PAR</span></code>
<br></li>

</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.df0def68.min.js"></script>
      <script src="../../assets/javascripts/bundle.ba57d267.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js"></script>
      
        <script src="../../javascript/hljs.js"></script>
      
    
  </body>
</html>