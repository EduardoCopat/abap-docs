


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.9">
    
    
      
        <title>AT - Group Level Processing - ABAP docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.36ee6aaa.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.83bccb1f.min.css">
      
      
        
        
        <meta name="theme-color" content="#4051b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://raw.githubusercontent.com/highlightjs/highlight.js/master/src/styles/github.css">
    
      <link rel="stylesheet" href="../../css/abap-docs.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#at-group-level-processing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="ABAP docs" class="md-header-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            ABAP docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              AT - Group Level Processing
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ABAP docs" class="md-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ABAP docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="ABAP docs" class="md-nav__link">
      ABAP docs
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#syntax" class="md-nav__link">
    Syntax
  </a>
  
    <nav class="md-nav" aria-label="Syntax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extras" class="md-nav__link">
    Extras
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#effect" class="md-nav__link">
    Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executable-examples" class="md-nav__link">
    Executable Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addition-1" class="md-nav__link">
    Addition 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#effect_1" class="md-nav__link">
    Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addition-2" class="md-nav__link">
    Addition 2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#effect_2" class="md-nav__link">
    Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addition-3" class="md-nav__link">
    Addition 3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#effect_3" class="md-nav__link">
    Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exceptions" class="md-nav__link">
    Exceptions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-handleable-exceptions" class="md-nav__link">
    Non-Handleable Exceptions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continue" class="md-nav__link">
    Continue
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/eduardocopat/abap-docs/edit/master/docs/7.54/abapat_itab.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="at-group-level-processing">AT - Group Level Processing</h1>
<p><a href="../abapat_shortref" class="blue">Quick Reference</a>  </p>
<p><a href="../abapat_itab">7.31</a> <a href="../abapat_itab">7.40</a> <b>7.54</b></p>
<p><small>
<a href="../abenabap" class="blue">ABAP Keyword Documentation</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_reference" class="blue">ABAP &#x2212; Reference</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_data_working" class="blue">Processing Internal Data</a>&#xA0;&#x2192;&#xA0;
<a href="../abenitab" class="blue">Internal Tables</a>&#xA0;&#x2192;&#xA0;
<a href="../abentable_processing_statements" class="blue">Processing Statements for Internal Tables</a>&#xA0;&#x2192;&#xA0;
<a href="../abaploop_at_itab_variants" class="blue">LOOP AT itab</a>&#xA0;&#x2192;&#xA0;
<a href="../abaploop_at_itab" class="blue">LOOP AT itab - Basic Form</a>&#xA0;</small></p>
<h2 id="syntax">Syntax</h2>
<p><pre><code class="hljs abap abap-docs-syntax-block">
<span class="qtext"><a href="../abaploop_at_itab" class="blue">LOOP AT itab</a>
<a href="../abaploop_at_itab_result" class="blue">result</a> <i class="bn">[</i><a href="../abaploop_at_itab_cond" class="blue">cond</a><i class="bn">]</i>.</span> <br>
<span class="qtext">&#xA0;&#xA0;<i class="bn">[</i>AT FIRST.</span> <br><span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0; ...</span> <br>
<span class="qtext">&#xA0;&#xA0; ENDAT.<i class="bn">]</i></span> <br><span class="qtext">&#xA0;&#xA0;
&#xA0;<i class="bn">[</i>AT NEW <a href="../abenitab_components" class="blue">comp1</a>.</span> <br><span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; ...</span> <br>
<span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0; ENDAT.</span> <br><span class="qtext">&#xA0;&#xA0;&#xA0;
&#xA0;&#xA0; <i class="bn">[</i>AT NEW <a href="../abenitab_components" class="blue">comp2</a>.</span> <br>
<span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; ...</span> <br><span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; ENDAT.</span> <br>
<span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <i class="bn">[</i>...<i class="bn">]</i><i class="bn">]</i><i class="bn">]</i></span> <br>
<span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <i class="bn">[</i> ... <i class="bn">]</i></span> <br>
<span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <i class="bn">[</i><i class="bn">[</i><i class="bn">[</i>...<i class="bn">]</i></span> <br>
<span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; AT END OF <a href="../abenitab_components" class="blue">comp2</a>.</span> <br>
<span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; ...</span> <br><span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; ENDAT.<i class="bn">]</i></span> <br>
<span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0; AT END OF <a href="../abenitab_components" class="blue">comp1</a>.</span> <br>
<span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; ...</span> <br><span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0; ENDAT.<i class="bn">]</i></span> <br>
<span class="qtext">&#xA0;&#xA0;<i class="bn">[</i>AT LAST.</span> <br><span class="qtext">&#xA0;&#xA0;&#xA0;&#xA0; ...</span> <br>
<span class="qtext">&#xA0;&#xA0;ENDAT.<i class="bn">]</i></span> <br><span class="qtext">ENDLOOP.</span> 
</code></pre></p>
<h3 id="extras">Extras</h3>
<p><a href="#!ABAP_ADDITION_1@1@" class="blue"> 1. <code style="display: inline;"><span class="qtext">...&#xA0;&#xA0;FIRST</span></code> </a> <br>
<br><a href="#!ABAP_ADDITION_2@2@" class="blue"> 2. <code style="display: inline;"><span class="qtext">... <i class="bn">{</i>NEW<i class="bn">}</i><i class="bn">|</i><i class="bn">{</i>END OF<i class="bn">}</i> compi</span></code> </a> <br>
<br><a href="#!ABAP_ADDITION_3@3@" class="blue"> 3. <code style="display: inline;"><span class="qtext">...&#xA0;&#xA0;LAST</span></code> </a>  </p>
<h3 id="effect">Effect</h3>
<p>The statement block of a <a href="../abaploop_at_itab" class="blue"><code style="display: inline;"><span class="qtext">LOOP</span></code></a>
without the addition <a href="../abaploop_at_itab_group_by" class="blue"><code style="display: inline;"><span class="qtext">GROUP BY</span></code></a> can contain control structures for
<a href="../abencontrol_level_processin_glosry" class="grey" title="Glossary Entry">group level processing</a>.
The corresponding control statement is <code style="display: inline;"><span class="qtext">AT</span></code>. The statements <code style="display: inline;"><span class="qtext">AT</span></code> and <code style="display: inline;"><span class="qtext">ENDAT</span></code> define statement blocks that are executed at
<a href="../abencontrol_break_glosry" class="grey" title="Glossary Entry">group breaks</a>, that is in the transition of a
<a href="../abencontrol_level_glosry" class="grey" title="Glossary Entry">group level</a> to another
group level. The additions of the statements <code style="display: inline;"><span class="qtext">AT</span></code> define the criteria for a
group break and hence the group levels. Group breaks between group levels are a result of the row structure
and the processing order in which the <code style="display: inline;"><span class="qtext">LOOP</span></code> reads the rows of the internal
table. Within the statement blocks, the statement <a href="../abapsum" class="blue"><code style="display: inline;"><span class="qtext">SUM</span></code></a> can be specified to total the numeric components of a group level.</p>
<p>Apart from the special variants <code style="display: inline;"><span class="qtext">AT FIRST</span></code> and <code style="display: inline;"><span class="qtext">AT LAST</span></code>,
group levels are defined using the variants <code style="display: inline;"><span class="qtext">AT NEW</span></code> <span class="qtext">AT
END OF</span> and the sequence of rows (in accordance with the processing order of the loop) in the
internal table. These are the rows that have the same content in a group key defined in their initial
parts. Here, all rows of the internal table are respected without evaluating any restricting conditions <a href="../abaploop_at_itab_cond" class="blue"><code style="display: inline;"><span class="qtext">cond</span></code></a>.</p>
<p>It is possible, from a syntax point of view, to arrange <code style="display: inline;"><span class="qtext">AT</span></code> control structures
in any order and to nest them, however effective group level processing is usually only achieved by
the arrangement above. Here, the control structures are specified in accordance with the arrangement of the components in the group key and are not nested.</p>
<p>The statement blocks within the <code style="display: inline;"><span class="qtext">AT</span></code>-<code style="display: inline;"><span class="qtext">ENDAT</span></code> control
structures are listed if an appropriate group break is made in the current table line. Statements in
the <code style="display: inline;"><span class="qtext">LOOP</span></code>-<code style="display: inline;"><span class="qtext">ENDLOOP</span></code> control structure that are not
executed within an <code style="display: inline;"><span class="qtext">AT</span></code>-<code style="display: inline;"><span class="qtext">ENDAT</span></code> control structure
are executed in each pass of the loop. If a table row with a group break is not read due to a restricting
condition <a href="../abaploop_at_itab_cond" class="blue"><code style="display: inline;"><span class="qtext">cond</span></code></a>, the statement block in question is not executed.</p>
<p>The following rules must be followed for effective group level processing:</p>
<ul>

<li>
A table key specified in <code style="display: inline;"><span class="qtext">LOOP</span></code> in <a href="../abaploop_at_itab_cond" class="blue"><span class="qtext">
cond</span></a> must be chosen so that it produces the required processing order of the imported rows. 
</li>
<li>
No restricting condition <a href="../abaploop_at_itab_cond" class="blue"><code style="display: inline;"><span class="qtext">cond</span></code></a>
should be specified. If a condition like this is specified, it should select consecutive row groups (including the first row in the group) where the group break takes place. 
</li>
<li>
The internal table cannot be modified within the <code style="display: inline;"><span class="qtext">LOOP</span></code> loop. 
</li>
<li>
A work area <code style="display: inline;"><span class="qtext">wa</span></code> specified in the <code style="display: inline;"><span class="qtext">LOOP</span></code> statement after the addition <code style="display: inline;"><span class="qtext">INTO</span></code> must be
<a href="../abencompatible_glosry" class="grey" title="Glossary Entry">compatible</a> with the row type of the table. 
</li>
<li>
A field symbol <code style="display: inline;"><span class="qtext">&lt;fs&gt;</span></code> specified in the statement <code style="display: inline;"><span class="qtext">LOOP</span></code> after the addition <code style="display: inline;"><span class="qtext">ASSIGNING</span></code> must be typed with the row type of the table. 
</li>
<li>
The content of a work area <a href="../abaploop_at_itab" class="blue"><code style="display: inline;"><span class="qtext">wa</span></code></a>
specified in the statement <a href="../abaploop_at_itab_result" class="blue"><code style="display: inline;"><span class="qtext">LOOP</span></code></a> after the addition <code style="display: inline;"><span class="qtext">INTO</span></code> cannot be modified.
<br></li>

</ul>

<p>If the addition <a href="../abaploop_at_itab_result" class="blue"><code style="display: inline;"><span class="qtext">INTO wa</span></code></a>
is used in the statement <a href="../abaploop_at_itab" class="blue"><code style="display: inline;"><span class="qtext">LOOP</span></code></a>,
the content of <code style="display: inline;"><span class="qtext">wa</span></code> is overwritten (depending on the respective group level)
when the <code style="display: inline;"><span class="qtext">AT</span></code>-<code style="display: inline;"><span class="qtext">ENDAT</span></code> control structure is entered,
and is reset to the content of the current row when the control structure is exited. When the additions
<a href="../abaploop_at_itab_result" class="blue"><code style="display: inline;"><span class="qtext">ASSIGNING</span></code></a> and <a href="../abaploop_at_itab_result" class="blue">
<code style="display: inline;"><span class="qtext">REFERENCE INTO</span></code></a> are used, the referenced table rows are not modified when entering and exiting the <code style="display: inline;"><span class="qtext">AT</span></code>-<code style="display: inline;"><span class="qtext">ENDAT</span></code> control structure.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>
The most common case is when the internal table is sorted exactly by the order of the components of
its row type, by the first component first, then the second component, and so on. In this case, group
level processing can also be expressed using a grouping with the addition <a href="../abaploop_at_itab_group_by" class="blue"><code style="display: inline;"><span class="qtext">GROUP BY</span></code></a>.
</li>

<li>
If possible, the use of the addition <a href="../abaploop_at_itab_group_by" class="blue"><span class="qtext">GROUP
BY</span></a> is recommended, since the grouping is not determined by the structure of the rows and the processing order in this case.
</li>

<li>
Group level processing with the statement <code style="display: inline;"><span class="qtext">AT</span></code> is not possible in <code style="display: inline;"><span class="qtext">LOOP</span></code>s
across row groups with the addition <a href="../abaploop_at_itab_group_by" class="blue"><span class="qtext">GROUP
BY</span></a>, including member loops using <a href="../abaploop_at_group" class="blue"><code style="display: inline;"><span class="qtext">LOOP AT GROUP</span></code></a>.
</li>

<li>
The group level processing described here can produce unexpected results when a restricting condition
<a href="../abaploop_at_itab_cond" class="blue"><code style="display: inline;"><span class="qtext">cond</span></code></a> is used, which means that extended syntax check messages can occur. <br>
</li>

<p></ul>
</div></p>
<h3 id="executable-examples">Executable Examples</h3>
<p><a href="../abenat_itab_abexas" class="blue">Group Level Processing</a>  </p>
<p><a name="@@FIRST@@AT - itab@@"></a></p>
<h3 id="addition-1">Addition 1</h3>
<p><code style="display: inline;"><span class="qtext">... FIRST</span></code>   <br><!-- /A --></p>
<h3 id="effect_1">Effect</h3>
<p>The group level is defined by the first row of the internal table. The group break takes place when
this row is read. In the group level <code style="display: inline;"><span class="qtext">AT FIRST</span></code>, the current group key does not contain any components.</p>
<p>If the addition <a href="../abaploop_at_itab_result" class="blue"><code style="display: inline;"><span class="qtext">INTO wa</span></code></a>
is used in the statement <a href="../abaploop_at_itab" class="blue"><code style="display: inline;"><span class="qtext">LOOP</span></code></a>,
all character-like components of the work area <code style="display: inline;"><span class="qtext">wa</span></code> are filled with &quot;*&quot; when
the control structure <code style="display: inline;"><span class="qtext">AT FIRST</span></code> is entered and all other components are set
to their initial value. In the case of an elementary row type, this applies to the whole work area.
When the <code style="display: inline;"><span class="qtext">AT</span></code>-<code style="display: inline;"><span class="qtext">ENDAT</span></code> control structure is exited, the content of the current table row is reassigned to the work area <code style="display: inline;"><span class="qtext">wa</span></code>.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Note</p></p>
<p>If the first row of the internal table is not read due to a restricting condition <a href="../abaploop_at_itab_cond" class="blue">
<code style="display: inline;"><span class="qtext">cond</span></code></a>, the statement block of the control structure <code style="display: inline;"><span class="qtext">AT FIRST</span></code> is not executed.  </p>
<p></div>
<br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>Displays a header and the first row of an internal table at the group level <code style="display: inline;"><span class="qtext">AT FIRST</span></code>.</p>
<p><div class="highlight"><pre><span></span><code><span class="k">DATA</span> <span class="nv">itab</span> <span class="k">TYPE SORTED TABLE OF</span> <span class="nv">scarr</span> 
               <span class="k">WITH UNIQUE KEY</span> <span class="nv">carrid</span><span class="p">.</span> 

<span class="k">SELECT</span> <span class="o">*</span> 
       <span class="k">FROM</span> <span class="nv">scarr</span> 
       <span class="k">INTO</span> <span class="k">TABLE</span> <span class="nv">itab</span><span class="p">.</span> 

<span class="k">DATA</span><span class="p">(</span><span class="nv">out</span><span class="p">)</span> <span class="o">=</span> <span class="nv">cl_demo_output</span><span class="o">=&gt;</span><span class="nf">new</span><span class="p">(</span> <span class="p">).</span> 
<span class="k">LOOP AT </span><span class="nv">itab</span> <span class="k">ASSIGNING</span> <span class="k">FIELD</span><span class="o">-</span><span class="nv">SYMBOL</span><span class="p">(</span><span class="nv">&lt;fs&gt;</span><span class="p">).</span> 
  <span class="k">AT FIRST</span><span class="p">.</span> 
    <span class="nv">out</span><span class="o">-&gt;</span><span class="nf">next_section</span><span class="p">(</span> <span class="s1">&#39;First&#39;</span> <span class="p">).</span> 
    <span class="nv">out</span><span class="o">-&gt;</span><span class="nf">write</span><span class="p">(</span> <span class="nv">&lt;fs&gt;</span> <span class="p">).</span> 
  <span class="k">ENDAT</span><span class="p">.</span> 
<span class="k">ENDLOOP</span><span class="p">.</span> 
<span class="nv">out</span><span class="o">-&gt;</span><span class="nf">display</span><span class="p">(</span> <span class="p">).</span> 
</code></pre></div>
<a name="@@NEW@@AT - itab@@"></a>
<a name="@@END OF@@AT -itab@@"></a>
</div></p>
<h3 id="addition-2">Addition 2</h3>
<p><code style="display: inline;"><span class="qtext">... <i class="bn">{</i>NEW<i class="bn">}</i><i class="bn">|</i><i class="bn">{</i>END OF<i class="bn">}</i> compi</span></code>   <br><!-- /A --></p>
<h3 id="effect_2">Effect</h3>
<p>Group levels are defined by the beginning or end of a group of rows with the same content in the component
<code style="display: inline;"><span class="qtext">compi</span></code> (where <code style="display: inline;"><span class="qtext">i</span></code> = <code style="display: inline;"><span class="qtext">1</span></code>,
<code style="display: inline;"><span class="qtext">2</span></code>, and so on) and in the components on the left of <code style="display: inline;"><span class="qtext">compi</span></code>.
The content of these components determines the group key. The group breaks take place when the content
of the component <code style="display: inline;"><span class="qtext">compi</span></code> or another component on the left of <code style="display: inline;"><span class="qtext">compi</span></code> changes.</p>
<p>The <code style="display: inline;"><span class="qtext">compi</span></code> components can be specified as described in
<a href="../abenitab_components" class="blue">Specification of Components</a>, with the limitation that access to data objects using references is not possible here. The following is therefore not possible:</p>
<ul>

<li>
Specifying data objects using data references
</li>
<li>
Specifying attributes of objects using object references
<br></li>

</ul>

<p>Otherwise, the specified components can have any data type. The relevant
<a href="../abenlogexp_rules" class="blue">comparison rules</a> apply to the evaluation. In the case of an elementary row type, only <code style="display: inline;"><span class="qtext">table_line</span></code> can be specified as the group key.</p>
<p>If the addition <a href="../abaploop_at_itab_result" class="blue"><code style="display: inline;"><span class="qtext">INTO wa</span></code></a>
is used in the statement <a href="../abaploop_at_itab" class="blue"><code style="display: inline;"><span class="qtext">LOOP</span></code></a>,
the content of <code style="display: inline;"><span class="qtext">wa</span></code> is modified as follows when the <code style="display: inline;"><span class="qtext">AT</span></code>-<code style="display: inline;"><span class="qtext">ENDAT</span></code> control structure is entered:</p>
<ul>

<li>
The components of the current group key remain unchanged.
</li>
<li>
All components with a character-like <a href="../abenflat_glosry" class="grey" title="Glossary Entry">flat</a> data type on the right of the current control key are set to the character &quot;*&quot; in every place.
</li>
<li>
All the other components to the right of the current group key are set to their <a href="../abeninitial_value_glosry" class="grey" title="Glossary Entry">initial value</a>.
<br></li>

</ul>

<p>In the case of an elementary row type, the whole work area corresponds to the current group key and
does not change. When the <code style="display: inline;"><span class="qtext">AT</span></code>-<code style="display: inline;"><span class="qtext">ENDAT</span></code> control structure
is exited, the content of the current table row is reassigned to the work area <code style="display: inline;"><span class="qtext">wa</span></code>.  </p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>
Group levels defined in this way consist of the contiguous rows of the internal table that have the same content in an initial part.
</li>

<li>
If the first or last row of a row group is not read due to a restricting condition <a href="../abaploop_at_itab_cond" class="blue">
<code style="display: inline;"><span class="qtext">cond</span></code></a>, the statement block of the control structure <code style="display: inline;"><span class="qtext">AT NEW</span></code> or <code style="display: inline;"><span class="qtext">AT END OF</span></code> is not executed.
</li>

<li>
An <a href="../abapat_itab_obsolete" class="blue">obsolete variant</a> allows field symbols to also be specified, outside of classes <code style="display: inline;"><span class="qtext">compi</span></code>. <br>
</li>

<p></ul>
</div>
<br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>Displays the <code style="display: inline;"><span class="qtext">carrid</span></code> column as a header for the chained content of the associated flight numbers.</p>
<p><div class="highlight"><pre><span></span><code><span class="k">DATA</span> <span class="nv">itab</span> <span class="k">TYPE SORTED TABLE OF</span> <span class="nv">spfli</span> 
               <span class="k">WITH UNIQUE KEY</span> <span class="nv">carrid</span> <span class="nv">connid</span><span class="p">.</span> 

<span class="k">SELECT</span> <span class="o">*</span> 
       <span class="k">FROM</span> <span class="nv">spfli</span> 
       <span class="k">INTO</span> <span class="k">TABLE</span> <span class="nv">itab</span><span class="p">.</span> 

<span class="k">DATA</span> <span class="nv">connids</span> <span class="k">TYPE </span><span class="nv">string</span><span class="p">.</span> 
<span class="k">DATA</span><span class="p">(</span><span class="nv">out</span><span class="p">)</span> <span class="o">=</span> <span class="nv">cl_demo_output</span><span class="o">=&gt;</span><span class="nf">new</span><span class="p">(</span> <span class="p">).</span> 
<span class="k">LOOP AT </span><span class="nv">itab</span> <span class="k">ASSIGNING</span> <span class="k">FIELD</span><span class="o">-</span><span class="nv">SYMBOL</span><span class="p">(</span><span class="nv">&lt;fs&gt;</span><span class="p">).</span> 
  <span class="k">AT NEW</span> <span class="nv">carrid</span><span class="p">.</span> 
    <span class="nv">out</span><span class="o">-&gt;</span><span class="nf">next_section</span><span class="p">(</span> <span class="nv">&lt;fs&gt;</span><span class="o">-</span><span class="nv">carrid</span> <span class="p">).</span> 
  <span class="k">ENDAT</span><span class="p">.</span> 
  <span class="nv">connids</span> <span class="o">=</span> <span class="nv">connids</span> <span class="o">&amp;&amp;</span> <span class="s1">` `</span> <span class="o">&amp;&amp;</span> <span class="nv">&lt;fs&gt;</span><span class="o">-</span><span class="nv">connid</span><span class="p">.</span> 
  <span class="k">AT END OF</span> <span class="nv">carrid</span><span class="p">.</span> 
    <span class="nv">out</span><span class="o">-&gt;</span><span class="nf">write</span><span class="p">(</span> <span class="nv">connids</span> <span class="p">).</span> 
    <span class="k">CLEAR</span> <span class="nv">connids</span><span class="p">.</span> 
  <span class="k">ENDAT</span><span class="p">.</span> 
<span class="k">ENDLOOP</span><span class="p">.</span> 
<span class="nv">out</span><span class="o">-&gt;</span><span class="nf">display</span><span class="p">(</span> <span class="p">).</span>
</code></pre></div>
</div>
<br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>The first row of the first row group is not read due to the addition <span class="qtext">FROM
2</span>, which means the associated statement block after <code style="display: inline;"><span class="qtext">AT NEW table_line</span></code> is not executed. The program therefore produces a message from the extended program check.</p>
<p><div class="highlight"><pre><span></span><code><span class="k">DATA</span> <span class="nv">itab</span> <span class="k">TYPE TABLE OF</span> <span class="nv">string</span> <span class="k">WITH</span> <span class="nv">EMPTY</span> <span class="k">KEY</span><span class="p">.</span> 

<span class="nv">itab</span> <span class="o">=</span> <span class="k">VALUE</span> <span class="err">#</span><span class="p">(</span> <span class="p">(</span> <span class="s1">`AA`</span> <span class="p">)</span> <span class="p">(</span> <span class="s1">`AA`</span> <span class="p">)</span> <span class="p">(</span> <span class="s1">`AA`</span> <span class="p">)</span> 
                <span class="p">(</span> <span class="s1">`BB`</span> <span class="p">)</span> <span class="p">(</span> <span class="s1">`BB`</span> <span class="p">)</span> <span class="p">(</span> <span class="s1">`BB`</span> <span class="p">)</span> <span class="p">).</span> 

<span class="k">DATA</span><span class="p">(</span><span class="nv">out</span><span class="p">)</span> <span class="o">=</span> <span class="nv">cl_demo_output</span><span class="o">=&gt;</span><span class="nf">new</span><span class="p">(</span> <span class="p">).</span> 
<span class="k">LOOP AT </span><span class="nv">itab</span> <span class="k">ASSIGNING</span> <span class="k">FIELD</span><span class="o">-</span><span class="nv">SYMBOL</span><span class="p">(</span><span class="nv">&lt;fs&gt;</span><span class="p">)</span> <span class="k">FROM</span> <span class="mi">2</span><span class="p">.</span> 
  <span class="k">AT NEW</span> <span class="nv">table_line</span><span class="p">.</span> 
    <span class="nv">out</span><span class="o">-&gt;</span><span class="nf">write</span><span class="p">(</span> <span class="nv">&lt;fs&gt;</span> <span class="p">).</span> 
  <span class="k">ENDAT</span><span class="p">.</span> 
<span class="k">ENDLOOP</span><span class="p">.</span> 
<span class="nv">out</span><span class="o">-&gt;</span><span class="nf">display</span><span class="p">(</span> <span class="p">).</span> 
</code></pre></div>
<a name="@@LAST@@AT - itab@@"></a>
</div></p>
<h3 id="addition-3">Addition 3</h3>
<p><code style="display: inline;"><span class="qtext">... LAST</span></code>   <br><!-- /A --></p>
<h3 id="effect_3">Effect</h3>
<p>The group level is defined by the last row of the internal table. The group break takes place when this
row is read. In the group level <code style="display: inline;"><span class="qtext">AT LAST</span></code>, the current group key does not contain any components.</p>
<p>If the addition <a href="../abaploop_at_itab_result" class="blue"><code style="display: inline;"><span class="qtext">INTO wa</span></code></a>
is used in the statement <a href="../abaploop_at_itab" class="blue"><code style="display: inline;"><span class="qtext">LOOP</span></code></a>,
all character-like components of the work area <code style="display: inline;"><span class="qtext">wa</span></code> are filled with &quot;*&quot; when
the control structure <code style="display: inline;"><span class="qtext">AT LAST</span></code> is entered and all other components are set
to their initial value. In the case of an elementary row type, this applies to the whole work area.
When the <code style="display: inline;"><span class="qtext">AT</span></code>-<code style="display: inline;"><span class="qtext">ENDAT</span></code> control structure is exited, the content of the current table row is reassigned to the work area <code style="display: inline;"><span class="qtext">wa</span></code>.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Note</p></p>
<p>If the last row of the internal table is not read due to a restricting condition <a href="../abaploop_at_itab_cond" class="blue">
<code style="display: inline;"><span class="qtext">cond</span></code></a>, the statement block of the control structure <code style="display: inline;"><span class="qtext">AT LAST</span></code> is not executed.  </p>
<p></div>
<br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>Displays cumulated content during the processing of the last row.</p>
<p><div class="highlight"><pre><span></span><code><span class="k">DATA</span> <span class="nv">itab</span> <span class="k">TYPE SORTED TABLE OF</span> <span class="nv">scarr</span> 
               <span class="k">WITH UNIQUE KEY</span> <span class="nv">carrid</span><span class="p">.</span> 

<span class="k">SELECT</span> <span class="o">*</span> 
       <span class="k">FROM</span> <span class="nv">scarr</span> 
       <span class="k">INTO</span> <span class="k">TABLE</span> <span class="nv">itab</span><span class="p">.</span> 

<span class="k">DATA</span> <span class="nv">carrids</span> <span class="k">TYPE </span><span class="nv">string</span><span class="p">.</span> 
<span class="k">LOOP AT </span><span class="nv">itab</span> <span class="k">ASSIGNING</span> <span class="k">FIELD</span><span class="o">-</span><span class="nv">SYMBOL</span><span class="p">(</span><span class="nv">&lt;fs&gt;</span><span class="p">).</span> 
  <span class="nv">carrids</span> <span class="o">=</span> <span class="nv">carrids</span> <span class="o">&amp;&amp;</span> <span class="s1">` `</span> <span class="o">&amp;&amp;</span> <span class="nv">&lt;fs&gt;</span><span class="o">-</span><span class="nv">carrid</span><span class="p">.</span> 
  <span class="k">AT</span> <span class="nv">LAST</span><span class="p">.</span> 
    <span class="nv">cl_demo_output</span><span class="o">=&gt;</span><span class="nf">display</span><span class="p">(</span> <span class="nv">carrids</span> <span class="p">).</span> 
  <span class="k">ENDAT</span><span class="p">.</span> 
<span class="k">ENDLOOP</span><span class="p">.</span> 
</code></pre></div>
</div></p>
<h3 id="exceptions">Exceptions</h3>
<h3 id="non-handleable-exceptions">Non-Handleable Exceptions</h3>
<ul>

<li>
<span class="italic">Cause:</span> Invalid substring access when the group break criterion is specified dynamically. <br><span class="italic">Runtime error:</span> <code style="display: inline;"><span class="qtext">AT_BAD_PARTIAL_FIELD_ACCESS</span></code>
</li>

<li>
<span class="italic">Cause:</span> The group break criterion is specified dynamically using the field symbol and the field symbol does not point to the <code style="display: inline;"><span class="qtext">LOOP</span></code> output range. <br>
<span class="italic">Runtime error:</span> <code style="display: inline;"><span class="qtext">AT_ITAB_FIELD_INVALID</span></code>
</li>

<li>
<span class="italic">Cause:</span> The group break criterion is specified dynamically using <code style="display: inline;"><span class="qtext">(name)</span></code>
and the <code style="display: inline;"><span class="qtext">name</span></code> field does not contain a valid substring name. <br><span class="italic">Runtime error:</span> <code style="display: inline;"><span class="qtext">ITAB_ILLEGAL_COMPONENT</span></code>
</li>

<li>
<span class="italic">Cause:</span> Overflow of totals with <code style="display: inline;"><span class="qtext">SUM</span></code>. <br><span class="italic">Runtime error:</span> <code style="display: inline;"><span class="qtext">SUM_OVERFLOW</span></code> <br>
</li>

</ul>

<h3 id="continue">Continue</h3>
<p><a href="../abapsum" class="blue">SUM</a></p>
<p><a href="../abapendat" class="blue">ENDAT</a></p>
<p><a href="../abenat_itab_abexas" class="blue">Examples of Control Level Processing</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../abapat_extract/" title="AT - Extract" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                AT - Extract
              </div>
            </div>
          </a>
        
        
          <a href="../abapat_itab_obsolete/" title="AT field_symbol" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                AT field_symbol
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.df0def68.min.js"></script>
      <script src="../../assets/javascripts/bundle.ba57d267.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js"></script>
      
        <script src="../../javascript/hljs.js"></script>
      
    
  </body>
</html>