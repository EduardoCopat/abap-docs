


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.9">
    
    
      
        <title>Abenabap daemon - ABAP docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.36ee6aaa.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.83bccb1f.min.css">
      
      
        
        
        <meta name="theme-color" content="#4051b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://raw.githubusercontent.com/highlightjs/highlight.js/master/src/styles/github.css">
    
      <link rel="stylesheet" href="../../css/abap-docs.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#adf-abap-daemon-framework" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="ABAP docs" class="md-header-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            ABAP docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Abenabap daemon
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ABAP docs" class="md-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ABAP docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../7.31/abapdata_options/" title="7.31" class="md-nav__link">
      7.31
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abap-daemon-classes" class="md-nav__link">
    ABAP Daemon Classes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-and-using-abap-daemons" class="md-nav__link">
    Creating and Using ABAP Daemons
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#managing-abap-daemons" class="md-nav__link">
    Managing ABAP Daemons
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abap-daemon-examples" class="md-nav__link">
    ABAP Daemon Examples
  </a>
  
    <nav class="md-nav" aria-label="ABAP Daemon Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executable-examples" class="md-nav__link">
    Executable Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continue" class="md-nav__link">
    Continue
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/eduardocopat/abap-docs/edit/master/docs/7.54/abenabap_daemon.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <p><small>
<a href="../abenabap" class="blue">ABAP Keyword Documentation</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_reference" class="blue">ABAP &#x2212; Reference</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_data_communication" class="blue">Data Interfaces and Communication Interfaces</a>&#xA0;</small></p>
<h1 id="adf-abap-daemon-framework">ADF - ABAP Daemon Framework</h1>
<p>ABAP Daemon Framework (ADF for short) is an application programming interface (or API) used to create and handle
<a href="../abenabap_daemon_glosry" class="grey" title="Glossary Entry">ABAP Daemons</a>. An ABAP Daemon is an instance of an
<a href="../abenabap_daemon_class_glosry" class="grey" title="Glossary Entry">ABAP Daemon class</a> that is persisted in a special
<a href="../abenabap_daemon_session_glosry" class="grey" title="Glossary Entry">ABAP Daemon session</a>. Every AS Instance in an AS ABAP has access to any of the daemons in this AS ABAP. ABAP programs themselves use
<a href="../abenabap_daemon_manager_glosry" class="grey" title="Glossary Entry">ABAP Daemon Manager</a> to access ABAP Daemons.</p>
<p>The only limit on the lifetime of an ABAP Daemon not stopped explicitly using ADF methods is the lifetime of the AS Instance where it is running. An ABAP Daemon is created again automatically every time a
<a href="../abenruntime_error_glosry" class="grey" title="Glossary Entry">runtime error</a> or a
<a href="../abenmessage_glosry" class="grey" title="Glossary Entry">message</a> of type <span class="qtext400">E</span>,
<span class="qtext400">A</span>, or <span class="qtext400">X</span> causes it to terminate a program.
When the AS Instance of a daemon is shut down, the daemon can be moved to another AS Instance by creating
a new daemon containing the same context information as the preceding daemon. This enables the new daemon to do the same job.</p>
<p>The <a href="../abenabap_daemon_processing_glosry" class="grey" title="Glossary Entry">processing of
an ABAP Daemon</a> takes place in the background and is event-driven. Both the consumer of a daemon and the ABAP runtime environment can raise
<a href="../abenabap_daemon_event_glosry" class="grey" title="Glossary Entry">ABAP Daemon events</a>
and the daemon can respond to these events using predefined interface methods. A daemon must always be ready to respond to inbound events and this is ensured by running ABAP Daemon processing in a
<a href="../abenadf_non_blocking_model" class="blue">non-blocking mode</a>.</p>
<ul>

<li><a href="#@@ITOC@@ABENABAP_DAEMON_1" class="blue">ABAP Daemon Classes</a></li>

</ul>

<ul>

<li><a href="#@@ITOC@@ABENABAP_DAEMON_2" class="blue">Creating and Using ABAP Daemons</a></li>

</ul>

<ul>

<li><a href="#@@ITOC@@ABENABAP_DAEMON_3" class="blue">Managing ABAP Daemons</a></li>

</ul>

<ul>

<li><a href="#@@ITOC@@ABENABAP_DAEMON_4" class="blue">ABAP Daemon Examples</a></li>

</ul>

<p>Other versions: 
 <s><i>7.31</i></s> | <s><i>7.40</i></s> | <b>7.54</b></p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>ABAP Daemons can be used as event handlers with long lifetimes, for example to respond to changes in shared internal or external AS ABAP resources.</li>

<p></ul>
<ul></p>
<li>More details about ABAP Daemon Framework can be found under <span class="lnkgrey">ABAP Daemons</span>.</li>

<p></ul>
<a name="@@CL_ABAP_DAEMON_EXT_BASE@@!ABAP_CLASS!@@"></a>
<a name="@@ITOC@@ABENABAP_DAEMON_1"></a>
</div></p>
<h2 id="abap-daemon-classes">ABAP Daemon Classes</h2>
<p>An <a href="../abenabap_daemon_class_glosry" class="grey" title="Glossary Entry">ABAP Daemon class</a>
is a global class that inherits from the abstract system class <span class="lnkgrey">CL_ABAP_DAEMON_EXT_BASE</span>
and it must also be possible to create public instances of this daemon class. From the superclass, an ABAP Daemon class inherits the methods of the interface <span class="lnkgrey">IF_ABAP_DAEMON_EXTENSION</span> that it uses to respond to
<a href="../abenabap_daemon_event_glosry" class="grey" title="Glossary Entry">ABAP Daemon events</a> if they are implemented in the ABAP Daemon class.</p>
<ul>

<li>ON_ACCEPT</li>

</ul>

<dd>
This method is executed before the daemon is actually started. The return value of the method has the
type ABAP_DAEMON_SETUP_MODE from ABAP Dictionary and must be set to a value dictated by the components
of the constant structure CO_SETUP_MODE of the interface <span class="lnkgrey">IF_ABAP_DAEMON_EXTENSION</span>.
The daemon start is accepted or rejected using these values. The method can be implemented to decide
whether the start is accepted or not. For example, user-dependent authorizations can be evaluated and
the start of the daemon can be limited to specific programs. To do this, the object passed in the input
parameter I_CONTEXT_BASE of the static type <span class="lnkgrey">IF_ABAP_DAEMON_CONTEXT_BASE</span>
can be evaluated. Its methods, GET_START_PARAMETER and GET_START_CALLER_INFO, return the required information. They behave in the same way as the identically named methods of a context object.
</dd>

<ul>

<li>ON_START</li>

</ul>

<dd>
This method is executed when a daemon is started using the method START in
<a href="../abenabap_daemon_manager_glosry" class="grey" title="Glossary Entry">ABAP Daemon Managers</a>
and directly after an instance of the daemon is executed. The daemon can be initialized in its implementation in the following ways:
</dd>

<ul class="circlem2">

<li>How context information is saved in <a href="../abenabap_daemon_memory_glosry" class="grey" title="Glossary Entry">ABAP Daemon Memory</a> or to other suitable memory areas, such as
<a href="../abenshared_memory_glosry" class="grey" title="Glossary Entry">shared memory</a> or database tables.</li>

</ul>

<ul class="circlem2">

<li>How <a href="../abenabap_messaging_channel_glosry" class="grey" title="Glossary Entry">ABAP Messaging Channels</a> are bound for communication with consumers.</li>

</ul>

<ul class="circlem2">

<li>Whether an <a href="../abenabap_timer_glosry" class="grey" title="Glossary Entry">ABAP Timer</a> is created to limit the lifetime of the daemon if required.</li>

</ul>

<ul>

<li>ON_MESSAGE</li>

</ul>

<dd>
This method is executed when the daemon receives a
<a href="../abenpcp_glosry" class="grey" title="Glossary Entry">PCP</a> message sent using the method SEND of an
<a href="../abenabap_daemon_handle_glosry" class="grey" title="Glossary Entry">ABAP Daemon handle</a>. To do this, the method ATTACH in
<a href="../abenabap_daemon_manager_glosry" class="grey" title="Glossary Entry">ABAP Daemon Manager</a>
returns a reference to a daemon handle.  The messages in the input parameter I_MESSAGE can be evaluated in the implementation of the method ON_MESSAGE.
</dd>

<ul>

<li>ON_ERROR</li>

</ul>

<dd>
This method is executed after the daemon is restarted automatically due to a
<a href="../abenmessage_glosry" class="grey" title="Glossary Entry">message</a> of the type <span class="qtext400">E</span>, <span class="qtext400">A</span>, or <span class="qtext400">X</span> or because of a
<a href="../abenruntime_error_glosry" class="grey" title="Glossary Entry">runtime error</a>. A runtime error closes the
<a href="../abeninternal_session_glosry" class="grey" title="Glossary Entry">internal session</a> of the daemon, deletes the associated
<a href="../abenabap_memory_glosry" class="grey" title="Glossary Entry">ABAP memory</a>, and produces a
<a href="../abenshort_dump_glosry" class="grey" title="Glossary Entry">short dump</a>. The automatic
restart opens a new internal session. The context of the daemon can be restored in the implementation of the method by accessing context information preserved in the
<a href="../abenabap_daemon_memory_glosry" class="grey" title="Glossary Entry">ABAP Daemon memory</a>
or in another repository, The input parameter I_CODE contains information about the source of the runtime
error. Runtime errors should be avoided in the method ON_ERROR itself If a runtime error does occur here, the execution of the next method is delayed by 30 seconds.
</dd>

<ul>

<li>ON_RESTART</li>

</ul>

<dd>
This method is executed when the daemon is restarted using its context object or after the event ON_BEFORE_RESTART_BY_SYSTEM
(see below). The context of the daemon can be restored in the implementation of the method by accessing context information preserved in the
<a href="../abenabap_daemon_memory_glosry" class="grey" title="Glossary Entry">ABAP Daemon memory</a> or in another repository,
</dd>

<ul>

<li>ON_SERVER_SHUTDOWN</li>

</ul>

<dd>
This method is executed when the current AS Instance is shut down. This method can be implemented so
that the daemon is moved to another free AS Instance (if available) by starting a new daemon here with the same context information. The daemon is stopped automatically after this method is executed.
</dd>

<ul>

<li>ON_SYSTEM_SHUTDOWN</li>

</ul>

<dd>
This method is executed when the current AS ABAP is shut down. This method can be implemented to include
cleanup activities, such as deleting temporary daemon data in persistent repositories. The daemon is stopped automatically after this method is executed.
</dd>

<ul>

<li>ON_BEFORE_RESTART_BY_SYSTEM</li>

</ul>

<dd>
This method is executed when an inconsistent state is detected in the daemon. This can occur when programs
used by a daemon are modified and need to be reloaded. If necessary, this method can be implemented
to perform appropriate tasks, such as updating the saved context information. After this method is executed, a restart is performed automatically and the method ON_RESTART runs.
</dd>

<ul>

<li>ON_STOP</li>

</ul>

<dd>
This method is executed when the daemon is stopped using the method STOP in
<a href="../abenabap_daemon_manager_glosry" class="grey" title="Glossary Entry">ABAP Daemon Manager</a>
or using its context object (see below). This method can be implemented to include cleanup activities, such as deleting temporary daemon data in the relevant memory areas. In the input parameter I_MESSAGE, the method is sent the
<a href="../abenpcp_glosry" class="grey" title="Glossary Entry">PCP</a> message, which can be passed when the daemon is stopped (this is optional).
</dd>

<p>Except for ON_ACCEPT, each of these methods has an input parameter I_CONTEXT with the static type <span class="lnkgrey">
IF_ABAP_DAEMON_CONTEXT</span> that points to a context object. The context object has interface methods that handle context information about the current daemon or that stop or restart it:</p>
<ul>

<li>GET_START_PARAMETER</li>

</ul>

<dd>
This method returns the <a href="../abenpcp_glosry" class="grey" title="Glossary Entry">PCP</a> message that was passed to
<a href="../abenabap_daemon_manager_glosry" class="grey" title="Glossary Entry">ABAP Daemon Manager</a> when the daemon was started.
</dd>

<ul>

<li>GET_START_CALLER_INFO</li>

</ul>

<dd>
This method returns information about the context of the consumer of the daemon, such as the client, user name, or ABAP program in a structure of the type <span class="lnkgrey">ABAP_DAEMON_START_CALLER_INFO</span>.
</dd>

<ul>

<li>GET_INSTANCE_ID</li>

</ul>

<dd>
This method returns the unique internal ID of the current daemon.
</dd>

<ul>

<li>SET_APPLICATION_PARAMETER</li>

</ul>

<dd>
This method writes data to the <a href="../abenabap_daemon_memory_glosry" class="grey" title="Glossary Entry">ABAP Daemon memory</a> in
<a href="../abenpcp_glosry" class="grey" title="Glossary Entry">PCP</a> format. Here, this data is
assigned to the current daemon. Here, they are preserved for the full lifetime of the daemon (including any restarts). If SET_APPLICATION_PARAMETER is repeated, all existing data is overwritten.
</dd>

<ul>

<li>GET_APPLICATION_PARAMETER</li>

</ul>

<dd>
This method reads the latest data written using SET_APPLICATION_PARAMETER from the <a href="../abenabap_daemon_memory_glosry" class="grey" title="Glossary Entry">ABAP Daemon memory</a>.
</dd>

<ul>

<li>RESTART</li>

</ul>

<dd>
This method restarts the current daemon with the same internal ID. This deletes the internal session of the daemon with all associated memories, such as the
<a href="../abenabap_memory_glosry" class="grey" title="Glossary Entry">ABAP memory</a>, and opens a new internal session. The restart raises the event ON_RESTART.
</dd>

<ul>

<li>STOP</li>

</ul>

<dd>
This method stops the current daemon and raises the event ON_STOP at the same time.
</dd>

<p>An ABAP Daemon class can contain further helper methods and can call any number of other procedures in its methods. The implementation of an ABAP Daemon class and the procedures it calls must be executable in
<a href="../abenadf_non_blocking_model" class="blue">non-blocking mode</a> to prevent the runtime error <code style="display: inline;"><span class="qtext">DAEMON_ILLEGAL_STATEMENT</span></code> in
<a href="../abenabap_daemon_processing_glosry" class="grey" title="Glossary Entry">ABAP Daemon processing</a> and a subsequent restart of the daemon.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>To write context information, it is advisable to create a central helper method that is called by the methods ON_START, ON_ERROR, and ON_RESTART. The
<a href="../abenabap_daemon_memory_glosry" class="grey" title="Glossary Entry">ABAP Daemon memory</a>
associated with the daemon is particularly well suited for this task, although other repositories can also be used, such as the shared memory or database tables.</li>

<p></ul>
<ul></p>
<li>The interface <span class="lnkgrey">IF_ABAP_TIMER_HANDLER</span> can be implemented to turn an ABAP Daemon class into an
<a href="../abenabap_timer_handler_glosry" class="grey" title="Glossary Entry">ABAP Timer handler</a> too and hence make it able to respond to
<a href="../abenabap_timer_glosry" class="grey" title="Glossary Entry">ABAP Timer</a> events. This makes it possible, for example, to wait for certain events or to stop the daemon after a defined period of time.</li>

<p></ul>
<a name="@@ITOC@@ABENABAP_DAEMON_2"></a>
</div></p>
<h2 id="creating-and-using-abap-daemons">Creating and Using ABAP Daemons</h2>
<p>ABAP Daemons are created and consumed using the static methods of the class <span class="lnkgrey">CL_ABAP_DAEMON_CLIENT_MANAGER</span> in ABAP Daemon Manager. The following rules apply here:</p>
<ul>

<li>An ABAP Daemon can be created and used from any ABAP program.</li>

</ul>

<ul>

<li>An ABAP Daemon can only be used in the same AS ABAP as the program it was created by and the
<a href="../abenabap_daemon_session_glosry" class="grey" title="Glossary Entry">ABAP Daemon session</a> always has the same
<a href="../abenclient_identifier_glosry" class="grey" title="Glossary Entry">client ID</a> as the current
<a href="../abenuser_session_glosry" class="grey" title="Glossary Entry">user session</a>. No predefined restrictions exist for the user who is using the program in question.</li>

</ul>

<ul>

<li>Only the program that created an ABAP Daemon using ABAP Daemon Manager can use this daemon in ABAP
Daemon Manager. If any other programs attempt this, an exception is raised. It is also not possible
for a daemon to access itself using ABAP Daemon Manager. If multiple programs need to access the same
daemon, it is best to wrap these ABAP Daemon Manager reads in a class whose class pool is the only program that can access this daemon.</li>

</ul>

<p>ABAP Daemon Manager (or the class <span class="lnkgrey">CL_ABAP_DAEMON_CLIENT_MANAGER</span>) has the following methods:</p>
<ul>

<li>START</li>

</ul>

<dd>
This method starts an ABAP Daemon of an ABAP Daemon class passed to the input parameter I_CLASS_NAME
under a name passed to the input parameter I_NAME. This daemon is started only when permitted by the interface method ON_ACCEPT of the ABAP Daemon class. When the daemon is started, a new
<a href="../abenabap_daemon_session_glosry" class="grey" title="Glossary Entry">ABAP Daemon session</a> is opened whose
<a href="../abenclient_identifier_glosry" class="grey" title="Glossary Entry">client ID</a> is adopted by the current user session and whose
<a href="../abenuser_name_glosry" class="grey" title="Glossary Entry">user name</a> and
<a href="../abenlogon_language_glosry" class="grey" title="Glossary Entry">logon language</a> are determined using an
<a href="../abendestination_glosry" class="grey" title="Glossary Entry">RFC destination</a> that can
be passed to the input parameter I_DESTINATION (this is optional). The default value is the predefined
RFC destination <span class="qtext400">NONE</span>. An explicitly specified RFC destination must meet the following prerequisites:
</dd>

<ul class="circlem2">

<li>It must be an internal connection to the same AS ABAP.</li>

</ul>

<ul class="circlem2">

<li>It must be an ABAP connection (with or without load distribution).</li>

</ul>

<ul class="circlem2">

<li>A client ID used in the RFC destination must be the same ID as used in the current user session.</li>

</ul>

<ul class="circlem2">

<li>An AS Instance specified as <span class="qtext400">hostname_sysid_instnr</span> must belong to the current AS ABAP.</li>

</ul>

<dd>
The input parameter I_PRIORITY can be used to specify a priority for the response of the daemon to
<a href="../abenabap_daemon_event_glosry" class="grey" title="Glossary Entry">ABAP Daemon events</a>. The input parameter I_PARAMETER can be used to pass a
<a href="../abenpcp_glosry" class="grey" title="Glossary Entry">PCP</a> message to the daemon as a start parameter and the daemon can access this message using its context object.
</dd>

<dd>
The output parameter E_SETUP_MODE gets the return value of the interface method ON_ACCEPT of the ABAP
Daemon class. The output parameter E_INSTANCE_ID gets the internal ID of the started daemon, which is used by ABAP Daemon Manager to access this daemon.
</dd>

<ul>

<li>ATTACH</li>

</ul>

<dd>
In its return value with the static type <span class="lnkgrey">IF_ABAP_DAEMON_HANDLE</span>, this method returns a reference to an
<a href="../abenabap_daemon_handle_glosry" class="grey" title="Glossary Entry">ABAP Daemon handle</a>
for the daemon whose internal ID was passed to the input parameter I_INSTANCE_ID. The method SEND of the daemon handle can be used by the consumer to send
<a href="../abenpcp_glosry" class="grey" title="Glossary Entry">PCP</a> messages to the daemon and the daemon can handle these messages in its interface method ON_MESSAGE.
</dd>

<ul>

<li>STOP</li>

</ul>

<dd>
This method stops the daemon whose internal ID was passed to the input parameter I_INSTANCE_ID. The
<a href="../abenabap_daemon_event_glosry" class="grey" title="Glossary Entry">ABAP Daemon event</a> ON_STOP is raised first. In the associated method, the daemon can evaluate the
<a href="../abenpcp_glosry" class="grey" title="Glossary Entry">PCP</a> passed to the input parameter I_PARAMETER.
</dd>

<ul>

<li>GET_DAEMON_INFO</li>

</ul>

<dd>
Returns an internal table containing information about all ABAP Daemons in the current AS ABAP for the ABAP Daemon class that is passed to the input parameter I_CLASS_NAME.
</dd>

<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>It is advisable to create dedicated <a href="../abendestination_glosry" class="grey" title="Glossary Entry">RFC destinations</a> for ABAP Daemons with a suitable user:</li>

<p></ul>
<ul class="circlem2"></p>
<li>ABAP Daemons run in the background, which means that dialog users should not be used.</li>

<p></ul>
<ul class="circlem2"></p>
<li>The user in question should have precisely those authorizations required for daemon processing.</li>

<p></ul>
<ul></p>
<li>One consumer can create multiple ABAP Daemons of an ABAP Daemon class, which can then be distinguished
by using different names. It can also be useful, however, to permit just one daemon from an ABAP Daemon class as a singleton in a single AS ABAP. The checks needed here must be provided by the consumer.</li>

<p></ul>
<ul></p>
<li>In most cases, a consumer does not need to know the internal ID of an ABAP Daemon. If the method
calls of the ABAP Daemon handler are wrapped in a class, as recommended, this class can encapsulate them in a private attribute.</li>

<p></ul>
<ul></p>
<li>A consumer can communicate with an ABAP Daemon only by using <a href="../abenpcp_glosry" class="grey" title="Glossary Entry">PCP</a> messages.</li>

<p></ul>
<ul></p>
<li>On its own, the method GET_DAEMON_INFO in ABAP Daemon Manager is not enough to create an ABAP Daemon
as a system-wide singleton. Parallel reads can be used to start multiple daemons in the same ABAP Daemon class before they are returned by GET_DAEMON_INFO.</li>

<p></ul>
<ul></p>
<li>Internally, ABAP Daemons are handled using the
<a href="../abenrfc_interface_glosry" class="grey" title="Glossary Entry">RFC interface</a>. Accordingly, a consumer of daemons must also have the associated
<a href="../abenrfc_authority" class="blue">RFC authorizations</a>.</li>

<p></ul>
<ul></p>
<li>The class pool of an ABAP Daemon (or the instance of an ABAP Daemon class) is always the only
<a href="../abenmain_session_glosry" class="grey" title="Glossary Entry">ABAP session</a> program in its
<a href="../abenabap_daemon_session_glosry" class="grey" title="Glossary Entry">ABAP Daemon session</a>, since no program calls are possible in the associated
<a href="../abenadf_non_blocking_model" class="blue">non-blocking mode</a>.</li>

<p></ul>
<ul></p>
<li>When an ABAP Daemon is stopped or restarted due to an error, its entire context is removed. The associated
<a href="../abenabap_daemon_session_glosry" class="grey" title="Glossary Entry">ABAP Daemon session</a> is also ended and, if the daemon is restarted, a new session is started, This affects any context information in the
<a href="../abenabap_daemon_memory_glosry" class="grey" title="Glossary Entry">ABAP Daemon memory</a>, any
<a href="../abenabap_timer_glosry" class="grey" title="Glossary Entry">ABAP Timers</a> that were started, and all non-persistent data in the associated
<a href="../abenmain_session_glosry" class="grey" title="Glossary Entry">ABAP session</a>. More specifically, any
<a href="../abensap_lock_glosry" class="grey" title="Glossary Entry">SAP locks</a> that were set are released.</li>

<p></ul>
<ul class="circlem2"></p>
<li>It is the task of the consumer to delete any daemon-specific data in the shared memory or other persistent repositories.</li>

<p></ul>
<ul class="circlem2"></p>
<li>In cases where a daemon is moved to a different AS Instance, the consumer must also ensure that the settings in question are transferred at the same time.</li>

<p></ul>
<a name="@@ITOC@@ABENABAP_DAEMON_3"></a>
</div></p>
<h2 id="managing-abap-daemons">Managing ABAP Daemons</h2>
<p>The transaction <span class="lnkgrey">SMDAEMON</span> displays the ABAP Daemons on the current AS Instance and they can also be restarted or stopped here.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Note</p></p>
<p>User-specific <a href="../abenbreakpoint_glosry" class="grey" title="Glossary Entry">breakpoints</a>
can be set when an ABAP Daemon is being processed (namely when the methods of the ABAP Daemon class and the procedures called here are executed) to debug the daemon.</p>
<p><a name="@@ITOC@@ABENABAP_DAEMON_4"></a>
</div></p>
<h2 id="abap-daemon-examples">ABAP Daemon Examples</h2>
<h3 id="executable-examples">Executable Examples</h3>
<ul>

<li><a href="../abenabap_mini_daemon_abexa" class="blue">ADF, Mini ABAP Daemon</a></li>

<p></ul>
<ul></p>
<li><a href="../abenabap_daemon_abexa" class="blue">ADF, Creating and Using an ABAP Daemon</a></li>

</ul>

<p>See also the class <span class="lnkgrey">CL_AD_EXT_SIMPLE_DAEMON</span>, which can be used by the program
<span class="lnkgrey">RS_ABAP_DAEMON_TEST</span>. Unlike in the preceding simple examples, this example is more reliable in producing a system-wide singleton ABAP Daemon.</p>
<h3 id="continue">Continue</h3>
<p><a href="../abenadf_non_blocking_model" class="blue">ADF - Non-Blocking Mode</a></p>
<p><a href="../abenabap_daemon_abexas" class="blue">Examples for ABAP Daemons</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.df0def68.min.js"></script>
      <script src="../../assets/javascripts/bundle.ba57d267.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js"></script>
      
        <script src="../../javascript/hljs.js"></script>
      
    
  </body>
</html>