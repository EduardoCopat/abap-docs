


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.9">
    
    
      
        <title>Abenprogram generation abexa - ABAP docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.36ee6aaa.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.83bccb1f.min.css">
      
      
        
        
        <meta name="theme-color" content="#4051b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://raw.githubusercontent.com/highlightjs/highlight.js/master/src/styles/github.css">
    
      <link rel="stylesheet" href="../../css/abap-docs.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#program-generation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="ABAP docs" class="md-header-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            ABAP docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Abenprogram generation abexa
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ABAP docs" class="md-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ABAP docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../7.31/abapdata_options/" title="7.31" class="md-nav__link">
      7.31
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#source-code" class="md-nav__link">
    Source Code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    Description
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/eduardocopat/abap-docs/edit/master/docs/7.54/abenprogram_generation_abexa.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <p><small>
<a href="../abenabap" class="blue">ABAP Keyword Documentation</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_reference" class="blue">ABAP &#x2212; Reference</a>&#xA0;&#x2192;&#xA0;
<a href="../abenprogram_editing" class="blue">program editing</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_language_dynamic" class="blue">Dynamic Program Editing</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_generic_program" class="blue">ABAP Source Code</a>&#xA0;</small></p>
<h1 id="program-generation">Program Generation</h1>
<p>This example demonstrates how a program is generated using <code style="display: inline;"><span class="qtext">GENERATE SUBROUTINE POOL</span></code>.</p>
<p><a name="@@ITOC@@ABENPROGRAM_GENERATION_ABEXA_1"></a>
Other versions: 
 <s><i>7.31</i></s> | <a href="../../7.40/abenprogram_generation_abexa">7.40</a> | <b>7.54</b></p>
<h2 id="source-code">Source Code</h2>
<p><div class="highlight"><pre><span></span><code><span class="k">REPORT</span> <span class="nv">demo_generic_program</span><span class="p">.</span>

<span class="k">CLASS</span> <span class="nv">display</span> <span class="k">DEFINITION</span> <span class="nv">FINAL</span><span class="p">.</span>
  <span class="k">PUBLIC SECTION</span><span class="p">.</span>
    <span class="k">TYPES</span><span class="p">:</span> <span class="nv">txt_line</span> <span class="k">TYPE </span><span class="nv">c</span> <span class="k">LENGTH</span> <span class="mi">72</span><span class="p">,</span>
           <span class="nv">txt</span>      <span class="k">TYPE STANDARD TABLE OF</span> <span class="nv">txt_line</span>
                    <span class="k">WITH</span> <span class="k">DEFAULT</span> <span class="k">KEY</span><span class="p">.</span>
    <span class="k">CLASS-DATA</span><span class="p">:</span>
      <span class="nv">read_only</span> <span class="k">TYPE </span><span class="nv">abap_bool</span> <span class="k">READ</span><span class="o">-</span><span class="nv">ONLY</span> <span class="k">VALUE</span> <span class="nv">abap_true</span><span class="p">.</span>

    <span class="k">CLASS-METHODS</span><span class="p">:</span>
      <span class="nv">class_constructor</span><span class="p">,</span>
      <span class="nv">main</span><span class="p">,</span>
      <span class="nv">fill_abap_editor</span>   <span class="k">IMPORTING</span> <span class="nv">editor</span> <span class="k">TYPE REF TO</span> <span class="nv">cl_gui_abapedit</span>
                                  <span class="nv">text</span> <span class="k">TYPE  </span><span class="nv">txt</span><span class="p">,</span>
      <span class="nv">read_abap_editor</span>   <span class="k">IMPORTING</span> <span class="nv">editor</span> <span class="k">TYPE REF TO</span> <span class="nv">cl_gui_abapedit</span>
                         <span class="k">EXPORTING</span> <span class="nv">text</span> <span class="k">TYPE </span><span class="nv">txt</span><span class="p">.</span>

  <span class="k">PRIVATE SECTION</span><span class="p">.</span>
    <span class="k">CLASS-METHODS</span><span class="p">:</span>
      <span class="nv">prepare_editors</span><span class="p">,</span>
      <span class="nv">create_abap_editor</span>
        <span class="k">IMPORTING</span> <span class="nv">parent_container</span> <span class="k">TYPE REF TO</span> <span class="nv">cl_gui_custom_container</span>
        <span class="k">RETURNING</span> <span class="k">VALUE</span><span class="p">(</span><span class="nv">editor</span><span class="p">)</span>    <span class="k">TYPE REF TO</span> <span class="nv">cl_gui_abapedit</span><span class="p">.</span>

<span class="k">ENDCLASS</span><span class="p">.</span>

<span class="k">CLASS</span> <span class="k">program</span> <span class="k">DEFINITION</span> <span class="nv">FINAL</span><span class="p">.</span>
  <span class="k">PUBLIC SECTION</span><span class="p">.</span>
    <span class="k">CLASS-METHODS</span><span class="p">:</span>
      <span class="nv">execute</span> <span class="k">IMPORTING</span> <span class="nv">check_only</span> <span class="k">TYPE </span><span class="nv">abap_bool</span> <span class="k">DEFAULT</span> <span class="nv">abap_false</span><span class="p">,</span>
      <span class="nv">build_source</span>          <span class="k">RETURNING</span> <span class="k">VALUE</span><span class="p">(</span><span class="nv">rc</span><span class="p">)</span> <span class="k">TYPE </span><span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span><span class="p">,</span>
      <span class="nv">check_declarations</span>    <span class="k">RETURNING</span> <span class="k">VALUE</span><span class="p">(</span><span class="nv">rc</span><span class="p">)</span> <span class="k">TYPE </span><span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span><span class="p">,</span>
      <span class="nv">check_implementation</span>  <span class="k">RETURNING</span> <span class="k">VALUE</span><span class="p">(</span><span class="nv">rc</span><span class="p">)</span> <span class="k">TYPE </span><span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span><span class="p">,</span>
      <span class="nv">check_syntax</span>          <span class="k">RETURNING</span> <span class="k">VALUE</span><span class="p">(</span><span class="nv">rc</span><span class="p">)</span> <span class="k">TYPE </span><span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span><span class="p">.</span>

  <span class="k">PRIVATE SECTION</span><span class="p">.</span>
    <span class="k">CLASS-DATA</span><span class="p">:</span>
      <span class="k">source TYPE </span><span class="nv">display</span><span class="o">=&gt;</span><span class="nv">txt</span><span class="p">.</span>

<span class="k">ENDCLASS</span><span class="p">.</span>

<span class="k">DATA</span><span class="p">:</span>
  <span class="nv">g_links</span>      <span class="k">TYPE TABLE OF</span> <span class="nv">tline</span><span class="p">,</span>
  <span class="nv">g_ok_code</span>    <span class="k">TYPE </span><span class="nv">sy</span><span class="o">-</span><span class="nv">ucomm</span><span class="p">.</span>

<span class="k">DATA</span><span class="p">:</span>
  <span class="nv">g_editor1</span>    <span class="k">TYPE REF TO</span> <span class="nv">cl_gui_abapedit</span><span class="p">,</span>
  <span class="nv">g_editor2</span>    <span class="k">TYPE REF TO</span> <span class="nv">cl_gui_abapedit</span><span class="p">.</span>

<span class="k">DATA</span><span class="p">:</span>
  <span class="nv">g_declarations</span>      <span class="k">TYPE </span><span class="nv">display</span><span class="o">=&gt;</span><span class="nv">txt</span><span class="p">,</span>
  <span class="nv">g_implementation</span>    <span class="k">TYPE </span><span class="nv">display</span><span class="o">=&gt;</span><span class="nv">txt</span><span class="p">.</span>

<span class="k">START-OF-SELECTION</span><span class="p">.</span>
  <span class="nv">display</span><span class="o">=&gt;</span><span class="nf">main</span><span class="p">(</span> <span class="p">).</span>

<span class="k">CLASS</span> <span class="k">program</span> <span class="k">IMPLEMENTATION</span><span class="p">.</span>
  <span class="k">METHOD</span> <span class="nf">execute</span><span class="p">.</span>
    <span class="k">DATA</span> <span class="k">program</span> <span class="k">TYPE </span><span class="nv">progname</span><span class="p">.</span>
    <span class="k">DATA</span> <span class="k">class</span> <span class="k">TYPE </span><span class="nv">string</span><span class="p">.</span>

    <span class="k">IF</span> <span class="nv">check_declarations</span><span class="p">(</span> <span class="p">)</span>   <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="ow">OR</span>
       <span class="nv">check_implementation</span><span class="p">(</span> <span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">.</span>
      <span class="k">RETURN</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>

    <span class="k">IF</span> <span class="nv">build_source</span><span class="p">(</span> <span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">.</span>
      <span class="k">RETURN</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>

    <span class="k">IF</span> <span class="nv">check_only</span> <span class="o">=</span> <span class="nv">abap_true</span><span class="p">.</span>
      <span class="k">MESSAGE</span> <span class="k">text</span><span class="p">-</span><span class="nv">sok</span> <span class="nv">TYPE</span> <span class="s1">&#39;S&#39;</span><span class="p">.</span>
      <span class="k">RETURN</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>

    <span class="k">DATA</span><span class="p">(</span><span class="nv">source_name</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;SOURCE&#39;</span><span class="p">.</span>
    <span class="k">FIELD-SYMBOLS</span> <span class="nv">&lt;source&gt;</span> <span class="k">TYPE </span><span class="nv">STANDARD</span> <span class="k">TABLE</span><span class="p">.</span>
    <span class="k">ASSIGN</span> <span class="p">(</span><span class="nv">source_name</span><span class="p">)</span> <span class="k">TO</span> <span class="nv">&lt;source&gt;</span><span class="p">.</span>
    <span class="k">TRY</span><span class="p">.</span>
        <span class="nv">GENERATE</span> <span class="nv">SUBROUTINE</span> <span class="nv">POOL</span> <span class="nv">&lt;source&gt;</span> <span class="nv">NAME</span> <span class="k">program</span><span class="p">.</span>
      <span class="k">CATCH</span> <span class="nv">cx_sy_generate_subpool_full</span><span class="p">.</span>
        <span class="k">MESSAGE</span> <span class="k">text</span><span class="p">-</span><span class="nv">srf</span> <span class="nv">TYPE</span> <span class="s1">&#39;I&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;E&#39;</span><span class="p">.</span>
        <span class="k">RETURN</span><span class="p">.</span>
    <span class="k">ENDTRY</span><span class="p">.</span>

    <span class="k">class</span> <span class="o">=</span> <span class="s1">`\PROGRAM=`</span> <span class="o">&amp;&amp;</span> <span class="k">program</span> <span class="o">&amp;&amp;</span> <span class="s1">`\CLASS=DEMO`</span><span class="p">.</span>
    <span class="k">TRY</span><span class="p">.</span>
        <span class="k">CALL METHOD</span> <span class="p">(</span><span class="nv">class</span><span class="p">)</span><span class="o">=&gt;</span><span class="nv">main</span><span class="p">.</span>
      <span class="k">CATCH</span> <span class="nv">cx_root</span> <span class="k">INTO</span> <span class="k">DATA</span><span class="p">(</span><span class="nv">exc</span><span class="p">)</span> <span class="cs">##CATCH_ALL</span><span class="p">.</span>
        <span class="k">MESSAGE</span> <span class="nv">exc</span><span class="o">-&gt;</span><span class="nf">get_text</span><span class="p">(</span> <span class="p">)</span> <span class="nv">TYPE</span> <span class="s1">&#39;I&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;E&#39;</span><span class="p">.</span>
    <span class="k">ENDTRY</span><span class="p">.</span>

  <span class="k">ENDMETHOD</span><span class="p">.</span>

  <span class="k">METHOD</span> <span class="nf">build_source</span><span class="p">.</span>
    <span class="k">DATA</span> <span class="nv">idx</span> <span class="k">TYPE </span><span class="nv">sy</span><span class="o">-</span><span class="nv">tabix</span><span class="p">.</span>
    <span class="k">DATA</span> <span class="nv">subrc</span> <span class="k">TYPE </span><span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span><span class="p">.</span>

    <span class="k">TRY</span><span class="p">.</span>
        <span class="k">READ</span> <span class="k">REPORT</span> <span class="s1">&#39;DEMO_GENERIC_TEMPLATE&#39;</span> <span class="k">INTO</span> <span class="nv">source</span><span class="p">.</span>
        <span class="nv">subrc</span> <span class="o">=</span> <span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span><span class="p">.</span>
      <span class="k">CATCH</span> <span class="nv">cx_sy_read_src_line_too_long</span><span class="p">.</span>
        <span class="nv">subrc</span> <span class="o">=</span> <span class="mi">4</span><span class="p">.</span>
    <span class="k">ENDTRY</span><span class="p">.</span>

    <span class="k">IF</span> <span class="nv">subrc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span>
      <span class="nv">FIND</span> <span class="s1">&#39;* declarations&#39;</span> <span class="k">IN</span> <span class="k">TABLE</span> <span class="k">source MATCH LINE</span> <span class="nv">idx</span><span class="p">.</span>
      <span class="nv">subrc</span> <span class="o">=</span> <span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span><span class="p">.</span>
      <span class="k">DELETE</span> <span class="k">source INDEX</span> <span class="nv">idx</span><span class="p">.</span>
      <span class="k">INSERT LINES OF</span> <span class="nv">g_declarations</span> <span class="k">INTO</span> <span class="k">source INDEX</span> <span class="nv">idx</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>

    <span class="k">IF</span> <span class="nv">subrc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span>
      <span class="nv">FIND</span> <span class="s1">&#39;* implementation&#39;</span> <span class="k">IN</span> <span class="k">TABLE</span> <span class="k">source MATCH LINE</span> <span class="nv">idx</span><span class="p">.</span>
      <span class="nv">subrc</span> <span class="o">=</span> <span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span><span class="p">.</span>
      <span class="k">DELETE</span> <span class="k">source INDEX</span> <span class="nv">idx</span><span class="p">.</span>
      <span class="k">INSERT LINES OF</span> <span class="nv">g_implementation</span> <span class="k">INTO</span> <span class="k">source INDEX</span> <span class="nv">idx</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>

    <span class="k">IF</span> <span class="nv">subrc</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">.</span>
      <span class="k">MESSAGE</span> <span class="k">text</span><span class="p">-</span><span class="nv">wtl</span> <span class="nv">TYPE</span> <span class="s1">&#39;I&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;E&#39;</span><span class="p">.</span>
      <span class="k">LEAVE</span> <span class="k">PROGRAM</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>

    <span class="nv">rc</span> <span class="o">=</span> <span class="nv">check_syntax</span><span class="p">(</span> <span class="p">).</span>

  <span class="k">ENDMETHOD</span><span class="p">.</span>

  <span class="k">METHOD</span> <span class="nf">check_declarations</span><span class="p">.</span>
    <span class="k">DATA</span><span class="p">:</span> <span class="nv">code</span> <span class="k">LIKE </span><span class="nv">source</span><span class="p">,</span>
          <span class="nv">mess</span> <span class="k">TYPE </span><span class="nv">string</span><span class="p">,</span>
          <span class="nv">lin</span>  <span class="k">TYPE </span><span class="nv">i</span> <span class="cs">##needed</span><span class="p">,</span>
          <span class="nv">wrd</span>  <span class="k">TYPE </span><span class="nv">string</span> <span class="cs">##needed</span><span class="p">,</span>
          <span class="nv">warnings</span> <span class="k">TYPE  STANDARD TABLE OF</span> <span class="nv">rslinlmsg</span><span class="p">.</span>

    <span class="c1">&quot;Normal syntax check to get typos</span>
    <span class="nv">code</span> <span class="o">=</span> <span class="k">VALUE</span> <span class="err">#</span><span class="p">(</span> <span class="p">(</span> <span class="s1">&#39;PROGRAM.&#39;</span> <span class="p">)</span> <span class="p">).</span>
    <span class="k">APPEND LINES OF</span> <span class="nv">g_declarations</span> <span class="k">TO</span> <span class="nv">code</span><span class="p">.</span>
    <span class="k">SYNTAX-CHECK</span> <span class="k">FOR</span> <span class="nv">code</span> <span class="k">MESSAGE</span> <span class="nv">mess</span> <span class="nv">LINE</span> <span class="nv">lin</span> <span class="nv">WORD</span> <span class="nv">wrd</span>
                     <span class="k">ID</span> <span class="s1">&#39;MSG&#39;</span> <span class="k">TABLE</span> <span class="nv">warnings</span>
                     <span class="k">PROGRAM</span> <span class="nv">sy</span><span class="o">-</span><span class="nv">repid</span><span class="p">.</span>
    <span class="nv">rc</span> <span class="o">=</span> <span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span><span class="p">.</span>
    <span class="k">IF</span> <span class="nv">rc</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">.</span>
      <span class="k">MESSAGE</span> <span class="nv">mess</span> <span class="nv">TYPE</span> <span class="s1">&#39;I&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;E&#39;</span><span class="p">.</span>
      <span class="k">RETURN</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>
    <span class="k">IF</span> <span class="nv">warnings</span> <span class="ow">IS NOT INITIAL</span><span class="p">.</span>
      <span class="k">DATA</span><span class="p">(</span><span class="nv">warning</span><span class="p">)</span> <span class="o">=</span> <span class="nv">warnings</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span>
      <span class="k">MESSAGE</span> <span class="nv">warning</span><span class="o">-</span><span class="nv">message</span> <span class="nv">TYPE</span> <span class="s1">&#39;I&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;W&#39;</span><span class="p">.</span>
      <span class="k">RETURN</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>

    <span class="c1">&quot;Restrict to declarative statements</span>
    <span class="nv">code</span> <span class="o">=</span> <span class="k">VALUE</span> <span class="err">#</span><span class="p">(</span> <span class="p">(</span> <span class="s1">&#39;PROGRAM.&#39;</span> <span class="p">)</span>
                    <span class="p">(</span> <span class="s1">&#39;CLASS class DEFINITION.&#39;</span> <span class="p">)</span>
                    <span class="p">(</span> <span class="s1">&#39;PUBLIC SECTION.&#39;</span> <span class="p">)</span>
                    <span class="p">(</span> <span class="s1">&#39;ENDCLASS.&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="cs">##no_text</span><span class="p">.</span>
    <span class="k">INSERT LINES OF</span> <span class="nv">g_declarations</span> <span class="k">INTO</span> <span class="nv">code</span> <span class="k">INDEX</span> <span class="k">lines</span><span class="p">(</span> <span class="nv">code</span> <span class="p">).</span>
    <span class="k">SYNTAX-CHECK</span> <span class="k">FOR</span> <span class="nv">code</span> <span class="k">MESSAGE</span> <span class="nv">mess</span> <span class="nv">LINE</span> <span class="nv">lin</span> <span class="nv">WORD</span> <span class="nv">wrd</span>
                     <span class="k">ID</span> <span class="s1">&#39;MSG&#39;</span> <span class="k">TABLE</span> <span class="nv">warnings</span>
                     <span class="k">PROGRAM</span> <span class="s1">&#39;DEMO_GENERIC_TEMPLATE&#39;</span><span class="p">.</span>
    <span class="nv">rc</span> <span class="o">=</span> <span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span><span class="p">.</span>
    <span class="k">IF</span> <span class="nv">rc</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">.</span>
      <span class="k">MESSAGE</span> <span class="k">text</span><span class="p">-</span><span class="nv">dcl</span> <span class="nv">TYPE</span> <span class="s1">&#39;S&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;E&#39;</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>
    <span class="k">IF</span> <span class="nv">warnings</span> <span class="ow">IS NOT INITIAL</span><span class="p">.</span>
      <span class="nv">warning</span> <span class="o">=</span> <span class="nv">warnings</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span>
      <span class="k">MESSAGE</span> <span class="nv">warning</span><span class="o">-</span><span class="nv">message</span> <span class="nv">TYPE</span> <span class="s1">&#39;I&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;W&#39;</span><span class="p">.</span>
      <span class="k">RETURN</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>
  <span class="k">ENDMETHOD</span><span class="p">.</span>

  <span class="k">METHOD</span> <span class="nf">check_implementation</span><span class="p">.</span>
    <span class="c1">&quot;Only a very limited set of statements is allowed</span>
    <span class="k">DATA</span> <span class="nv">black_list</span> <span class="k">TYPE </span><span class="nv">cl_demo_secure_abap_code</span><span class="o">=&gt;</span><span class="nv">string_table</span><span class="p">.</span>
    <span class="k">DATA</span> <span class="nv">white_list</span> <span class="k">TYPE </span><span class="nv">cl_demo_secure_abap_code</span><span class="o">=&gt;</span><span class="nv">string_table</span><span class="p">.</span>

    <span class="c1">&quot;Blacklist</span>
    <span class="nv">black_list</span> <span class="o">=</span> <span class="k">VALUE</span> <span class="err">#</span><span class="p">(</span>
      <span class="p">(</span> <span class="s1">`-&gt;`</span> <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`=&gt;`</span> <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`DATA(`</span> <span class="p">)</span> <span class="p">).</span>

    <span class="c1">&quot;Whitelist</span>
    <span class="nv">white_list</span> <span class="o">=</span> <span class="k">VALUE</span> <span class="err">#</span><span class="p">(</span>
      <span class="p">(</span> <span class="s1">`FIELD-SYMBOLS`</span>        <span class="p">)</span>

      <span class="p">(</span> <span class="s1">`CHECK`</span>                <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`EXIT`</span>                 <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`RETURN`</span>               <span class="p">)</span>

      <span class="p">(</span> <span class="s1">`DO`</span>                   <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`ENDDO`</span>                <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`WHILE`</span>                <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`ENDWHILE`</span>             <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`CASE`</span>                 <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`WHEN`</span>                 <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`ENDCASE`</span>              <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`IF`</span>                   <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`ELSEIF`</span>               <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`ELSE`</span>                 <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`ENDIF`</span>                <span class="p">)</span>

      <span class="p">(</span> <span class="s1">`MOVE-CORRESPONDING`</span>   <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`ASSIGN`</span>               <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`UNASSIGN`</span>             <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`CLEAR`</span>                <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`FREE`</span>                 <span class="p">)</span>

      <span class="p">(</span> <span class="s1">`FIND`</span>                 <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`REPLACE`</span>              <span class="p">)</span>

      <span class="p">(</span> <span class="s1">`APPEND`</span>               <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`INSERT`</span>               <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`MODIFY`</span>               <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`DELETE`</span>               <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`COLLECT`</span>              <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`READ`</span>                 <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`LOOP`</span>                 <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`ENDLOOP`</span>              <span class="p">)</span>
      <span class="p">(</span> <span class="s1">`SORT`</span>                 <span class="p">)</span> <span class="p">).</span>

    <span class="nv">rc</span> <span class="o">=</span> <span class="nv">cl_demo_secure_abap_code</span><span class="o">=&gt;</span><span class="nf">check</span><span class="p">(</span>
      <span class="nv">source_code</span>  <span class="o">=</span> <span class="nv">g_implementation</span>
      <span class="nv">black_list</span>   <span class="o">=</span> <span class="nv">black_list</span>
      <span class="nv">white_list</span>   <span class="o">=</span> <span class="nv">white_list</span>
      <span class="nv">declarations</span> <span class="o">=</span> <span class="nv">g_declarations</span> <span class="p">).</span>
    <span class="k">IF</span> <span class="nv">rc</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">.</span>
      <span class="k">MESSAGE</span> <span class="k">text</span><span class="p">-</span><span class="nv">exe</span> <span class="nv">TYPE</span> <span class="s1">&#39;S&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;E&#39;</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>

  <span class="k">ENDMETHOD</span><span class="p">.</span>

  <span class="k">METHOD</span> <span class="nf">check_syntax</span><span class="p">.</span>
    <span class="k">DATA</span><span class="p">:</span> <span class="nv">mess</span> <span class="k">TYPE </span><span class="nv">string</span><span class="p">,</span>
          <span class="nv">lin</span>  <span class="k">TYPE </span><span class="nv">i</span> <span class="cs">##needed</span><span class="p">,</span>
          <span class="nv">wrd</span>  <span class="k">TYPE </span><span class="nv">string</span> <span class="cs">##needed</span><span class="p">,</span>
          <span class="nv">warnings</span> <span class="k">TYPE  STANDARD TABLE OF</span> <span class="nv">rslinlmsg</span><span class="p">.</span>
    <span class="c1">&quot;Syntax check for implementations with declarations</span>
    <span class="k">SYNTAX-CHECK</span> <span class="k">FOR</span> <span class="k">source MESSAGE</span> <span class="nv">mess</span> <span class="nv">LINE</span> <span class="nv">lin</span> <span class="nv">WORD</span> <span class="nv">wrd</span>
                     <span class="k">ID</span> <span class="s1">&#39;MSG&#39;</span> <span class="k">TABLE</span> <span class="nv">warnings</span>
                     <span class="k">PROGRAM</span> <span class="s1">&#39;DEMO_GENERIC_TEMPLATE&#39;</span><span class="p">.</span>
    <span class="nv">rc</span> <span class="o">=</span> <span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span><span class="p">.</span>
    <span class="k">IF</span> <span class="nv">rc</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">.</span>
      <span class="k">MESSAGE</span> <span class="nv">mess</span> <span class="nv">TYPE</span> <span class="s1">&#39;I&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;E&#39;</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>
    <span class="k">IF</span> <span class="nv">warnings</span> <span class="ow">IS NOT INITIAL</span><span class="p">.</span>
      <span class="k">DATA</span><span class="p">(</span><span class="nv">warning</span><span class="p">)</span> <span class="o">=</span> <span class="nv">warnings</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span>
      <span class="k">MESSAGE</span> <span class="nv">warning</span><span class="o">-</span><span class="nv">message</span> <span class="nv">TYPE</span> <span class="s1">&#39;I&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;W&#39;</span><span class="p">.</span>
      <span class="k">RETURN</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>
  <span class="k">ENDMETHOD</span><span class="p">.</span>
<span class="k">ENDCLASS</span><span class="p">.</span>

<span class="k">CLASS</span> <span class="nv">display</span> <span class="k">IMPLEMENTATION</span><span class="p">.</span>
  <span class="k">METHOD</span> <span class="nf">class_constructor</span><span class="p">.</span>
    <span class="c1">&quot;Security checks</span>

    <span class="c1">&quot;Not allowed in production systems</span>
    <span class="k">IF</span> <span class="nv">cl_abap_demo_services</span><span class="o">=&gt;</span><span class="nf">is_production_system</span><span class="p">(</span> <span class="p">).</span>
      <span class="k">MESSAGE</span> <span class="k">text</span><span class="p">-</span><span class="nv">prs</span> <span class="nv">TYPE</span> <span class="s1">&#39;S&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;W&#39;</span><span class="p">.</span>
      <span class="k">RETURN</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>

    <span class="c1">&quot;Only users who are allowed to use the ABAP Editor</span>
    <span class="k">CALL FUNCTION</span> <span class="s1">&#39;AUTHORITY_CHECK_TCODE&#39;</span>
      <span class="k">EXPORTING</span>
        <span class="nv">tcode</span>  <span class="o">=</span> <span class="s1">&#39;SE38&#39;</span>
      <span class="k">EXCEPTIONS</span>
        <span class="nv">ok</span>     <span class="o">=</span> <span class="mi">1</span>
        <span class="nv">not_ok</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">OTHERS</span> <span class="o">=</span> <span class="mi">3</span><span class="p">.</span>

    <span class="c1">&quot;Only users who are allowed to create and run $TMP programs</span>
    <span class="k">IF</span> <span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">.</span>
      <span class="k">AUTHORITY-CHECK</span> <span class="k">OBJECT</span> <span class="s1">&#39;S_DEVELOP&#39;</span>
        <span class="k">ID</span> <span class="s1">&#39;DEVCLASS&#39;</span> <span class="k">FIELD</span> <span class="s1">&#39;$TMP&#39;</span>
        <span class="k">ID</span> <span class="s1">&#39;OBJTYPE&#39;</span>  <span class="k">FIELD</span> <span class="s1">&#39;PROG&#39;</span>
        <span class="k">ID</span> <span class="s1">&#39;OBJNAME&#39;</span>  <span class="k">DUMMY</span>
        <span class="k">ID</span> <span class="s1">&#39;P_GROUP&#39;</span>  <span class="k">DUMMY</span>
        <span class="k">ID</span> <span class="s1">&#39;ACTVT&#39;</span>    <span class="k">FIELD</span> <span class="s1">&#39;02&#39;</span><span class="p">.</span>
      <span class="k">IF</span> <span class="nv">sy</span><span class="o">-</span><span class="nv">subrc</span> <span class="o">=</span>  <span class="mi">0</span><span class="p">.</span>
        <span class="nv">read_only</span> <span class="o">=</span> <span class="nv">abap_false</span><span class="p">.</span>
        <span class="k">RETURN</span><span class="p">.</span>
      <span class="k">ENDIF</span><span class="p">.</span>
    <span class="k">ENDIF</span><span class="p">.</span>

    <span class="k">MESSAGE</span> <span class="k">text</span><span class="p">-</span><span class="nv">aut</span> <span class="nv">TYPE</span> <span class="s1">&#39;S&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;E&#39;</span><span class="p">.</span>

  <span class="k">ENDMETHOD</span><span class="p">.</span>

  <span class="k">METHOD</span> <span class="nf">main</span><span class="p">.</span>

    <span class="nv">prepare_editors</span><span class="p">(</span> <span class="p">).</span>
    <span class="k">CALL SCREEN</span> <span class="mi">100</span><span class="p">.</span>

  <span class="k">ENDMETHOD</span><span class="p">.</span>

  <span class="k">METHOD</span> <span class="nf">prepare_editors</span><span class="p">.</span>
    <span class="k">DATA</span><span class="p">:</span>
      <span class="nv">container1</span> <span class="k">TYPE REF TO</span> <span class="nv">cl_gui_custom_container</span><span class="p">,</span>
      <span class="nv">container2</span> <span class="k">TYPE REF TO</span> <span class="nv">cl_gui_custom_container</span><span class="p">.</span>

    <span class="nv">g_declarations</span> <span class="o">=</span> <span class="k">VALUE</span> <span class="err">#</span><span class="p">(</span>
      <span class="p">(</span> <span class="s1">&#39;DATA text TYPE string VALUE `Hello, I&#39;&#39;m generic!`.&#39;</span> <span class="p">)</span> <span class="p">)</span>
      <span class="cs">##no_text</span><span class="p">.</span>
    <span class="nv">g_implementation</span> <span class="o">=</span> <span class="k">VALUE</span> <span class="err">#</span><span class="p">(</span>
      <span class="p">(</span> <span class="s1">&#39;cl_demo_output&#39;</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;=&gt;display_text( text ).&#39;</span> <span class="p">)</span> <span class="p">)</span>
      <span class="cs">##no_text</span><span class="p">.</span>

    <span class="k">CREATE OBJECT</span> <span class="nv">container1</span>
      <span class="k">EXPORTING</span>
        <span class="nv">container_name</span> <span class="o">=</span> <span class="s1">&#39;CUSTOM_CONTAINER1&#39;</span><span class="p">.</span>
    <span class="nv">g_editor1</span> <span class="o">=</span> <span class="nv">display</span><span class="o">=&gt;</span><span class="nf">create_abap_editor</span><span class="p">(</span> <span class="nv">container1</span> <span class="p">).</span>
    <span class="k">CREATE OBJECT</span> <span class="nv">container2</span>
      <span class="k">EXPORTING</span>
        <span class="nv">container_name</span> <span class="o">=</span> <span class="s1">&#39;CUSTOM_CONTAINER2&#39;</span><span class="p">.</span>
    <span class="nv">g_editor2</span> <span class="o">=</span> <span class="nv">display</span><span class="o">=&gt;</span><span class="nf">create_abap_editor</span><span class="p">(</span> <span class="nv">container2</span> <span class="p">).</span>
  <span class="k">ENDMETHOD</span><span class="p">.</span>

  <span class="k">METHOD</span> <span class="nf">create_abap_editor</span><span class="p">.</span>
    <span class="k">CREATE OBJECT</span> <span class="nv">editor</span>
      <span class="k">EXPORTING</span>
        <span class="nv">parent</span> <span class="o">=</span> <span class="nv">parent_container</span><span class="p">.</span>
    <span class="nv">editor</span><span class="o">-&gt;</span><span class="nf">set_toolbar_mode</span><span class="p">(</span> <span class="mi">0</span> <span class="p">).</span>
    <span class="nv">editor</span><span class="o">-&gt;</span><span class="nf">set_statusbar_mode</span><span class="p">(</span> <span class="mi">0</span> <span class="p">).</span>
    <span class="k">IF</span> <span class="nv">read_only</span> <span class="o">=</span> <span class="nv">abap_true</span><span class="p">.</span>
      <span class="nv">editor</span><span class="o">-&gt;</span><span class="nf">set_readonly_mode</span><span class="p">(</span> <span class="mi">1</span> <span class="p">).</span>
    <span class="k">ELSE</span><span class="p">.</span>
      <span class="nv">editor</span><span class="o">-&gt;</span><span class="nf">set_readonly_mode</span><span class="p">(</span> <span class="mi">0</span> <span class="p">).</span>
    <span class="k">ENDIF</span><span class="p">.</span>
  <span class="k">ENDMETHOD</span><span class="p">.</span>

  <span class="k">METHOD</span> <span class="nf">fill_abap_editor</span><span class="p">.</span>
    <span class="nv">editor</span><span class="o">-&gt;</span><span class="nf">set_text</span><span class="p">(</span> <span class="nv">text</span> <span class="p">).</span>
  <span class="k">ENDMETHOD</span><span class="p">.</span>

  <span class="k">METHOD</span> <span class="nf">read_abap_editor</span><span class="p">.</span>
    <span class="nv">editor</span><span class="o">-&gt;</span><span class="nf">get_text</span><span class="p">(</span> <span class="k">IMPORTING</span> <span class="k">table</span> <span class="o">=</span> <span class="nv">text</span> <span class="p">).</span>
  <span class="k">ENDMETHOD</span><span class="p">.</span>

<span class="k">ENDCLASS</span><span class="p">.</span>

<span class="k">MODULE</span> <span class="nf">status_0100</span> <span class="k">OUTPUT</span><span class="p">.</span>
  <span class="k">SET PF-STATUS</span> <span class="s1">&#39;STATUS_100&#39;</span><span class="p">.</span>
  <span class="k">SET TITLEBAR</span>  <span class="s1">&#39;TITLE_100&#39;</span><span class="p">.</span>
  <span class="nv">display</span><span class="o">=&gt;</span><span class="nf">fill_abap_editor</span><span class="p">(</span> <span class="nv">editor</span> <span class="o">=</span> <span class="nv">g_editor1</span>
                             <span class="nv">text</span>   <span class="o">=</span> <span class="nv">g_declarations</span> <span class="p">).</span>
  <span class="nv">display</span><span class="o">=&gt;</span><span class="nf">fill_abap_editor</span><span class="p">(</span> <span class="nv">editor</span> <span class="o">=</span> <span class="nv">g_editor2</span>
                             <span class="nv">text</span>   <span class="o">=</span> <span class="nv">g_implementation</span> <span class="p">).</span>
<span class="k">ENDMODULE</span><span class="p">.</span>

<span class="k">MODULE</span> <span class="nf">cancel_0100</span> <span class="k">INPUT</span><span class="p">.</span>
  <span class="k">LEAVE</span> <span class="k">PROGRAM</span><span class="p">.</span>
<span class="k">ENDMODULE</span><span class="p">.</span>

<span class="k">MODULE</span> <span class="nv">user_command_0100</span><span class="p">.</span>
  <span class="k">IF</span> <span class="nv">g_ok_code</span> <span class="o">=</span> <span class="s1">&#39;INFO&#39;</span><span class="p">.</span>
    <span class="k">CALL FUNCTION</span> <span class="s1">&#39;HELP_OBJECT_SHOW&#39;</span>
      <span class="k">EXPORTING</span>
        <span class="nv">dokclass</span> <span class="o">=</span> <span class="s1">&#39;RE&#39;</span>
        <span class="nv">doklangu</span> <span class="o">=</span> <span class="nv">sy</span><span class="o">-</span><span class="nv">langu</span>
        <span class="nv">dokname</span>  <span class="o">=</span> <span class="s1">&#39;DEMO_GENERIC_PROGRAM&#39;</span>
      <span class="k">TABLES</span>
        <span class="nv">links</span>    <span class="o">=</span> <span class="nv">g_links</span><span class="p">.</span>
    <span class="k">CLEAR</span> <span class="nv">g_ok_code</span><span class="p">.</span>
    <span class="k">RETURN</span><span class="p">.</span>
  <span class="k">ENDIF</span><span class="p">.</span>
  <span class="k">IF</span> <span class="nv">display</span><span class="o">=&gt;</span><span class="nv">read_only</span> <span class="o">=</span> <span class="nv">abap_true</span><span class="p">.</span>
    <span class="k">MESSAGE</span> <span class="k">text</span><span class="p">-</span><span class="nv">aut</span> <span class="nv">TYPE</span> <span class="s1">&#39;S&#39;</span> <span class="nv">DISPLAY</span> <span class="nv">LIKE</span> <span class="s1">&#39;E&#39;</span><span class="p">.</span>
    <span class="k">CLEAR</span> <span class="nv">g_ok_code</span><span class="p">.</span>
    <span class="k">RETURN</span><span class="p">.</span>
  <span class="k">ENDIF</span><span class="p">.</span>
  <span class="nv">display</span><span class="o">=&gt;</span><span class="nf">read_abap_editor</span><span class="p">(</span> <span class="k">EXPORTING</span> <span class="nv">editor</span> <span class="o">=</span> <span class="nv">g_editor1</span>
                             <span class="k">IMPORTING</span> <span class="nv">text</span>   <span class="o">=</span> <span class="nv">g_declarations</span> <span class="p">).</span>
  <span class="nv">display</span><span class="o">=&gt;</span><span class="nf">read_abap_editor</span><span class="p">(</span> <span class="k">EXPORTING</span> <span class="nv">editor</span> <span class="o">=</span> <span class="nv">g_editor2</span>
                            <span class="k">IMPORTING</span> <span class="nv">text</span>   <span class="o">=</span> <span class="nv">g_implementation</span> <span class="p">).</span>
  <span class="k">CASE</span> <span class="nv">g_ok_code</span><span class="p">.</span>
    <span class="k">WHEN</span> <span class="s1">&#39;EXECUTE&#39;</span><span class="p">.</span>
      <span class="k">program</span><span class="o">=&gt;</span><span class="nf">execute</span><span class="p">(</span> <span class="p">).</span>
    <span class="k">WHEN</span> <span class="s1">&#39;CHECK&#39;</span><span class="p">.</span>
      <span class="k">program</span><span class="o">=&gt;</span><span class="nf">execute</span><span class="p">(</span> <span class="nv">check_only</span> <span class="o">=</span> <span class="nv">abap_true</span> <span class="p">).</span>
    <span class="k">WHEN</span> <span class="s1">&#39;CLEAR&#39;</span><span class="p">.</span>
      <span class="k">CLEAR</span><span class="p">:</span> <span class="nv">g_declarations</span><span class="p">,</span>
             <span class="nv">g_implementation</span><span class="p">.</span>
  <span class="k">ENDCASE</span><span class="p">.</span>
  <span class="k">CLEAR</span> <span class="nv">g_ok_code</span><span class="p">.</span>
<span class="k">ENDMODULE</span><span class="p">.</span>
</code></pre></div>
<a name="@@ITOC@@ABENPROGRAM_GENERATION_ABEXA_2"></a></p>
<h2 id="description">Description</h2>
<p>The program permits declaration statements to be entered in a declaration part and operational statements
to be entered in an implementation part. These entries are inserted consecutively into a method of a
pattern program, which is imported into an internal table using the statement <a href="../abapread_report" class="blue">
<code style="display: inline;"><span class="qtext">READ REPORT</span></code></a>. When <span class="italic">Execute</span> is selected, the
program is generated using <a href="../abapgenerate_subroutine_pool" class="blue"><span class="qtext">GENERATE
SUBROUTINE POOL</span></a> and the method is called. Before this happens, the syntax is checked using <a href="../abapsyntax-check_for_itab" class="blue"> <code style="display: inline;"><span class="qtext">SYNTAX-CHECK</span></code></a>.</p>
<p>The ability to enter source code for a generic program presents the greatest potential security risk. The following measures have been taken to avoid abuse of this program:</p>
<ul>

<li>The static constructor of the class <code style="display: inline;"><span class="qtext">display</span></code> checks whether the program
is executed in a production system (a system with production clients). Source code cannot be entered in these systems and no function codes are accepted apart from the display of documentation.</li>

</ul>

<ul>

<li>The static constructor of the class <code style="display: inline;"><span class="qtext">display</span></code> checks whether the current
user has authorization for ABAP Editor in the current system and development authorization for modifying
and executing temporary programs. Only these users can enter source code and execute programs, since all actions possible here are also possible in the development environment.</li>

</ul>

<ul>

<li>Since developers in particular are tempted to test the vulnerability of their test programs, the available statements are restricted as follows:</li>

</ul>

<ul class="circlem2">

<li>Only declarative statements can be entered in the declaration part. This is checked using the same
syntax check as for the declaration part of a class. This check is made in the method <code style="display: inline;"><span class="qtext">check_declarations</span></code> of the class <code style="display: inline;"><span class="qtext">program</span></code>.</li>

</ul>

<ul class="circlem2">

<li>Only those statements entered in a white list are valid in the implementation part. A black list
prevents the use of other classes or objects (except for the output class <span class="lnkgrey">CL_DEMO_OUTPUT</span>).
This check is made in the method <code style="display: inline;"><span class="qtext">check_implementation</span></code> of the class <span class="qtext">
program</span>, with the method CHECK of the class CL_DEMO_SECURE_ABAP_CODE being called. If the statements
<code style="display: inline;"><span class="qtext">INSERT</span></code>, <code style="display: inline;"><span class="qtext">MODIFY</span></code>, or <code style="display: inline;"><span class="qtext">DELETE</span></code>
are used, the addressed table must be declared in the declaration part. This prevents writes from being performed on database tables.</li>

</ul>

<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Note</p></p>
<p>If, despite these measures, it is still possible to generate and execute potentially dangerous code
with this program without manipulating the program flow or the program data in the debugger, inform the component BC-ABA-LA immediately.</p>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.df0def68.min.js"></script>
      <script src="../../assets/javascripts/bundle.ba57d267.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js"></script>
      
        <script src="../../javascript/hljs.js"></script>
      
    
  </body>
</html>