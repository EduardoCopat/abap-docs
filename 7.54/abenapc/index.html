


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.9">
    
    
      
        <title>Abenapc - ABAP docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.36ee6aaa.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.83bccb1f.min.css">
      
      
        
        
        <meta name="theme-color" content="#4051b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://raw.githubusercontent.com/highlightjs/highlight.js/master/src/styles/github.css">
    
      <link rel="stylesheet" href="../../css/abap-docs.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#apc-abap-push-channels" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="ABAP docs" class="md-header-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            ABAP docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Abenapc
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ABAP docs" class="md-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ABAP docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../7.31/abapdata_options/" title="7.31" class="md-nav__link">
      7.31
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#apc-overview" class="md-nav__link">
    APC - Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#as-abap-as-an-apc-server" class="md-nav__link">
    AS ABAP as an APC Server
  </a>
  
    <nav class="md-nav" aria-label="AS ABAP as an APC Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abap-push-channels-as-repository-objects" class="md-nav__link">
    ABAP Push Channels as Repository Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apc-handler-class" class="md-nav__link">
    APC Handler Class
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#as-abap-as-apc-client" class="md-nav__link">
    AS ABAP as APC client
  </a>
  
    <nav class="md-nav" aria-label="AS ABAP as APC client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executable-examples" class="md-nav__link">
    Executable Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#as-abap-as-a-detached-apc-client" class="md-nav__link">
    AS ABAP as a Detached APC Client
  </a>
  
    <nav class="md-nav" aria-label="AS ABAP as a Detached APC Client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executable-examples_1" class="md-nav__link">
    Executable Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#associating-apc-with-amc" class="md-nav__link">
    Associating APC with AMC
  </a>
  
    <nav class="md-nav" aria-label="Associating APC with AMC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executable-examples_2" class="md-nav__link">
    Executable Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apc-system-wide-access" class="md-nav__link">
    APC - System-Wide Access
  </a>
  
    <nav class="md-nav" aria-label="APC - System-Wide Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executable-example" class="md-nav__link">
    Executable Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apc-security" class="md-nav__link">
    APC - Security
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apc-exceptions" class="md-nav__link">
    APC - Exceptions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apc-test-and-analysis" class="md-nav__link">
    APC - Test and Analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-information" class="md-nav__link">
    More Information
  </a>
  
    <nav class="md-nav" aria-label="More Information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#continue" class="md-nav__link">
    Continue
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/eduardocopat/abap-docs/edit/master/docs/7.54/abenapc.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <p><small>
<a href="../abenabap" class="blue">ABAP Keyword Documentation</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_reference" class="blue">ABAP &#x2212; Reference</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_data_communication" class="blue">Data Interfaces and Communication Interfaces</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_channels" class="blue">ABAP Channels</a>&#xA0;</small></p>
<h1 id="apc-abap-push-channels">APC - ABAP Push Channels</h1>
<ul>

<li><a href="#@@ITOC@@ABENAPC_1" class="blue">APC - Overview</a></li>

<p></ul>
<ul></p>
<li><a href="#@@ITOC@@ABENAPC_2" class="blue">AS ABAP as an APC Server</a></li>

<p></ul>
<ul class="circlem2"></p>
<li><a href="#@@ITOC@@ABENAPC_3" class="blue">ABAP Push Channels as Repository Objects</a></li>

<p></ul>
<ul class="circlem2"></p>
<li><a href="#@@ITOC@@ABENAPC_4" class="blue">APC Handler Class</a></li>

<p></ul>
<ul></p>
<li><a href="#@@ITOC@@ABENAPC_5" class="blue">AS ABAP as APC client</a></li>

<p></ul>
<ul></p>
<li><a href="#@@ITOC@@ABENAPC_6" class="blue"> AS ABAP as a Detached APC Client</a></li>

<p></ul>
<ul></p>
<li><a href="#@@ITOC@@ABENAPC_7" class="blue">Associating APC with AMC</a></li>

<p></ul>
<ul></p>
<li><a href="#@@ITOC@@ABENAPC_8" class="blue">APC - System-Wide Access</a></li>

<p></ul>
<ul></p>
<li><a href="#@@ITOC@@ABENAPC_9" class="blue">APC - Security</a></li>

<p></ul>
<ul></p>
<li><a href="#@@ITOC@@ABENAPC_10" class="blue">APC - Exceptions</a></li>

<p></ul>
<ul></p>
<li><a href="#@@ITOC@@ABENAPC_11" class="blue">APC - Test and Analysis</a></li>

<p></ul>
<ul></p>
<li><a href="#@@ITOC@@ABENAPC_12" class="blue">More Information</a></li>

<p></ul>
Other versions: 
 <s><i>7.31</i></s> | <a href="../../7.40/abenapc">7.40</a> | <b>7.54</b></p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Note</p></p>
<p>Each communication step in ABAP Push Channels, such as sending a message or responding to an event, can be associated with a change of
<a href="../abenwork_process_glosry" class="grey" title="Glossary Entry">work process</a> and usually triggers a
<a href="../abendatabase_commit_glosry" class="grey" title="Glossary Entry">database commit</a>.</p>
<p><a name="@@ITOC@@ABENAPC_1"></a>
</div></p>
<h2 id="apc-overview">APC - Overview</h2>
<p>ABAP Push Channels (APC) enable bidirectional communication with the Internet for ABAP programs using the following:</p>
<ul>

<li>WebSockets</li>

</ul>

<ul>

<li>TCP sockets</li>

</ul>

<p>Both communication protocols are based on the <a href="http://tools.ietf.org/html/rfc793" target="blank" class="blue">
transmission control protocol (TCP)</a>, which enables push communication (unlike HTTP). Under the traditional
pull principle, each response of a server requires a preceding client request; under the push principle,
however, it is enough to have an open connection between client and server, used by the server to pass information as soon as it becomes available.</p>
<ul>

<li>An <a href="http://tools.ietf.org/html/rfc6455" target="blank" class="blue">AS ABAP</a> can use the
<a href="../abensap_nw_abap_glosry" class="grey" title="Glossary Entry">WebSocket</a> protocol to communicate
with clients and servers that support this protocol. All standard Web browsers, for example, support
the WebSocket protocol. One example of clients are appropriately programmed Web pages in browsers that support WebSockets.</li>

</ul>

<ul>

<li>An <a href="../abensap_nw_abap_glosry" class="grey" title="Glossary Entry">AS ABAP</a> can use
TCP sockets directly using TCP/IP packets to communicate with clients and servers that do not support
the WebSocket protocol. These can be, for example, embedded systems or programmable logic controllers
(PLC). Direct communication is hence possible between ABAP programs and &quot;intelligent things&quot; in the Internet of Things (IoT) or devices used to control and monitor machines.</li>

</ul>

<p>ABAP Push Channels can be used to make AS ABAP into a WebSocket server and a WebSocket client. The APC framework in AS ABAP makes the following scenarios possible:</p>
<ul>

<li>AS ABAP as an APC server</li>

</ul>

<ul class="circlem2">

<li>stateless</li>

</ul>

<ul class="circlem2">

<li>stateful</li>

</ul>

<ul>

<li>AS ABAP as APC client</li>

</ul>

<ul>

<li>AS ABAP as a detached APC client</li>

</ul>

<ul class="circlem2">

<li>stateless</li>

</ul>

<ul class="circlem2">

<li>stateful</li>

</ul>

<dd>
A detached client is an AS ABAP <a href="../abenapplication_server_glosry" class="grey" title="Glossary Entry">
AS Instance</a> that opens a connection to an APC server, is detached, and can then itself be addressed as an APC server.
</dd>

<p>All scenarios can be implemented for both protocols, WebSocket and TCP socket. The associated class-based APIs in AS ABAP for both protocols are very similar. For an AS ABAP as APC server,
<a href="../abenabap_push_channel_glosry" class="grey" title="Glossary Entry">ABAP push channels</a> need to be created as repository objects. A service in the
<a href="../abenicf" class="blue">ICF</a> service tree and a special
<a href="../abenapc_handler_class_glosry" class="grey" title="Glossary Entry">APC handler class</a>
are then assigned to these objects. A WebSocket server can be addressed directly using a HTTP/HTTPS query, whereas corresponding TCP ports need to be configured for TCP sockets.</p>
<p>For both protocols, simple character and byte strings can be used as a format for messages. In the case of the WebSocket protocol, SAP&apos;s
<a href="../abenpush_channel_protocol_glosry" class="grey" title="Glossary Entry">Push Channel Protocol (PCP)</a> should also be used. For the WebSocket protocol, it is still possible to associate ABAP Push Channels with
<a href="../abenamc" class="blue">ABAP Messaging Channels (AMC)</a> to make AS ABAP communication with the Internet independent of the current
<a href="../abenapplication_server_glosry" class="grey" title="Glossary Entry">AS Instance</a>.</p>
<p><a name="@@ITOC@@ABENAPC_2"></a></p>
<h2 id="as-abap-as-an-apc-server">AS ABAP as an APC Server</h2>
<p>To implement a stateless or stateful APC server on an AS ABAP, an
<a href="../abenabap_push_channel_glosry" class="grey" title="Glossary Entry">ABAP Push Channel</a> must be created as a repository object and an associated
<a href="../abenapc_handler_class_glosry" class="grey" title="Glossary Entry">APC handler class</a> implemented.</p>
<p><a name="@@ITOC@@ABENAPC_3"></a></p>
<h3 id="abap-push-channels-as-repository-objects">ABAP Push Channels as Repository Objects</h3>
<p>An <a href="../abenabap_push_channel_glosry" class="grey" title="Glossary Entry">ABAP Push Channel</a> defined as a
<a href="../abenrepository_object_glosry" class="grey" title="Glossary Entry">repository object</a> must exist for each APC server application. ABAP Push Channels can be created in
<a href="../abenrepository_browser_glosry" class="grey" title="Glossary Entry">Repository Browser</a>
in ABAP Workbench by opening the context menu of a package and choosing <span class="italic">Connectivity</span>.
The <span class="italic">Connectivity Browser</span> of the Object Navigator provides another means of access. To open the Object Navigator for APCs, use transaction <span class="lnkgrey">SAPC</span>.</p>
<p>When a push channel is created, either WebSocket or TCP socket must be defined as the <span class="italic">connection
type</span>. The server must also be defined as stateless or stateful. On stateful servers, the context
and, more specifically, the attributes of the APC handler are preserved each time the server is accessed by a client.</p>
<p>Each push channel has two further repository objects generated when a push channels is created:</p>
<ul>

<li>A node in the service tree of <a href="../abenicf" class="blue">ICF</a>, visible in transaction
<span class="lnkgrey">SICF</span> (the service editor). Like all other ICF services, this node represents
the Web address of the push channel. This node can be activated and deactivated in the service editor, but not tested directly.</li>

</ul>

<ul class="circlem2">

<li>In the case of the WebSocket protocol, other systems (such as a Web browser that supports the WebSocket protocol) can use this address to communicate with the push channel directly.</li>

</ul>

<ul class="circlem2">

<li>In the case of the TCP socket protocol, the alias mechanism in ICF must be used to configure a TCP port.</li>

</ul>

<ul>

<li>An APC handler class saved as a global class in the ABAP Class Library and which can be edited in
Class Builder. When a query is sent to a push channel, the APC framework creates an instance of the class as an APC handler in a dedicated
<a href="../abenapc_session_glosry" class="grey" title="Glossary Entry">APC session</a>.</li>

</ul>

<p>An optional subprotocol of the WebSocket protocol can be assigned to a push channel that uses the WebSocket protocol. Currently, SAP&apos;s own
<a href="../abenpush_channel_protocol_glosry" class="grey" title="Glossary Entry">Push Channel Protocol
(PCP)</a> can be assigned. The generated APC handler class inherits from a different superclass, depending on the protocol used, and includes other interfaces that enable specific access to the protocol.</p>
<p><br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>See the ABAP Push Channels <span class="qtext400">DEMO_APC</span>, <span class="qtext400">DEMO_APC_PCP</span>,
and <span class="qtext400">DEMO_APC_PCP_STATEFUL</span> in the package SABAPDEMOS. All three use the
WebSocket protocol. <span class="qtext400">DEMO_APC</span> is stateless and does not use a subprotocol. <span class="qtext400">DEMO_APC_PCP</span> is stateless and uses the
<a href="../abenpush_channel_protocol_glosry" class="grey" title="Glossary Entry">Push Channel Protocol
(PCP)</a> as a subprotocol. DEMO_APC_PCP_STATEFUL is like <span class="qtext400">DEMO_APC_PCP</span> but is stateful.</p>
<p><a name="@@ITOC@@ABENAPC_4"></a>
</div></p>
<h3 id="apc-handler-class">APC Handler Class</h3>
<p>The APC handler class of each ABAP Push Channel inherits from one of the following superclasses (depending on its attributes):</p>
<ul>

<li>WebSocket protocol</li>

</ul>

<ul class="circlem2">

<li><span class="lnkgrey">CL_APC_WSP_EXT_STATELESS_BASE</span> <br>(stateless if a subprotocol is not used)</li>

</ul>

<ul class="circlem2">

<li><span class="lnkgrey">CL_APC_WSP_EXT_STATELESS_PCP_B</span> <br>(stateless if the <a href="../abenpush_channel_protocol_glosry" class="grey" title="Glossary Entry">Push Channel Protocol (PCP)</a> is used)</li>

</ul>

<ul class="circlem2">

<li><span class="lnkgrey">CL_APC_WSP_EXT_STATEFUL_BASE</span> <br>(stateful if a subprotocol is not used)</li>

</ul>

<ul class="circlem2">

<li><span class="lnkgrey">CL_APC_WSP_EXT_STATEFUL_PCP_B</span> <br>(stateful if the <a href="../abenpush_channel_protocol_glosry" class="grey" title="Glossary Entry">Push Channel Protocol (PCP)</a> is used)</li>

</ul>

<ul>

<li>TCP socket protocol.</li>

</ul>

<ul class="circlem2">

<li><span class="lnkgrey">CL_APC_TCP_EXT_STATELESS_BASE</span> <br>(stateless)</li>

</ul>

<ul class="circlem2">

<li><span class="lnkgrey">CL_APC_TCP_EXT_STATEFUL_BASE</span> <br>(stateful)</li>

</ul>

<p>All superclasses contain abstract interface methods ON_START and ON_MESSAGE that can be redefined as application-specific methods:</p>
<ul>

<li>ON_START</li>

</ul>

<dd>
The APC framework runs this method in the APC handler when the push channel is opened. Here, initial actions can be implemented, to be performed at this time. For example, the binding can be made to an
<a href="../abenamc" class="blue">ABAP Messaging Channel</a> here. The method can also remain empty.
</dd>

<ul>

<li>ON_MESSAGE</li>

</ul>

<dd>
The APC framework executes this method in the APC handler when the push channel receives an APC message.
All responses to the message must be implemented or called here. Input parameters are available here
that reference objects for the message, its context, and the message manager. For example, a message can be sent as a response.
</dd>

<ul class="circlem2">

<li>In an APC without a subprotocol, text messages and binary message content can be read from received message objects and written to message objects waiting to be sent.</li>

</ul>

<ul class="circlem2">

<li>In an APC with <a href="../abenpush_channel_protocol_glosry" class="grey" title="Glossary Entry">Push
Channel Protocol (PCP)</a>, the content of received messages can be deserialized to ABAP data and ABAP data can be serialized to message objects waiting to be sent.</li>

</ul>

<p>Further optional interface methods, such as ON_ACCEPT, ON_CLOSE, and ON_ERROR can be implemented to
respond to the corresponding events. More particularly, ON_ACCEPT can be used to decide whether an APC connection is opened.</p>
<p>The APC handler classes for the TCP socket protocol have an additional method, ON_CONNECTION_SETUP,
from the interface <span class="lnkgrey">IF_APC_TCP_SERVER_CONFIG</span> in which the TCP framework
structure must be defined. Here, a TCP framework type and a value for this type can be specified using
constants of the interface <span class="lnkgrey">IF_APC_TCP_FRAME_TYPES</span>. The TCP framework structure can be determined using a terminator character or a length.</p>
<p>An APC message in an APC handler class is handled as
<a href="../abenapc_processing_glosry" class="grey" title="Glossary Entry">APC processing</a> in a separate
<a href="../abenapc_session_glosry" class="grey" title="Glossary Entry">APC session</a>. Here, certain
statements, like <a href="../abapmessage" class="blue"><code style="display: inline;"><span class="qtext">MESSAGE</span></code></a> or <a href="../abapbreak-point" class="blue">
<code style="display: inline;"><span class="qtext">BREAK-POINT</span></code></a>, are handled differently than, for example, in dialog processing. External breakpoints can be set to debug programs during APC processing. In stateful APC processing, the program is executed in
<a href="../abenapc_non_blocking_model" class="blue">non-blocking mode</a>, where all statements are forbidden that could prevent inbound messages from being received.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>Each time a message is sent and each time APC processing is exited, a
<a href="../abendatabase_commit_glosry" class="grey" title="Glossary Entry">database commit</a> is executed (except during
<a href="../abenupdate_glosry" class="grey" title="Glossary Entry">updates</a>).</li>

<p></ul>
<ul></p>
<li>If no subprotocol is used, there are no special requirements made on an APC client, such as a WebSocket-enabled
browser. As a WebSocket server, an AS ABAP can be addressed using text messages and binary messages and with standard techniques. If SAP&apos;s own
<a href="../abenpush_channel_protocol_glosry" class="grey" title="Glossary Entry">Push Channel Protocol
(PCP)</a> is used, a WebSocket client must use the associated API. For external clients such as WebSocket-enabled browsers, this API is available as a JavaScript file in the MIME repository under the node <span class="lnkgrey"><span class="qtext400">/sap/public/bc/ur/sap-pcp-websocket.js</span></span>.</li>

<p></ul>
</div>
<br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>See the APC handler class <span class="lnkgrey">CL_APC_WS_EXT_DEMO_APC</span> for the ABAP Push Channel
<span class="qtext400">DEMO_APC</span> or <span class="lnkgrey">CL_APC_WSP_EXT_DEMO_APC_PCP</span> for
the ABAP Push Channel <span class="qtext400">DEMO_APC_PCP</span>. The APC handler class <span class="lnkgrey">CL_APC_WSP_EXT_DEMO_APC_PCP_ST</span>
for the ABAP Push Channel <span class="qtext400">DEMO_APC_PCP_STATEFUL</span> calls the identically
named methods of CL_APC_WSP_EXT_DEMO_APC_PCP. Here, an object of the class is created in the method ON_ACCEPT. The executable example under
<a href="../abenapc_abexa" class="blue">AS ABAP as WebSocket Server</a> creates a Web site that accesses these APC services as a client.</p>
<p><a name="@@ITOC@@ABENAPC_5"></a>
</div></p>
<h2 id="as-abap-as-apc-client">AS ABAP as APC client</h2>
<p>The functions of APC clients in an AS ABAP are implemented in handler classes that integrate the following interfaces:</p>
<ul>

<li><span class="lnkgrey">IF_APC_WSP_EVENT_HANDLER</span> <br>for the WebSocket protocol and the TCP socket protocol without subprotocol.</li>

</ul>

<ul>

<li><span class="lnkgrey">IF_APC_WSP_EVENT_HANDLER_PCP</span> <br>for the WebSocket protocol with the
<a href="../abenpush_channel_protocol_glosry" class="grey" title="Glossary Entry">Push Channel Protocol (PCP)</a></li>

</ul>

<p>The interface methods ON_OPEN, ON_MESSAGE, ON_CLOSE, and ON_ERROR can be implemented in suitable ways
in the handler classes. ON_OPEN and ON_CLOSE are executed when opening and closing a connection, whereas
ON_MESSAGE is triggered the next time messages from the server cause the work process to change. The attribute MESSAGE can be accessed in ON_MESSAGE. When a method like this is being processed, no
<a href="../abendatabase_commit_glosry" class="grey" title="Glossary Entry">database commit</a> can be executed, implicitly or explicitly, since this cause the runtime error APC_ILLEGAL_STATEMENT.</p>
<p>The following classes are used to instantiate the actual client objects:</p>
<ul>

<li><span class="lnkgrey">CL_APC_WSP_CLIENT_MANAGER</span> <br>using the methods CREATE_BY_URL or CREATE_BY_DESTINATION for the WebSocket protocol</li>

</ul>

<ul>

<li><span class="lnkgrey">CL_APC_TCP_CLIENT_MANAGER</span> <br>using the method CREATE for the TCP socket protocol</li>

</ul>

<p>The address of the server in question, a reference to the hander object, and the subprotocol (if needed)
are passed to these methods. In the case of the TCP socket protocol, the TCP framework structure must
be defined by a terminator character or a length. Reference variables of the type <span class="lnkgrey">IF_APC_WSP_CLIENT</span> that point to a client object with the following interface methods are returned:</p>
<ul>

<li>The method GET_CONTEXT gets a context object whose method GET_INITIAL_REQUEST can be used in the
WebSocket protocol to create an access object for the HTTP address. This object then specifies paths and form fields for the address.</li>

</ul>

<ul>

<li>The method CONNECT opens an APC connection to a server using the information from the client object. The method CLOSE can be used to close the connection again explicitly. When the current
<a href="../abeninternal_session_glosry" class="grey" title="Glossary Entry">internal session</a> is
closed while a connection is open, the connection is also closed implicitly. If a connection is closed by an error, the handler method ON_ERROR is called, followed by the handler method ON_CLOSE.</li>

</ul>

<ul>

<li>The method GET_MESSAGE_MANAGER gets a reference of type <span class="lnkgrey">IF_APC_WSP_MESSAGE_MANAGER_BAS</span>
to a message manager object that can be cast to <span class="lnkgrey">IF_APC_WSP_MESSAGE_MANAGER</span>
or <span class="lnkgrey">IF_APC_WSP_MESSAGE_MANAGER_PCP</span> as specified by the subprotocol. The message manager can be used to create messages and send them from the client to the server.</li>

</ul>

<p>When an APC message is sent, messages can be received by the server in the client session. This requires
that the current session be in a wait state (rolled out by a change of work process). Messages directed
to the client that are received by the AS ABAP during the wait state call the method ON_MESSAGE of the handler object when the session is rolled in. The work process can be changed explicitly or implicitly:</p>
<ul>

<li>The statement <a href="../abapwait_apc" class="blue"><code style="display: inline;"><span class="qtext">WAIT FOR PUSH CHANNELS</span></code></a>
is used for explicit programming. As specified by a condition, this statement switches the work process, and hence rolls out the session, while waiting for messages.</li>

</ul>

<ul>

<li>Implicit switches of the work process, as occur for example at the end of a
<a href="../abendialog_step_glosry" class="grey" title="Glossary Entry">dialog step</a>, are useful in GUI scenarios where <code style="display: inline;"><span class="qtext">WAIT</span></code> needs to be avoided.</li>

</ul>

<h3 id="executable-examples">Executable Examples</h3>
<ul>

<li><a href="../abenapc_ws_client_abexa" class="blue">AS ABAP as WebSocket client</a></li>

<p></ul>
<ul></p>
<li><a href="../abenapc_tcp_client_abexa" class="blue">AS ABAP as TCP socket client</a></li>

<p></ul>
<a name="@@ITOC@@ABENAPC_6"></a></p>
<h2 id="as-abap-as-a-detached-apc-client">AS ABAP as a Detached APC Client</h2>
<p>Like in AS ABAP as an APC client, detached APC clients open a connection from an
<a href="../abenapplication_server_glosry" class="grey" title="Glossary Entry">AS Instance</a> to an
APC server and detach it again immediately. The same AS ABAP or another one can then attach itself to
this connection as an attached APC client. The AS ABAP that opened the connection is given the part of an APC server as a detached client. This server can be stateless or stateful.</p>
<p>As in an APC client, a detached client requires handler classes with the interfaces <span class="lnkgrey">IF_APC_WSP_EVENT_HANDLER</span>
or <span class="lnkgrey">IF_APC_WSP_EVENT_HANDLER_PCP</span>. In this case, however, only the method
ON_OPEN is called and must be implemented accordingly. In the method ON_OPEN, the method GET_CONNECTION_ATTACH_HANDLE
of the interface <span class="lnkgrey">IF_APC_WSP_SERVER_CONTEXT</span> can be used to get a connection
handle for the detached client from the context object. This can then be used to connect with an attached
client. Here, a security rule must be defined that specifies whether only sessions with the same client and user or only the current program can operate as an attached client in the same client.</p>
<p>The following classes are used to instantiate the actual detached client objects:</p>
<ul>

<li><span class="lnkgrey">CL_APC_WSP_CLIENT_CONN_MANAGER</span> <br>using the methods CREATE_BY_URL or CREATE_BY_DESTINATION for the WebSocket protocol</li>

</ul>

<ul>

<li><span class="lnkgrey">CL_APC_TCP_CLIENT_CONN_MANAGER</span> <br>using the method CREATE for the TCP socket protocol</li>

</ul>

<p>The methods CREATE_... have the same semantics as in a regular APC client and connect to an APC server.</p>
<p>The interface <span class="lnkgrey">IF_APC_WSP_CLIENT_CONN_DETACH</span> is used to access a detached
client object. Once a connection is defined with a stateless or stateful APC, it is opened and then
immediately detached using the method CONNECT_AND_DETACH. This executes the method ON_OPEN, which gets a connection handle for the connection using the context object.</p>
<p>To connect an AS ABAP with the detached client as an attached client, the method ATTACH of the classes
<span class="lnkgrey">CL_APC_WSP_CLIENT_CONN_MANAGER</span> or <span class="lnkgrey">CL_APC_TCP_CLIENT_CONN_MANAGER</span>
above is used to create attached client objects. Here, the connection handle for the connection must
be passed. This can take place in the current session or in a different session. The interface <span class="lnkgrey">
IF_APC_WSP_CLIENT_CONN_ATTACH</span> can be used to access an attached client object. As in regular
client objects, messages can be sent using the message manager. It is not possible, however, to create
a connection with a handler class to use <a href="../abapwait_apc" class="blue"><span class="qtext">WAIT
FOR PUSH CHANNELS</span></a> to wait for messages. Any connections to detached clients that are no longer needed should be closed using the method CLOSE of the attached client object.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>A detached client supports scenarios where an AS ABAP that wants to operate as an APC server itself opens an APC connection.</li>

<p></ul>
<ul></p>
<li>If the same AS ABAP with the same ABAP Push Channel is given the part of the detached and attached
client, the sent messages must be identified as suitable messages in the APC handler class to prevent it from responding to its own messages. The header fields of the
<a href="../abenpcp" class="blue">PCP protocol</a> are an appropriate way of doing this.</li>

<p></ul>
<ul></p>
<li>When an AS ABAP is working as a stateful detached client, an ABAP program is processed in the
<a href="../abenapc_non_blocking_model" class="blue">non-blocking mode</a>. Here, all statements are forbidden that could prevent inbound messages from being received.</li>

<p></ul>
<ul></p>
<li>APC messages sent from an attached client object using the interface IF_APC_WSP_CLIENT_CONN_ATTACH The length of messages that can be sent is currently restricted to approximately 1 MB. Character strings are converted to the
<a href="../abenutf8_glosry" class="grey" title="Glossary Entry">UTF-8</a> format. The limit can be increased by changing the profile parameter <span class="lnkgrey">rdisp/long_messages/max_length</span>.</li>

<p></ul>
</div></p>
<h3 id="executable-examples_1">Executable Examples</h3>
<ul>

<li><a href="../abenapc_detached_client_abexa" class="blue">Creating a Detached Client</a></li>

<p></ul>
<ul></p>
<li><a href="../abenapc_attached_client_abexa" class="blue">AS ABAP as Attached Client</a>.</li>

<p></ul>
<a name="@@ITOC@@ABENAPC_7"></a></p>
<h2 id="associating-apc-with-amc">Associating APC with AMC</h2>
<p>On its own, the APC framework enables a WebSocket to communicate with precisely one
<a href="../abenapplication_server_glosry" class="grey" title="Glossary Entry">AS Instance</a>. To make communication non-dependent on the current AS Instance, the servers can be associated using
<a href="../abenamc" class="blue">ABAP Messaging Channels</a>. Here, a push channel (in the implementation
of its APC handler class with method BIND_AMC_MESSAGE_CONSUMER of interface <span class="lnkgrey">IF_APC_WSP_BINDING_MANAGER</span>
of one the specially created binding managers) can be associated with an AMC consumer for a specific
ABAP Messaging Channel with a suitable message type.  Messages sent using this ABAP Messaging Channel
are then handled automatically as APC messages. The APC framework wraps the required methods of the
AMC framework. The only prerequisite is that the APC handler class is authorized to bind consumers and
to send messages in the messaging channel in question. The association with the AMC consumer can be
removed explicitly using the method UNBIND_AMC_MESSAGE_CONSUMER of the binding manager. Any attempts to remove a nonexistent association raise an exception.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>It is not possible to associate APC with AMC for TCP sockets.</li>

<p></ul>
<ul></p>
<li>It is not possible to associate APC with AMC during <a href="../abenupdate_glosry" class="grey" title="Glossary Entry">updates</a>.</li>

<p></ul>
<ul></p>
<li>A push channel can only be associated once with a messaging channel. Any attempts to bind a push
channel more than once to a messaging channel that is already bound raise any exception. Any attempts to remove a nonexistent association raise an exception.</li>

<p></ul>
<ul></p>
<li>The methods BIND_AMC_MESSAGE_CONSUMER and UNBIND_AMC_MESSAGE_CONSUMER both cause a <a href="../abendatabase_commit_glosry" class="grey" title="Glossary Entry">database commit</a>.</li>

<p></ul>
<ul></p>
<li>If an ABAP Push Channel is associated with a messaging channel, it is possible to stop messages
from being sent to the same connection, if the value of ABAP_TRUE is passed to the parameter I_SUPPRESS_ECHO
when the AMC sender object is created using the method CREATE_MESSAGE_PRODUCER of the class <span class="lnkgrey">CL_AMC_CHANNEL_MANAGER</span>.
If the APC connection is part of the ABAP session that uses the AMC sender object to send, the AMC message to the same APC connection is suppressed.</li>

<p></ul>
</div></p>
<h3 id="executable-examples_2">Executable Examples</h3>
<ul>

<li>See <a href="../abenapc_abexa" class="blue">AS ABAP as WebSocket Server</a>, where ABAP Push Channels are demonstrated both with and without an association with AMC.</li>

<p></ul>
<ul></p>
<li>Execute <span class="lnkgrey">DEMO_APC_PING_PONG</span>.</li>

<p></ul>
<a name="@@ITOC@@ABENAPC_8"></a></p>
<h2 id="apc-system-wide-access">APC - System-Wide Access</h2>
<p>An AS ABAP can send a message to an APC with which it is not associated as long as it knows the connection
handle for this connection. The APC connection can exist on the same AS Instance or on a different server.
The APC handler class can use the method GET_CONNECTION_ATTACH_HANDLE of the interface <span class="lnkgrey">IF_APC_WSP_SERVER_CONTEXT</span>
to get its connection handle from the context object. Here, a security rule must be defined that specifies
whether only sessions with the same client and user or only the current program can access the connection in the same client.</p>
<p>A program that knows the connection handle and meets the prerequisites can use the method ATTACH of
the classes <span class="lnkgrey">CL_APC_WSP_CLIENT_CONN_MANAGER</span> or <span class="lnkgrey">CL_APC_TCP_CLIENT_CONN_MANAGER</span>
to create an access object. These are the same methods as used to create an attached client for a detached
client and the access object has the corresponding attributes. Its message manager can be used to create messages and send them to the APC connection.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>System-wide sending of messages using an access object is technically the same as using an attached
client object, but the scenario itself is different. Only attached clients can be used to access a detached client. System-wide access is possible in all scenarios if required.</li>

<p></ul>
<ul></p>
<li>APC messages sent from an attached client object using the interface IF_APC_WSP_CLIENT_CONN_ATTACH The length of messages that can be sent is currently restricted to approximately 1 MB. Character strings are converted to the
<a href="../abenutf8_glosry" class="grey" title="Glossary Entry">UTF-8</a> format. The limit can be increased by changing the profile parameter <span class="lnkgrey">rdisp/long_messages/max_length</span>.</li>

<p></ul>
</div></p>
<h3 id="executable-example">Executable Example</h3>
<p><a href="../abenapc_connect_via_handle_abexa" class="blue">System-Wide Access</a></p>
<p><a name="@@ITOC@@ABENAPC_9"></a></p>
<h2 id="apc-security">APC - Security</h2>
<p>For the ABAP Push Channel, a virus scan profile can be specified for outbound and inbound messages. This profile is used when the virus scan interface (VSI) runs checks.</p>
<p>As was previously the case, WebSocket messages can only be handled if the WebSocket object is created
using a file or website from the same address or domain. In other cases, permitted addresses or domains
must be created using transaction <span class="lnkgrey">SAPC_CROSS_ORIGIN</span> in the table <span class="lnkgrey">APC_CROSS_ORIGIN</span>. Authorization for the fields of authorization object S_APC_ORIG is required.</p>
<p><a name="@@ITOC@@ABENAPC_10"></a></p>
<h2 id="apc-exceptions">APC - Exceptions</h2>
<p>Error situations in sender and receiver programs (such as violations of rules set by the properties of a push channel) raise exceptions of the class CX_APC_ERROR.</p>
<p><a name="@@ITOC@@ABENAPC_11"></a></p>
<h2 id="apc-test-and-analysis">APC - Test and Analysis</h2>
<p>The existing test and analysis tools, such as <a href="../abenabap_debugger_glosry" class="grey" title="Glossary Entry">ABAP Debugger</a>,
<a href="../abenruntime_analysis_glosry" class="grey" title="Glossary Entry">runtime analysis</a>, or
<a href="../abenperformance_trace_glosry" class="grey" title="Glossary Entry">performance trace</a>, can be used as usual for programs running on AS ABAP and sending and receiving APC messages.</p>
<p>An overview of all APC connections on an AS ABAP can be found in transaction <span class="lnkgrey">SMWS</span>. Any surplus connections can also be closed here.</p>
<p><a name="@@ITOC@@ABENAPC_12"></a></p>
<h2 id="more-information">More Information</h2>
<p>Detailed information about APC can be found in the <span class="lnkgrey">ABAP Channels</span> documentation in SAP Help Portal.</p>
<h3 id="continue">Continue</h3>
<p><a href="../abenapc_non_blocking_model" class="blue">APC - Non-Blocking Mode</a></p>
<p><a href="../abapwait_apc" class="blue">WAIT FOR PUSH CHANNELS</a></p>
<p><a href="../abenapc_abexas" class="blue">Examples of APC</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.df0def68.min.js"></script>
      <script src="../../assets/javascripts/bundle.ba57d267.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js"></script>
      
        <script src="../../javascript/hljs.js"></script>
      
    
  </body>
</html>