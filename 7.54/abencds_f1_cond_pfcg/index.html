


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.9">
    
    
      
        <title>ABAP CDS - DEFINE ROLE, pfcg_condition - ABAP docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.36ee6aaa.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.83bccb1f.min.css">
      
      
        
        
        <meta name="theme-color" content="#4051b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://raw.githubusercontent.com/highlightjs/highlight.js/master/src/styles/github.css">
    
      <link rel="stylesheet" href="../../css/abap-docs.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#abap-cds-define-role-pfcg_condition" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="ABAP docs" class="md-header-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            ABAP docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              ABAP CDS - DEFINE ROLE, pfcg_condition
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ABAP docs" class="md-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ABAP docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="ABAP docs" class="md-nav__link">
      ABAP docs
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#syntax" class="md-nav__link">
    Syntax
  </a>
  
    <nav class="md-nav" aria-label="Syntax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#effect" class="md-nav__link">
    Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addition" class="md-nav__link">
    Addition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continue" class="md-nav__link">
    Continue
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/eduardocopat/abap-docs/edit/master/docs/7.54/abencds_f1_cond_pfcg.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="abap-cds-define-role-pfcg_condition">ABAP CDS - DEFINE ROLE, pfcg_condition</h1>
<p><a name="@@ITOC@@ABENCDS_F1_COND_PFCG_1"></a>
<s><i>7.31</i></s> <a href="../abencds_f1_cond_pfcg">7.40</a> <b>7.54</b></p>
<p><small>
<a href="../abenabap" class="blue">ABAP Keyword Documentation</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_dictionary" class="blue">ABAP - Dictionary</a>&#xA0;&#x2192;&#xA0;
<a href="../abencds" class="blue">ABAP CDS in ABAP Dictionary</a>&#xA0;&#x2192;&#xA0;
<a href="../abencds_authorizations" class="blue">ABAP CDS - Access Control</a>&#xA0;&#x2192;&#xA0;
<a href="../abencds_f1_dcl_syntax" class="blue">ABAP CDS - DCL Statements</a>&#xA0;&#x2192;&#xA0;
<a href="../abencds_f1_define_role" class="blue">ABAP CDS - DEFINE ROLE</a>&#xA0;&#x2192;&#xA0;
<a href="../abencds_dcl_role_conditions" class="blue">ABAP CDS - DEFINE ROLE, condition</a>&#xA0;</small></p>
<h2 id="syntax">Syntax</h2>
<p><pre><code class="hljs abap abap-docs-syntax-block">
<span class="qtext400">... ( <i class="bn">[</i>element1 <i class="bn">|</i><a href="../abencds_f1_cond_pfcg_mapping" class="blue">{ element1<i class="bn">[</i>, element2 ...<i class="bn">]</i> }</a> <br>
&#xA0;&#xA0;&#xA0;&#xA0;<i class="bn">[</i>, element2 <i class="bn">|</i><a href="../abencds_f1_cond_pfcg_mapping" class="blue">{ element1<i class="bn">[</i>, element2 ...<i class="bn">]</i> }</a> ...<i class="bn">]</i><i class="bn">]</i> ) <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; =|?= ASPECT pfcg_auth <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;( auth_object <i class="bn">[</i>IN SCENARIO &apos;scenario&apos;<i class="bn">]</i>, <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <i class="bn">[</i>mapped_field1<i class="bn">|</i><i class="bn">{</i>
<a href="../abencds_f1_cond_pfcg_mapping" class="blue">PFCG_MAPPING = pfcg_mapping</a><i class="bn">}</i><i class="bn">[</i>, <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;mapped_field2<i class="bn">|</i><i class="bn">{</i>
<a href="../abencds_f1_cond_pfcg_mapping" class="blue">PFCG_MAPPING = pfcg_mapping</a><i class="bn">}</i> ...<i class="bn">]</i><i class="bn">]</i><i class="bn">[</i>, <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;auth_field1 = &apos;value&apos;<i class="bn">[</i>, <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;auth_field2 = &apos;value&apos; ...<i class="bn">]</i><i class="bn">]</i> ) ...</span>
</code></pre></p>
<h3 id="effect">Effect</h3>
<p>PFCG condition as part of an <a href="../abenaccess_condition_glosry" class="grey" title="Glossary Entry">
access condition</a> <a href="../abencds_dcl_role_cond_expr" class="blue"><span class="qtext400">cond_expr</span></a> in an
<a href="../abencds_dcl_role_rules" class="blue">access rule</a> of the statement <a href="../abencds_f1_define_role" class="blue"><span class="qtext400">DEFINE ROLE</span></a> in
<a href="../abencds_dcl_glosry" class="grey" title="Glossary Entry">CDS DCL</a>. A PFCG condition joins
the elements of the CDS entity specified on the left side of the operator <span class="qtext400">=</span> or <span class="qtext400">?=</span> with the
<a href="../abenauthorization_glosry" class="grey" title="Glossary Entry">authorizations</a> specified
on the right side (and granted using the classic role editor (transaction <span class="lnkgrey">PFCG</span>)
). CDS access control takes this information and the authorizations of the current user and uses it to create fixed logical conditions, which are evaluated each time the object is accessed.</p>
<ul>

<li>Left Side</li>

</ul>

<ul class="circlem2">

<li>The left side is a parenthesized comma-separated list consisting of multiple
<a href="../abencds_element_glosry" class="grey" title="Glossary Entry">CDS elements</a> of a CDS entity
(or one element or no elements) for which the access condition is defined. An element <span class="qtext400">element</span>
can be specified directly or by using a path expression <a href="../abencds_f1_path_expression" class="blue"><span class="qtext400">path_expr</span></a> and must have one of the valid
<a href="../abencds_f1_dcl_cond_data_types" class="blue">data types</a>. In a multivalue path expression, it is sufficient for the condition to be true for just one of the values.</li>

</ul>

<ul class="circlem2">

<li>As an alternative to a single element <span class="qtext400">element</span>, an element list in curly brackets <span class="qtext400"><a href="../abencds_f1_cond_pfcg_mapping" class="blue">{ element1<i class="bn">[</i>, element2 ...<i class="bn">]</i> }</a></span> can be specified instead. A
<a href="../abencds_pfcg_mapping_glosry" class="grey" title="Glossary Entry">PFCG mapping</a> must
be mapped to this list using <a href="../abencds_f1_cond_pfcg_mapping" class="blue"><span class="qtext400">PFCG_MAPPING = pfcg_mapping</span></a>.</li>

</ul>

<ul>

<li>Right Side</li>

</ul>

<dd>
The right side is introduced using <span class="qtext400">ASPECT</span> <span class="qtext400">pfcg_auth</span>. Here, <span class="qtext400">pfcg_auth</span> is a predefined
<a href="../abencds_aspect_glosry" class="grey" title="Glossary Entry">aspect</a> used to associate the CDS elements with the
<a href="../abenauthorization_glosry" class="grey" title="Glossary Entry">authorizations</a> of the current user for an
<a href="../abenauthorization_object_glosry" class="grey" title="Glossary Entry">authorization object</a> of the
<a href="../abenbc_authority_check" class="blue">SAP authorization concept</a>. This association is made in a parenthesized comma-separated list:
</dd>

<ul class="circlem2">

<li>The name of an existing authorization object is defined using <span class="qtext400">auth_object</span>.</li>

</ul>

<ul class="circlem2">

<li><span class="qtext400">mapped_field1</span>, <span class="qtext400">mapped_field2</span> are used to specify the names of the
<a href="../abenauthorization_field_glosry" class="grey" title="Glossary Entry">authorization fields</a>
of the authorization object to map them to the CDS elements on the left side in the specified order.
The number of CDS elements must match the number of authorization fields. It is possible to map a single authorization field to multiple CDS elements. By default, CDS access control evaluates all
<a href="../abenauthorization_glosry" class="grey" title="Glossary Entry">authorizations</a> of the
current user for the specified CDS elements in accordance with this assignment. The PFCG condition is true whenever an authorization is present.</li>

</ul>

<ul class="circlem2">

<li>If a CDS element is specified on the left side as an element list in curly brackets <span class="qtext400"><a href="../abencds_f1_cond_pfcg_mapping" class="blue">{ element1<i class="bn">[</i>, element2 ...<i class="bn">]</i> }</a></span> rather than being specified directly, <a href="../abencds_f1_cond_pfcg_mapping" class="blue">
<span class="qtext400">PFCG_MAPPING = pfcg_mapping</span></a> must be used to specify a
<a href="../abencds_pfcg_mapping_glosry" class="grey" title="Glossary Entry">PFCG mapping</a> instead of the name of an authorization field <span class="qtext400">mapped_field</span>.</li>

</ul>

<ul class="circlem2">

<li>Further optional authorization fields <span class="qtext400">auth_field1</span>, <span class="qtext400">auth_field2</span>
of the authorization object can be specified to which literal values can be mapped using <span class="qtext400">=</span>. In this case, the evaluation only respects those
<a href="../abenauthorization_glosry" class="grey" title="Glossary Entry">authorizations</a> of the
current user in which all values specified in this way exist. Here, the same authorization field can be specified more than once with different values.</li>

</ul>

<ul class="circlem2">

<li>If the parentheses on the left side are empty, which means that no element from the CDS entity is
specified, no authorization field <span class="qtext400">mapped_field</span> can be specified after
<span class="qtext400">auth_object</span>. If further optional authorization fields <span class="qtext400">auth_field1</span>,
<span class="qtext400">auth_field1</span>, ... are specified, the same applies as before. CDS access control evaluates all
<a href="../abenauthorization_glosry" class="grey" title="Glossary Entry">authorizations</a> (or those
authorizations specified using <span class="qtext400">auth_field1</span>, <span class="qtext400">auth_field1</span>,
...) of the current user for the authorization object. If there is at least one authorization, the PFCG condition is true, else false.</li>

</ul>

<p>If the operator <span class="qtext400">?=</span> is used, the evaluation is made in the same way as when using <span class="qtext400">=</span>. The condition is also met, however, if all CDS elements in the left parentheses have the
<a href="../abennull_value_glosry" class="grey" title="Glossary Entry">null value</a> or their type-dependent
initial value. This applies even if the user does not have an authorization for the specified authorization object.</p>
<p>The operator <a href="../abencds_dcl_role_cond_expr" class="blue"><span class="qtext400">NOT</span></a>
can only be specified in front of PFCG conditions with empty parentheses on the left side, namely those
without CDS elements <span class="qtext400">element</span> and mapped authorization fields <span class="qtext400">mapped_field</span>.
The following applies with respect to the order in which a PFCG condition is evaluated:</p>
<ul>

<li>If multiple authorizations are evaluated, the resulting conditions are joined using a logical &quot;or&quot;.</li>

</ul>

<ul>

<li>In the conditions of each authorization used, the values for the authorization fields in question are joined using a logical &quot;and&quot;.</li>

</ul>

<ul>

<li>If there are multiple values for an authorization field, they are joined using a logical &quot;or&quot;.</li>

</ul>

<p>When these rules are applied to the access condition actually used by CDS access control, field values from
<a href="../abenauthorization_glosry" class="grey" title="Glossary Entry">authorizations</a> are compared with content from CDS elements. Here, the field values are
<a href="../abencds_f1_dcl_pfcg_mapping" class="blue">converted</a> to the dictionary types of the CDS elements.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>The access conditions produced by the rules above are transformed internally to selection statements by the ABAP runtime environment. In ABAP SQL reads, the additional conditions can be viewed in the
<a href="../abensql_trace_glosry" class="grey" title="Glossary Entry">SQL Trace</a>
tools (transaction <span class="lnkgrey">ST05</span>). The internal implementation can be made using <span class="qtext400">WHERE</span> conditions or
<a href="../abencommon_table_expression_glosry" class="grey" title="Glossary Entry">common table expressions</a> and can change between releases.</li>

<p></ul>
<ul></p>
<li>The key elements of the CDS entity play a key part in internal selection statements. In the CDS
data definition, these elements should either be defined so that they identify a unique row or no key elements should be defined at all. If this is not the case. unexpected results can arise.</li>

<p></ul>
<ul></p>
<li>PFCG conditions with non-empty parentheses on the left side cannot be negated using the operator
<span class="qtext400">NOT</span>, since this entails the opposite of an authorization check and hence unexpected results.</li>

<p></ul>
<ul></p>
<li>PFCG conditions can be combined within an access rule using
<a href="../abencds_f1_cond_literal" class="blue">literal conditions</a>,
<a href="../abencds_f1_cond_user" class="blue">user conditions</a>, and <a href="../abencds_f1_cond_inherit" class="blue">inheritance conditions</a>.</li>

<p></ul>
<ul></p>
<li>If a full authorization exists within a PFCG condition for an authorization field, no condition is created for the CDS element specified on the left side. This makes the PFCG condition accept all values, including the
<a href="../abennull_value_glosry" class="grey" title="Glossary Entry">null value</a>. If this behavior is unwanted, <span class="qtext400">AND</span> can be used to expand a
<a href="../abencds_f1_cond_literal" class="blue">literal condition</a> <span class="qtext400">element IS NOT NULL</span>.</li>

<p></ul>
<ul></p>
<li>It is advisable to specify an <span class="qtext400">element</span> of the CDS entity directly and to only use path expressions in exceptional cases.</li>

<p></ul>
<ul></p>
<li>The operator <span class="qtext400">?=</span> is applied to all CDS elements in the left parentheses. It cannot be restricted to individual elements.</li>

<p></ul>
<ul></p>
<li>The global and context-specific disabling of authorization checks (in transactions <span class="lnkgrey">SU24</span> and <span class="lnkgrey">SU25</span>) is respected.</li>

<p></ul>
</div></p>
<h3 id="addition">Addition</h3>
<p><span class="qtext400">... IN SCENARIO</span></p>
<p>The optional addition <span class="qtext400">IN SCENARIO</span> can be used to apply the switchable authorization (<span class="lnkgrey">transaction SACF</span>) to an authorization object.</p>
<p>The following applies to the addition <span class="qtext400">IN SCENARIO</span>:</p>
<ul>

<li>Unlike direct use in program code (<span class="qtext400">CL_SACF=&gt;AUTH_CHECK_SPEC</span>), the
use of switchable authorizations has the restriction  that there is no interaction with the user interface
(such as warning messages or dialogs in recording mode). The recording modes behave as if the check
method were called using the parameter <span class="qtext400">ID_SILENT = &apos;X&apos;</span> and do not persist any data in the SACF configuration.</li>

</ul>

<ul>

<li>The security audit log, which can be enabled from the SACF configuration contains the name of the
CDS entity with the &#x201C;STOB&#x201D; flag, as well as the name of the authorization object and the requested and filter fields.</li>

</ul>

<ul>

<li>If the PFCG condition uses PFCG mappings, these must also have the addition <span class="qtext400">IN SCENARIO</span> and name the same scenario.</li>

</ul>

<h3 id="examples">Examples</h3>
<p>The following abstract examples explain various types of PFCG conditions:</p>
<ul>

<li>The following example is a typical case. Multiple elements, <span class="qtext400">element1</span>,
<span class="qtext400">element2</span>, are mapped to different authorization fields, <span class="qtext400">field1</span>, <span class="qtext400">field2</span>, of an authorization object <span class="qtext400">auth_object</span>. Those
<a href="../abenauthorization_glosry" class="grey" title="Glossary Entry">authorizations</a> of the current user are evaluated in which a particular activity is allowed.</li>

</ul>

<dd>
<span class="qtext400">@MappingRole: &apos;true&apos; <br>DEFINE ROLE demo_role { <br>&#xA0;&#xA0;&#xA0;&#xA0;grant SELECT ON entity&#xA0;&#xA0;WHERE <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;( element1, element2 ) = ASPECT pfcg_auth <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;( auth_object, <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;field1, <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;field2, <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;ACTVT = &apos;02&apos;); }</span>
</dd>

<dd>
The current user has two authorizations for the authorization object <span class="qtext400">auth_object</span>:
</dd>

<ul class="circlem2">

<li>An authorization with the values &quot;a&quot;, &quot;b&quot; for the authorization field <span class="qtext400">field1</span> and the values &quot;c&quot;, &quot;d&quot; for the authorization field <span class="qtext400">field2</span></li>

</ul>

<ul class="circlem2">

<li>An authorization with the value &quot;X<span class="qtext400">*</span>&quot; for the authorization field <span class="qtext400">
field1</span> and the value &quot;Y&quot; for the authorization field <span class="qtext400">field2</span></li>

</ul>

<dd>
The access condition added to the CDS entity <span class="qtext400">entity</span> by CDS access control using a logical &quot;and&quot; can appear as follows (when expressed in SQL):
</dd>

<dd>
<span class="qtext400">... ... AND ( ( element1 = &apos;a&apos; OR element2 = &apos;b&apos; ) AND <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;( element2 = &apos;c&apos; OR element2 = &apos;d&apos; ) OR <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;element1 LIKE &apos;X%&apos; AND <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;element2 = &apos;Y&apos; )</span>
</dd>

<dd>
The values of each authorization are joined using <span class="qtext400">AND</span> and the conditions of both authorizations are joined using <span class="qtext400">OR</span>. The wildcard character <span class="qtext400">*</span> is
<a href="../abencds_f1_dcl_pfcg_mapping" class="blue">converted</a> to a <span class="qtext400">LIKE</span> condition. The actual variant in question, however, can have a different appearance.
</dd>

<dd>
If <span class="qtext400">?=</span> instead of <span class="qtext400">=</span> is used in the example above, the access condition is expanded roughly as follows: <br>
<span class="qtext400">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;... <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;element2 = &apos;Y&apos; OR <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;( ( element1 IS NULL or element1 = &apos;&apos; ) AND <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;( element2 IS NULL or element2 = &apos;&apos; ) ) )</span>
</dd>

<ul>

<li>The following example illustrates how the evaluated authorizations are restricted using further authorization fields. Only those
<a href="../abenauthorization_glosry" class="grey" title="Glossary Entry">authorizations</a> of the
current user are used that contain both the activities &quot;02&quot; and &quot;03&quot;, plus the authorization field <span class="qtext400">
country</span> with the value &quot;DE&quot;. Only those rows are read for which the CDS element <span class="qtext400">element</span>
matches the authorization field <span class="qtext400">field</span> of these authorizations.</li>

</ul>

<dd>
<span class="qtext400">@MappingRole: true <br>DEFINE ROLE demo_role { <br>GRANT SELECT ON entity WHERE <br>
&#xA0;&#xA0;(element) = ASPECT pfcg_auth( auth_object, <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;field, <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;actvt&#xA0;&#xA0; = &apos;02&apos;, <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;actvt&#xA0;&#xA0; = &apos;03&apos;, <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;country = &apos;DE&apos; );}</span>
</dd>

<ul>

<li>In the following example, the same authorization field <span class="qtext400">field</span> is used
for the items <span class="qtext400">mapped_field</span> and <span class="qtext400">auth_field</span>.
If the current user has an authorization with the values &quot;X&quot;, &quot;Y&quot;, and &quot;Z&quot; for this authorization field,
this authorization is used by specifying <span class="qtext400">field = &apos;X&apos;</span>. CDS access control then uses all three permitted values &quot;X&quot;, &quot;Y&quot;, and &quot;Z&quot; when the CDS entity is accessed.</li>

</ul>

<dd>
<span class="qtext400">@MappingRole: true <br>DEFINE ROLE demo_role { <br>GRANT SELECT ON entity WHERE <br>
&#xA0;&#xA0;(element) = ASPECT pfcg_auth( auth_object, <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;field, <br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;field = &apos;X&apos; ); }</span>
</dd>

<ul>

<li>No CDS element is specified in the following example. CDS access control prevents data from being
read in full if the current user does not have at least an authorization for the authorization object <span class="qtext400">auth_object</span> with the activity &quot;03&quot;.</li>

</ul>

<dd>
<span class="qtext400">@MappingRole: true <br>DEFINE ROLE demo_role { <br>&#xA0;&#xA0;GRANT SELECT ON entity WHERE <br>&#xA0;&#xA0;&#xA0;&#xA0;( ) = ASPECT pfcg_auth( auth_object, ACTVT = &apos;03&apos; ); }</span>
</dd>

<ul>

<li>No CDS element or authorization field is specified in the following example. Here, the only requirement
is that the current user has at least one authorization (any authorization) for the authorization object <span class="qtext400">auth_object</span> (with any values).</li>

</ul>

<dd>
<span class="qtext400">@MappingRole: true <br>DEFINE ROLE demo_role { <br>&#xA0;&#xA0;GRANT SELECT ON entity WHERE <br>&#xA0;&#xA0;&#xA0;&#xA0;( ) = ASPECT pfcg_auth( auth_object ); }</span>
</dd>

<p><br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>The following abstract example shows a valid negation of a PFCG condition using empty parentheses on the left side with the Boolean operator <span class="qtext400">NOT</span>:</p>
<p><span class="qtext400">... WHERE NOT ( ) = ASPECT pfcg_auth( auth_object ) ...</span></p>
<p>The access condition is true if the current user is not assigned the authorization object <span class="qtext400">auth_object</span>.
This property can be used, for example, to implement the replacement of one authorization object with another authorization object.</p>
<p></div>
<br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>The following CDS role constructs an access rule for the CDS view <span class="qtext400">demo_cds_auth_pfcg</span>.
A PFCG condition is specified that associates the CDS element <span class="qtext400">carrid</span> with
the authorization field CARRID of the authorization object S_CARRID. If specified, <span class="qtext400">actvt=&apos;03&apos;</span>
restricts the CDS access control check to the associated authorizations of the current user that have the value &quot;3&quot; in ACTVT.</p>
<dd>
<span class="qtext400">@MappingRole: true <br>define role demo_cds_role_pfcg { <br>&#xA0;&#xA0;grant select on demo_cds_auth_pfcg <br>
&#xA0;&#xA0;where (carrid) = <br>&#xA0;&#xA0;aspect pfcg_auth (s_carrid, carrid, actvt=&apos;03&apos;); }</span>
</dd>

<p>The CDS view is as follows:</p>
<dd>
<span class="qtext400">@AbapCatalog.sqlViewName: &apos;DEMO_CDS_PFCG&apos; <br>@AccessControl.authorizationCheck: #CHECK <br>
define view demo_cds_auth_pfcg <br> as select from <br> scarr <br> { <br> key carrid, <br> carrname, <br> currcode, <br> url <br> };&#xA0;&#xA0;&#xA0;&#xA0;</span>
</dd>

<p>The program <span class="lnkgrey">DEMO_CDS_AUTH_PFCG</span> accesses the view.</p>
<ul>

<li>There is no implicit authorization check when the CDS database view is accessed. Instead, the rows
without authorization are removed from the results later using the statement <a href="../abapauthority-check" class="blue"><code style="display: inline;"><span class="qtext">AUTHORITY-CHECK</span></code></a>.</li>

</ul>

<ul>

<li>When the CDS is accessed, the <code style="display: inline;"><span class="qtext">SELECT</span></code> statement only reads the data for which the current user has authorization.</li>

</ul>

</div>

<h3 id="continue">Continue</h3>
<p><a href="../abencds_f1_cond_pfcg_mapping" class="blue">ABAP CDS - DEFINE ROLE, pfcg_mapping</a></p>
<p><a href="../abencds_f1_dcl_pfcg_mapping" class="blue">ABAP CDS - DEFINE ROLE, Converting Field Values</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../abencds_f1_cond_literal/" title="ABAP CDS - DEFINE ROLE, literal_condition" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                ABAP CDS - DEFINE ROLE, literal_condition
              </div>
            </div>
          </a>
        
        
          <a href="../abencds_f1_cond_pfcg_mapping/" title="ABAP CDS - DEFINE ROLE, pfcg_mapping" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                ABAP CDS - DEFINE ROLE, pfcg_mapping
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.df0def68.min.js"></script>
      <script src="../../assets/javascripts/bundle.ba57d267.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js"></script>
      
        <script src="../../javascript/hljs.js"></script>
      
    
  </body>
</html>