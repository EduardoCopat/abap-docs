


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.9">
    
    
      
        <title>Test Seams - ABAP docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.36ee6aaa.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.83bccb1f.min.css">
      
      
        
        
        <meta name="theme-color" content="#4051b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://raw.githubusercontent.com/highlightjs/highlight.js/master/src/styles/github.css">
    
      <link rel="stylesheet" href="../../css/abap-docs.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#test-seams" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="ABAP docs" class="md-header-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            ABAP docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Test Seams
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ABAP docs" class="md-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ABAP docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="ABAP docs" class="md-nav__link">
      ABAP docs
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-for-authorization-checks" class="md-nav__link">
    Example for authorization checks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-for-reading-persistent-data" class="md-nav__link">
    Example for reading persistent data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-for-changing-persistent-data" class="md-nav__link">
    Example for changing persistent data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-for-a-test-double" class="md-nav__link">
    Example for a test double
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continue" class="md-nav__link">
    Continue
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/eduardocopat/abap-docs/edit/master/docs/7.54/abentest_seams.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="test-seams">Test Seams</h1>
<p>Test seams are language constructs designed especially for <a href="../abenunit_test_glosry" class="grey" title="Glossary Entry">unit tests</a> and are implemented using the following statements:</p>
<ul>

<li><a href="../abaptest-seam" class="blue"><code style="display: inline;"><span class="qtext">TEST-SEAM</span></code> - <code style="display: inline;"><span class="qtext">END-TEST-SEAM</span></code></a></li>

</ul>

<dd>
Defines a test seam as a replaceable area in the production code of a program.
</dd>

<ul>

<li><a href="../abaptest-injection" class="blue"><code style="display: inline;"><span class="qtext">TEST-INJECTION</span></code> - <code style="display: inline;"><span class="qtext">END-TEST-INJECTION</span></code></a></li>

</ul>

<dd>
Replaces the executable statements of a test seam by the statements of an injection in a <a href="../abentest_class_glosry" class="grey" title="Glossary Entry">test class</a> of the same program.
</dd>

<p>Test seams have the following properties:</p>
<ul>

<li>Test seams do not affect the production use of programs. No injection takes place, rather the original code is executed.</li>

</ul>

<ul>

<li>A program can contain more than one test seam.</li>

</ul>

<ul>

<li>Multiple injections can be defined for a single test seam.</li>

</ul>

<ul>

<li>Injections can only be created in test classes that are defined in a
<a href="../abentest_include_glosry" class="grey" title="Glossary Entry">test include</a>. Test seams can be used in all executable units of a master program that includes a test include , including local classes and subroutines
.</li>

</ul>

<ul>

<li>Unit tests can make injections while <a href="../abentest_method_glosry" class="grey" title="Glossary Entry">test methods</a> or the <code style="display: inline;"><span class="qtext">setup</span></code> method are being executed.</li>

</ul>

<ul>

<li>If injections are repeated in the same test seam, the last injection is the active injection.</li>

</ul>

<p><s><i>7.31</i></s> <s><i>7.40</i></s> <b>7.54</b></p>
<p><small>
<a href="../abenabap" class="blue">ABAP Keyword Documentation</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_reference" class="blue">ABAP &#x2212; Reference</a>&#xA0;&#x2192;&#xA0;
<a href="../abenprogram_editing" class="blue">program editing</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_tests" class="blue">Testing and Checking Programs</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_unit" class="blue">ABAP Unit</a>&#xA0;</small>
<br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>Test seams are a simple way of replacing or expanding source code in production parts of a program
for test purposes. If, for example, the behavior of certain statements prevents tests from running, the unit test can replace them with suitable alternatives. Typical scenarios are:</li>

<p></ul>
<ul class="circlem2"></p>
<li>Authorization checks</li>

<p></ul>
<ul class="circlem2"></p>
<li>Reading persistent data</li>

<p></ul>
<ul class="circlem2"></p>
<li>Modifying persistent data</li>

<p></ul>
<ul class="circlem2"></p>
<li>Creating test doubles</li>

<p></ul>
<ul></p>
<li>Test seams are intended mainly for use with legacy code that, due to
<a href="../abenseperation_concerns_guidl" class="lnkpurple" title="Guideline">separation of concerns</a>,
is no suitable for unit tests. New programs, on the other hand, should be modular in such a way that test seams are made unnecessary.</li>

<p></ul>
</div></p>
<h3 id="example-for-authorization-checks">Example for authorization checks</h3>
<p>An injection can use the statement <a href="../abapauthority-check" class="blue"><code style="display: inline;"><span class="qtext">AUTHORITY-CHECK</span></code></a>
to bypass the dependency of a unit test on the authorizations of the current user by setting a suitable return code.</p>
<table>
<thead>
<tr>
<th>Test Seam</th>
<th>Injection</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="qtext400">TEST-SEAM authorization_seam.<br>&#xA0;&#xA0;AUTHORITY-CHECK OBJECT &apos;S_CTS_ADMI&apos;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;ID &apos;CTS_ADMFCT&apos; FIELD &apos;TABL&apos;.<br>END-TEST-SEAM.</td>
<td></td>
</tr>
<tr>
<td>IF sy-subrc = 0.<br>&#xA0;&#xA0;is_authorized = abap_true.<br>ENDIF.</span></td>
<td><span class="qtext400">TEST-INJECTION authorization_seam.<br>&#xA0;&#xA0;sy-subrc = 0.<br>END-TEST-INJECTION.</span></td>
</tr>
</tbody>
</table>
<h3 id="example-for-reading-persistent-data">Example for reading persistent data</h3>
<p>It is often not possible to make assumptions about the content of database tables or other repositories
in unit tests. Using test seams, unit tests can bypass the dependencies of persistent data by replacing it with constructed data.</p>
<table>
<thead>
<tr>
<th>Test Seam</th>
<th>Injection</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="qtext400">TEST-SEAM read_content_seam.<br>&#xA0;&#xA0;SELECT *<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FROM sflight<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; WHERE&#xA0;&#xA0;carrid IN @carrid_range AND<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;fldate EQ @sy-datum<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;INTO TABLE @flights.<br>END-TEST-SEAM.</span></td>
<td><span class="qtext400">TEST-INJECTION read_content_seam.<br>&#xA0;&#xA0;flights =<br>&#xA0;&#xA0;&#xA0;VALUE #( ( carrid = &apos;LHA&apos;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; connid = 100 )<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; ( carrid = &apos;AFR&apos;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; connid = 900 ) ).<br>END-TEST-INJECTION.</span></td>
</tr>
</tbody>
</table>
<h3 id="example-for-changing-persistent-data">Example for changing persistent data</h3>
<p>When they run, unit tests must not modify production content of database tables or other repositories.
Using test seams, unit tests can record the operands of modifying database operations or compare actual
changes with expected changes. In the following source code section compares, the injection compares the change values with a public static attribute.</p>
<table>
<thead>
<tr>
<th>Test Seam</th>
<th>Injection</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="qtext400">TEST-SEAM store_content_seam.<br>&#xA0;&#xA0;MODIFY sflight<br>&#xA0;&#xA0;&#xA0;&#xA0;FROM TABLE @new_flights.<br>END-TEST-SEAM.</span></td>
<td><span class="qtext400">TEST-INJECTION store_content_seam.<br>&#xA0;&#xA0;cl_abap_unit_assert=&gt;assert_equals(<br>&#xA0;&#xA0;&#xA0; act = new_flights<br>&#xA0;&#xA0;&#xA0;&#xA0; exp = global_buffer=&gt;exp_flights ).<br>END-TEST-INJECTION.</span></td>
</tr>
</tbody>
</table>
<h3 id="example-for-a-test-double">Example for a test double</h3>
<p>In the following source code section, the production source text of class that is dependent on database
content is instantiated. The unit test injects the instantiated test double at the location of the production object.</p>
<table>
<thead>
<tr>
<th>Test Seam</th>
<th>Injection</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="qtext400">TEST-SEAM instantiation_seam.<br>&#xA0;&#xA0;me-&gt;oref = NEW #( ).<br>END-TEST-SEAM.</span></td>
<td><span class="qtext400">TEST-INJECTION instantiation_seam.<br>&#xA0;&#xA0;me-&gt;oref = NEW dummy_class( ).<br> END-TEST-INJECTION.</span></td>
</tr>
</tbody>
</table>
<p><br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p>See also the class <span class="lnkgrey">CL_AU_SAMPLE_TEST_SEAMS</span> in the package <span class="lnkgrey">SABP_UNIT_SAMPLE</span>.</p>
</div>

<h3 id="continue">Continue</h3>
<p><a href="../abaptest-seam" class="blue">TEST-SEAM</a></p>
<p><a href="../abaptest-injection" class="blue">TEST-INJECTION</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../abentest_seam_glosry/" title="test seam" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                test seam
              </div>
            </div>
          </a>
        
        
          <a href="../abentest_task_glosry/" title="test task" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                test task
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.df0def68.min.js"></script>
      <script src="../../assets/javascripts/bundle.ba57d267.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js"></script>
      
        <script src="../../javascript/hljs.js"></script>
      
    
  </body>
</html>