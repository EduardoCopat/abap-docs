


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.9">
    
    
      
        <title>sql_exp - win_func - ABAP docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.36ee6aaa.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.83bccb1f.min.css">
      
      
        
        
        <meta name="theme-color" content="#4051b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://raw.githubusercontent.com/highlightjs/highlight.js/master/src/styles/github.css">
    
      <link rel="stylesheet" href="../../css/abap-docs.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sql_exp-win_func" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="ABAP docs" class="md-header-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            ABAP docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              sql_exp - win_func
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ABAP docs" class="md-nav__button md-logo" aria-label="ABAP docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ABAP docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/eduardocopat/abap-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eduardocopat/abap-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="ABAP docs" class="md-nav__link">
      ABAP docs
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#syntax" class="md-nav__link">
    Syntax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variants" class="md-nav__link">
    Variants
  </a>
  
    <nav class="md-nav" aria-label="Variants">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#effect" class="md-nav__link">
    Effect
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variant-1" class="md-nav__link">
    Variant 1
  </a>
  
    <nav class="md-nav" aria-label="Variant 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#effect_1" class="md-nav__link">
    Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executable-example" class="md-nav__link">
    Executable Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variant-2" class="md-nav__link">
    Variant 2
  </a>
  
    <nav class="md-nav" aria-label="Variant 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#effect_2" class="md-nav__link">
    Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executable-examples" class="md-nav__link">
    Executable Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variant-3" class="md-nav__link">
    Variant 3
  </a>
  
    <nav class="md-nav" aria-label="Variant 3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#effect_3" class="md-nav__link">
    Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executable-example_1" class="md-nav__link">
    Executable Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variant-4" class="md-nav__link">
    Variant 4
  </a>
  
    <nav class="md-nav" aria-label="Variant 4">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#effect_4" class="md-nav__link">
    Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executable-example_2" class="md-nav__link">
    Executable Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variant-5" class="md-nav__link">
    Variant 5
  </a>
  
    <nav class="md-nav" aria-label="Variant 5">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#effect_5" class="md-nav__link">
    Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executable-example_3" class="md-nav__link">
    Executable Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/eduardocopat/abap-docs/edit/master/docs/7.54/abensql_win_func.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="sql_exp-win_func">sql_exp - win_func</h1>
<p><s><i>7.31</i></s> <s><i>7.40</i></s> <b>7.54</b></p>
<p><small>
<a href="../abenabap" class="blue">ABAP Keyword Documentation</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_reference" class="blue">ABAP &#x2212; Reference</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_language_external_data" class="blue">Processing External Data</a>&#xA0;&#x2192;&#xA0;
<a href="../abenabap_sql" class="blue">ABAP Database Access</a>&#xA0;&#x2192;&#xA0;
<a href="../abenopensql" class="blue">ABAP SQL</a>&#xA0;&#x2192;&#xA0;
<a href="../abenopen_sql_operands" class="blue">ABAP SQL - Operands and Expressions</a>&#xA0;&#x2192;&#xA0;
<a href="../abapsql_expr" class="blue">ABAP SQL - SQL Expressions sql_exp</a>&#xA0;&#x2192;&#xA0;
<a href="../abapselect_over" class="blue">sql_exp - sql_win</a>&#xA0;</small></p>
<h2 id="syntax">Syntax</h2>
<p><pre><code class="hljs abap abap-docs-syntax-block">
<span class="qtext">... <a href="../abapselect_aggregate" class="blue">AVG</a>(
<a href="../abenopen_sql_columns" class="blue">col</a> <i class="bn">[</i><a href="../abapselect_avg_as" class="blue">AS dtype</a><i class="bn">]</i> ) <br>
&#xA0;&#xA0;<i class="bn">|</i> <a href="../abapselect_aggregate" class="blue">MAX</a>( <a href="../abapsql_expr" class="blue">sql_exp</a> ) <br>
&#xA0;&#xA0;<i class="bn">|</i> <a href="../abapselect_aggregate" class="blue">MIN</a>( <a href="../abapsql_expr" class="blue">sql_exp</a> ) <br>
&#xA0;&#xA0;<i class="bn">|</i> <a href="../abapselect_aggregate" class="blue">SUM</a>( <a href="../abapsql_expr" class="blue">sql_exp</a> ) <br>
&#xA0;&#xA0;<i class="bn">|</i> <a href="../abapselect_aggregate" class="blue">COUNT</a>( <a href="../abapsql_expr" class="blue">sql_exp</a> ) <br>
&#xA0;&#xA0;<i class="bn">|</i> <a href="../abapselect_aggregate" class="blue">COUNT</a>( * ) <br>&#xA0;&#xA0;<i class="bn">|</i> <a href="../abapselect_aggregate" class="blue">COUNT</a>(*) <br>
 <br>&#xA0;&#xA0;<i class="bn">|</i> ROW_NUMBER( ) <br>&#xA0;&#xA0;<i class="bn">|</i> RANK( ) <br>&#xA0;&#xA0;<i class="bn">|</i> DENSE_RANK( ) <br>
 <br>&#xA0;&#xA0;<i class="bn">|</i> LEAD<i class="bn">|</i>LAG(
<a href="../abapsql_expr" class="blue">sql_exp1</a><i class="bn">[</i>, diff<i class="bn">[</i>, <a href="../abapsql_expr" class="blue">sql_exp2</a><i class="bn">]</i><i class="bn">]</i> ) ...</span> 
</code></pre></p>
<h2 id="variants">Variants</h2>
<p><a href="#!ABAP_VARIANT_1@1@" class="blue"> 1. <code style="display: inline;"><span class="qtext">... AVG( ... ) <i class="bn">|</i> ... <i class="bn">|</i> COUNT(*)</span></code> </a> <br>
<br><a href="#!ABAP_VARIANT_2@2@" class="blue"> 2. <code style="display: inline;"><span class="qtext">... ROW_NUMBER( )</span></code> </a> <br>
<br><a href="#!ABAP_VARIANT_3@3@" class="blue"> 3. <span class="qtext">... RANK(
)</span> </a><br />
 <a href="#!ABAP_VARIANT_4@4@" class="blue"> 4. <code style="display: inline;"><span class="qtext">... DENSE_RANK( )</span></code> </a> <br>
<br><a href="#!ABAP_VARIANT_5@5@" class="blue"> 5. <code style="display: inline;"><span class="qtext">... LEAD<i class="bn">|</i>LAG( sql_exp1<i class="bn">[</i>, diff<i class="bn">[</i>, sql_exp2<i class="bn">]</i><i class="bn">]</i> )</span></code> </a>  </p>
<h3 id="effect">Effect</h3>
<p><a href="../abenwindow_function_glosry" class="grey" title="Glossary Entry">Window function</a> in a <a href="../abapselect_over" class="blue">window expression</a>. Window functions are:</p>
<ul>

<li>
<a href="../abenaggregate_function_glosry" class="grey" title="Glossary Entry">Aggregate functions</a> <code style="display: inline;"><span class="qtext">AVG( ... )</span></code>, ..., <code style="display: inline;"><span class="qtext">COUNT(*)</span></code> that can also be used in
<a href="../abapselect_aggregate" class="blue">aggregate expressions</a>.
</li>
<li>
<a href="../abenranking_function_glosry" class="grey" title="Glossary Entry">Ranking functions</a> <span class="qtext">ROW_NUMBER(
)</span>, <code style="display: inline;"><span class="qtext">RANK( )</span></code>, and <code style="display: inline;"><span class="qtext">DENSE_RANK( )</span></code> that can only be used in <a href="../abapselect_over" class="blue">window expressions</a>.
</li>
<li>
<a href="../abenvalue_function_glosry" class="grey" title="Glossary Entry">Value functions</a> <code style="display: inline;"><span class="qtext">LEAD( ... )</span></code>, <code style="display: inline;"><span class="qtext">LAG( ... )</span></code> that can be used only in
<a href="../abapselect_over" class="blue">window expressions</a>. <br>
</li>

</ul>

<p><a name="!ABAP_VARIANT_1@1@"></a></p>
<h2 id="variant-1">Variant 1</h2>
<p><code style="display: inline;"><span class="qtext">... AVG( ... ) <i class="bn">|</i> ... <i class="bn">|</i> COUNT(*)</span></code><br />
 <br><!-- /A --></p>
<h3 id="effect_1">Effect</h3>
<p>Specifies one of the aggregate functions <a href="../abensql_agg_func" class="blue"><code style="display: inline;"><span class="qtext">MAX</span></code></a>,
<a href="../abensql_agg_func" class="blue"><code style="display: inline;"><span class="qtext">MIN</span></code></a>, <a href="../abensql_agg_func" class="blue">
<code style="display: inline;"><span class="qtext">SUM</span></code></a>, <a href="../abensql_agg_func" class="blue"><code style="display: inline;"><span class="qtext">COUNT</span></code></a>,
or <a href="../abensql_agg_func" class="blue"><code style="display: inline;"><span class="qtext">COUNT(*)</span></code></a> as a window function.
The aggregate functions evaluate the rows of the current window or of the frame defined by an addition
<code style="display: inline;"><span class="qtext">ORDER BY</span></code> after <a href="../abapselect_over" class="blue"><code style="display: inline;"><span class="qtext">OVER</span></code></a>. The aggregate functions are applied as in the
<a href="../abensql_agg_func" class="blue">general description</a>, with the following differences:</p>
<ul>

<li>
The addition <code style="display: inline;"><span class="qtext">DISTINCT</span></code> is not allowed in a window expression.
</li>
<li>
The result of the function <code style="display: inline;"><span class="qtext">COUNT</span></code> has the data type INT8 and not INT4.
<br></li>

</ul>

<p>The same applies to the arguments of aggregate functions as in the
<a href="../abensql_agg_func" class="blue">general description</a>, with the difference that the argument
of an aggregate function in a window expression can itself, as a window function, be an aggregate function.
This is the precise case when a grouping is made using the <a href="../abapgroupby_clause" class="blue"><span class="qtext">
GROUP BY</span></a> clause in the current query. The windows on the combined results set are then defined
and the aggregate expressions permitted as specified columns of the current <a href="../abapselect_list" class="blue">
<code style="display: inline;"><span class="qtext">SELECT</span></code> list</a> can be used either as standalone expressions or as part of
an SQL expression (as an argument of window functions of the window expressions in question). A window function then determines its result from the aggregated values of the rows of the current window.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Note</p></p>
<p>The addition <code style="display: inline;"><span class="qtext">DISTINCT</span></code> cannot be specified, which means that <span class="qtext">COUNT( sql_exp
)</span> can only be used to count rows that do not contain a null value and cannot be used to count rows with different results of <code style="display: inline;"><span class="qtext">sql_exp</span></code>.</p>
</div>

<h3 id="executable-example">Executable Example</h3>
<p><a href="../abensql_expr_over_group_abexa" class="blue">Window Expressions with Grouping</a>  </p>
<p><a name="!ABAP_VARIANT_2@2@"></a></p>
<h2 id="variant-2">Variant 2</h2>
<p><code style="display: inline;"><span class="qtext">... ROW_NUMBER( )</span></code><br />
 <br><!-- /A --></p>
<h3 id="effect_2">Effect</h3>
<p>Specifies the ranking function <code style="display: inline;"><span class="qtext">ROW_NUMBER</span></code> as a window function. This ranking
function grants each row a row number of the data type INT8 and does not have an argument. The rows
of each window are numbered starting with 1. This numbering takes place in the order in which the rows
of a window are processed. The order is either undefined or can be defined by specifying the addition
<code style="display: inline;"><span class="qtext">ORDER BY</span></code> after <a href="../abapselect_over" class="blue"><code style="display: inline;"><span class="qtext">OVER</span></code></a>.</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Note</p></p>
<p>If <code style="display: inline;"><span class="qtext">ORDER BY</span></code> is not specified after <a href="../abapselect_over" class="blue"><span class="qtext">
OVER</span></a>, <code style="display: inline;"><span class="qtext">ROW_NUMBER</span></code> still grants a unique row number, but these numbers are not ordered.</p>
</div>

<h3 id="executable-examples">Executable Examples</h3>
<p><a href="../abensql_expr_over_abexas" class="blue">Examples of Window Expressions</a>  </p>
<p><a name="!ABAP_VARIANT_3@3@"></a></p>
<h2 id="variant-3">Variant 3</h2>
<p><code style="display: inline;"><span class="qtext">... RANK( )</span></code><br />
 <br><!-- /A --></p>
<h3 id="effect_3">Effect</h3>
<p>Specifies the ranking function <code style="display: inline;"><span class="qtext">RANK</span></code> as a window function. This ranking function
grants each row a rank of the data type INT8 and does not have an argument. It can only be specified
together with <code style="display: inline;"><span class="qtext">ORDER BY</span></code> after <a href="../abapselect_over" class="blue"><code style="display: inline;"><span class="qtext">OVER</span></code></a>.</p>
<p>The rank of a row is the position of this row in the ranking defined by the addition <code style="display: inline;"><span class="qtext">ORDER BY</span></code> after <code style="display: inline;"><span class="qtext">OVER</span></code> and is defined as follows:</p>
<ul>

<li>
All rows that occur more than once (with respect to the sort criterion) have the same rank. This rank is the lowest row number in this group, as determined by the function <code style="display: inline;"><span class="qtext">ROW_NUMBER</span></code>.
</li>
<li>
The first group of each window starts with the value 1.
<br></li>

</ul>

<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Note</p></p>
<p>If a window does not contain any multiple rows (with respect to the sort criterion), <code style="display: inline;"><span class="qtext">RANK</span></code>
produces the same result as <code style="display: inline;"><span class="qtext">ROW_NUMBER</span></code>. If any other cases, a ranking determined
by <code style="display: inline;"><span class="qtext">RANK</span></code> is not gap-free. <code style="display: inline;"><span class="qtext">DENSE_RANK</span></code> can be used to remove gaps.</p>
</div>

<h3 id="executable-example_1">Executable Example</h3>
<p><a href="../abensql_expr_over_order_by_abexa" class="blue">Window Expressions with Sort</a>  </p>
<p><a name="!ABAP_VARIANT_4@4@"></a></p>
<h2 id="variant-4">Variant 4</h2>
<p><code style="display: inline;"><span class="qtext">... DENSE_RANK( )</span></code><br />
 <br><!-- /A --></p>
<h3 id="effect_4">Effect</h3>
<p>Specifies the ranking function <code style="display: inline;"><span class="qtext">DENSE_RANK</span></code> as a window function. This ranking
function grants each row a rank of the data type INT8 and does not have an argument. It can only be
specified together with <code style="display: inline;"><span class="qtext">ORDER BY</span></code> after <a href="../abapselect_over" class="blue"><code style="display: inline;"><span class="qtext">OVER</span></code></a>.</p>
<p><code style="display: inline;"><span class="qtext">DENSE_RANK</span></code> works in largely the same way as <code style="display: inline;"><span class="qtext">RANK</span></code>,
but counts without any gaps, starting from the first group, and does not determine the rank using the lowest row number of groups of identical values (with respect to the sort criterion).</p>
<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Note</p></p>
<p>If a window does not contain any multiple rows (with respect to the sort criterion), <code style="display: inline;"><span class="qtext">DENSE_RANK</span></code> produces the same result as <code style="display: inline;"><span class="qtext">RANK</span></code>.</p>
</div>

<h3 id="executable-example_2">Executable Example</h3>
<p><a href="../abensql_expr_over_order_by_abexa" class="blue">Window Expressions with Sort</a>  </p>
<p><a name="!ABAP_VARIANT_5@5@"></a></p>
<h2 id="variant-5">Variant 5</h2>
<p><code style="display: inline;"><span class="qtext">... LEAD<i class="bn">|</i>LAG( sql_exp1<i class="bn">[</i>, diff<i class="bn">[</i>, sql_exp2<i class="bn">]</i><i class="bn">]</i></span></code><br />
 <br><!-- /A --></p>
<h3 id="effect_5">Effect</h3>
<p>Specifies the value functions <code style="display: inline;"><span class="qtext">LEAD</span></code> or <code style="display: inline;"><span class="qtext">LAG</span></code> as a
window function. They can only be specified together with <code style="display: inline;"><span class="qtext">ORDER BY</span></code> after <a href="../abapselect_over" class="blue"><code style="display: inline;"><span class="qtext">OVER</span></code></a>.</p>
<p>The result of the functions is the value of the SQL expression <a href="../abapsql_expr" class="blue"><span class="qtext">
sql_exp1</span></a> for the row of the current window or for the row of the box defined by an addition
<code style="display: inline;"><span class="qtext">ORDER BY</span></code> after <a href="../abapselect_over" class="blue"><code style="display: inline;"><span class="qtext">OVER</span></code></a>.
This row is itself defined by the addition <code style="display: inline;"><span class="qtext">diff</span></code>. <code style="display: inline;"><span class="qtext">diff</span></code> can be specified as a
<a href="../abenabap_sql_host_literals" class="blue">literal</a> or a
<a href="../abenopen_sql_host_variables" class="blue">host constant</a> with the ABAP type <code style="display: inline;"><span class="qtext">b</span></code>,
<code style="display: inline;"><span class="qtext">s</span></code>, <code style="display: inline;"><span class="qtext">i</span></code>, <code style="display: inline;"><span class="qtext">int8</span></code>, whose value is a positive number other than 0.</p>
<ul>

<li>
For the function <code style="display: inline;"><span class="qtext">LEAD</span></code>, <code style="display: inline;"><span class="qtext">diff</span></code> determines the row positioned the distance in question after the current row.
</li>
<li>
For the function <code style="display: inline;"><span class="qtext">LAG</span></code>, <code style="display: inline;"><span class="qtext">diff</span></code> determines the row positioned the distance in question in front of the current row.
<br></li>

</ul>

<p>If <code style="display: inline;"><span class="qtext">diff</span></code> is not specified, the value 1 is used. In the case of <code style="display: inline;"><span class="qtext">LEAD</span></code>,
this is the row that follows directly and in the case of <code style="display: inline;"><span class="qtext">LAG</span></code>, the directly preceding row. If the row determined by <code style="display: inline;"><span class="qtext">diff</span></code> is not in the current window, the result is the
<a href="../abennull_value_glosry" class="grey" title="Glossary Entry">null value</a> by default. If
the optional SQL expression <a href="../abapsql_expr" class="blue"><code style="display: inline;"><span class="qtext">sql_exp2</span></code></a> is specified, it is evaluated and returned as the current row in cases where the row does not exist.</p>
<p>The result of the functions <code style="display: inline;"><span class="qtext">LEAD</span></code> and <code style="display: inline;"><span class="qtext">LAG</span></code> has the following data type:</p>
<ul>

<li>
If <a href="../abapsql_expr" class="blue"><code style="display: inline;"><span class="qtext">sql_exp2</span></code></a>
is not specified, the data type is determined by <a href="../abapsql_expr" class="blue"><code style="display: inline;"><span class="qtext">sql_exp1</span></code></a>.
</li>
<li>
If <a href="../abapsql_expr" class="blue"><code style="display: inline;"><span class="qtext">sql_exp2</span></code></a> is specified, the
results of <code style="display: inline;"><span class="qtext">sql_exp1</span></code> and <code style="display: inline;"><span class="qtext">sql_exp2</span></code> must match in
a way that a common result type can be determined: The data types must either be the same or the data
type of one expression must represent the value of the other expression. The result has the dictionary type of the expression with the largest value range.
<br></li>

</ul>

<p><br style="display: block">
<div markdown="span" class="admonition note">
<p class="admonition-title">Notes</p>
<ul></p>
<li>
The window functions <code style="display: inline;"><span class="qtext">LEAD</span></code> or <code style="display: inline;"><span class="qtext">LAG</span></code> are suited to
calculations such as, for example, determining the difference between values in the current row and values of the preceding or following rows.
</li>

<li>
If the window functions <code style="display: inline;"><span class="qtext">LEAD</span></code> or <code style="display: inline;"><span class="qtext">LAG</span></code> are used, the syntax check is applied in <a href="../abenopensql_strict_mode_754" class="blue">strict mode from Release 7.54</a>.
<br></li>

<p></ul>
</div>
<br style="display: block">
<div markdown="span" class="admonition example">
<p class="admonition-title">Example</p></p>
<p><code style="display: inline;"><span class="qtext">SELECT</span></code> statement with the window functions <code style="display: inline;"><span class="qtext">LEAD</span></code> and <code style="display: inline;"><span class="qtext">LAG</span></code> as operands of an
<a href="../abensql_arith" class="blue">arithmetic expression</a>. The addition <a href="../abapselect_over" class="blue">
<code style="display: inline;"><span class="qtext">PARTITION</span></code></a> is not specified, which means there is only one window containing
all rows of the results set. Both <code style="display: inline;"><span class="qtext">LEAD</span></code> and <code style="display: inline;"><span class="qtext">LAG</span></code>
have only one argument each, which means that the difference between the values of the column NUM1 is calculated using the directly following or preceding row, and any nonexistent rows produce null values. These values are defined using a
<a href="../abennull_indicator_glosry" class="grey" title="Glossary Entry">null indicator</a>. The
program <span class="lnkgrey">DEMO_SELECT_OVER_LEAD_LAG_DIFF</span> uses this <code style="display: inline;"><span class="qtext">SELECT</span></code> statement and, when <span class="lnkgrey">executed</span>, the program displays the result.</p>
<p><div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="nv">num1</span> <span class="k">AS</span> <span class="k">number</span><span class="p">,</span> 
       <span class="nv">num1</span> <span class="o">-</span> <span class="nv">LEAD</span><span class="p">(</span> <span class="nv">num1</span> <span class="p">)</span> <span class="nv">OVER</span><span class="p">(</span> <span class="k">ORDER BY</span> <span class="k">id</span> <span class="p">)</span> <span class="k">AS</span> <span class="nv">diff_lead</span><span class="p">,</span> 
       <span class="nv">num1</span> <span class="o">-</span> <span class="nv">LAG</span><span class="p">(</span>  <span class="nv">num1</span> <span class="p">)</span> <span class="nv">OVER</span><span class="p">(</span> <span class="k">ORDER BY</span> <span class="k">id</span> <span class="p">)</span> <span class="k">AS</span> <span class="nv">diff_lag</span> 
       <span class="k">FROM</span> <span class="nv">demo_expressions</span> 
       <span class="k">ORDER BY</span> <span class="k">id</span> 
       <span class="k">INTO</span> <span class="k">TABLE</span> <span class="err">@</span><span class="nv">DATA</span><span class="p">(</span><span class="nv">lead_lag_diffs</span><span class="p">)</span> 
                  <span class="nv">INDICATORS</span> <span class="nv">NULL</span> <span class="nv">STRUCTURE</span> <span class="nv">null_ind</span><span class="p">.</span>
</code></pre></div>
</div></p>
<h3 id="executable-example_3">Executable Example</h3>
<p><a href="../abensql_expr_over_lead_lag_abexa" class="blue">Window Functions <code style="display: inline;"><span class="qtext">LEAD</span></code> and <code style="display: inline;"><span class="qtext">LAG</span></code></a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../abensql_view_glosry/" title="SQL view" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                SQL view
              </div>
            </div>
          </a>
        
        
          <a href="../abensrfc_glosry/" title="sRFC" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                sRFC
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.df0def68.min.js"></script>
      <script src="../../assets/javascripts/bundle.ba57d267.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js"></script>
      
        <script src="../../javascript/hljs.js"></script>
      
    
  </body>
</html>